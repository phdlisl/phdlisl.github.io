
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>mraes.c · 档案馆</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="phdlisl">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="blmq.html" />
    
    
    <link rel="prev" href="ecsgen.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    首页
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">教学笔记</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../teachClang/intro.html">
            
                <a href="../../teachClang/intro.html">
            
                    
                    C语言程序设计
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../teachDatastruct/intro.html">
            
                <a href="../../teachDatastruct/intro.html">
            
                    
                    数据结构与算法
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../teachNote/intro.html">
            
                <a href="../../teachNote/intro.html">
            
                    
                    集合（零散教学）
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../teachNote/gitbook2github.html">
            
                <a href="../../teachNote/gitbook2github.html">
            
                    
                    搭建个人博客（笔记）网站
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">笔记</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../note/intro.html">
            
                <a href="../../note/intro.html">
            
                    
                    集合（零散）
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../../note/source.html">
            
                <a href="../../note/source.html">
            
                    
                    资源集合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../../note/gitbook-github.html">
            
                <a href="../../note/gitbook-github.html">
            
                    
                    基于GitHub服务用Gitbook搭建免费个人网站
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../crypto/intro.html">
            
                <a href="../../crypto/intro.html">
            
                    
                    密码学
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../crypto/AES/intro.html">
            
                <a href="../../crypto/AES/intro.html">
            
                    
                    AES加密算法C/C++实现
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1.1" data-path="../../crypto/AES/instruct.html">
            
                <a href="../../crypto/AES/instruct.html">
            
                    
                    用指令集实现AES（XTS 模式）
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">技术指南</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../ebook/intro.html">
            
                <a href="../../ebook/intro.html">
            
                    
                    Gitbook使用指南
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../../ebook/startbook.html">
            
                <a href="../../ebook/startbook.html">
            
                    
                    Gitbook环境配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../../ebook/firstpage.html">
            
                <a href="../../ebook/firstpage.html">
            
                    
                    第一个Gitbook项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../../ebook/plugins.html">
            
                <a href="../../ebook/plugins.html">
            
                    
                    Gitbook插件配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../../ebook/gitbk.html">
            
                <a href="../../ebook/gitbk.html">
            
                    
                    Gitbook操作技巧
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../../ebook/mkdown.html">
            
                <a href="../../ebook/mkdown.html">
            
                    
                    MarkDown语法规则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../../ebook/style.html">
            
                <a href="../../ebook/style.html">
            
                    
                    个性化样式配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../../clang/intro.html">
            
                <a href="../../clang/intro.html">
            
                    
                    C语言
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" >
            
                <span>
            
                    
                    标准库函数
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1.1" data-path="../../clang/standardLib/memory.html">
            
                <a href="../../clang/standardLib/memory.html">
            
                    
                    内存分配
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.1.2" data-path="../../clang/standardLib/qsort.html">
            
                <a href="../../clang/standardLib/qsort.html">
            
                    
                    qsort函数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.2" >
            
                <span>
            
                    
                    硬件
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.2.1" data-path="../../clang/hardware/aesNI.html">
            
                <a href="../../clang/hardware/aesNI.html">
            
                    
                    AES密钥扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.2" data-path="../../clang/hardware/attribute.html">
            
                <a href="../../clang/hardware/attribute.html">
            
                    
                    属性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.3" data-path="../../clang/hardware/instruct.html">
            
                <a href="../../clang/hardware/instruct.html">
            
                    
                    指令集
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.4" data-path="../../clang/hardware/sse2fun.html">
            
                <a href="../../clang/hardware/sse2fun.html">
            
                    
                    SSE2函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.5" data-path="../../clang/hardware/ssefun.html">
            
                <a href="../../clang/hardware/ssefun.html">
            
                    
                    SSE函数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.3" >
            
                <span>
            
                    
                    实用案例
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.3.1" data-path="../../clang/tools/times.html">
            
                <a href="../../clang/tools/times.html">
            
                    
                    时间统计方法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../../datastruct/intro.html">
            
                <a href="../../datastruct/intro.html">
            
                    
                    数据结构与算法
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../intro.html">
            
                <a href="../intro.html">
            
                    
                    Miracl密码库
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="../install.html">
            
                <a href="../install.html">
            
                    
                    环境配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.2" data-path="../curvePara.html">
            
                <a href="../curvePara.html">
            
                    
                    曲线参数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.3" >
            
                <span>
            
                    
                    案例分析
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.3.1" data-path="ecsgen.html">
            
                <a href="ecsgen.html">
            
                    
                    ecsgen.cpp
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="9.1.3.2" data-path="mraes.html">
            
                <a href="mraes.html">
            
                    
                    mraes.c
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.3.3" data-path="blmq.html">
            
                <a href="blmq.html">
            
                    
                    blmq.cpp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.3.3.1" data-path="../packgDemo/bn_pair.html">
            
                <a href="../packgDemo/bn_pair.html">
            
                    
                    bn_pair.cpp
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4" >
            
                <span>
            
                    
                    API接口
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.1" data-path="../api/cplus.html">
            
                <a href="../api/cplus.html">
            
                    
                    C++中的函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.2" >
            
                <span>
            
                    
                    数据类型和常量
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.2.1" data-path="../api/dtype/big.html">
            
                <a href="../api/dtype/big.html">
            
                    
                    big类型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.2.2" data-path="../api/dtype/constants.html">
            
                <a href="../api/dtype/constants.html">
            
                    
                    字符常量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.2.3" data-path="../api/dtype/epoint.html">
            
                <a href="../api/dtype/epoint.html">
            
                    
                    epoint类型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.2.4" data-path="../api/dtype/int.html">
            
                <a href="../api/dtype/int.html">
            
                    
                    与int类型相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.2.5" data-path="../api/dtype/miracl.html">
            
                <a href="../api/dtype/miracl.html">
            
                    
                    miracl类型
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.3" >
            
                <span>
            
                    
                    mrarth0.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.3.1" data-path="../api/mrarth0/mr_psub.html">
            
                <a href="../api/mrarth0/mr_psub.html">
            
                    
                    mr_psub
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.4" >
            
                <span>
            
                    
                    mrarth1.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.4.1" data-path="../api/mrarth1/mr_invert.html">
            
                <a href="../api/mrarth1/mr_invert.html">
            
                    
                    mr_invert
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.4.2" data-path="../api/mrarth1/mr_pmul.html">
            
                <a href="../api/mrarth1/mr_pmul.html">
            
                    
                    mr_pmul
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.4.3" data-path="../api/mrarth1/mr_sdiv.html">
            
                <a href="../api/mrarth1/mr_sdiv.html">
            
                    
                    mr_sdiv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.4.4" data-path="../api/mrarth1/remain.html">
            
                <a href="../api/mrarth1/remain.html">
            
                    
                    remain
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.5" >
            
                <span>
            
                    
                    mrarth2.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.5.1" data-path="../api/mrarth2/divide.html">
            
                <a href="../api/mrarth2/divide.html">
            
                    
                    divide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.5.2" data-path="../api/mrarth2/normalise.html">
            
                <a href="../api/mrarth2/normalise.html">
            
                    
                    normalise
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.6" >
            
                <span>
            
                    
                    mrcomba.tpl
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.6.1" data-path="../api/mrcomba/comba_mult.html">
            
                <a href="../api/mrcomba/comba_mult.html">
            
                    
                    comba_mult
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.2" data-path="../api/mrcomba/comba_square.html">
            
                <a href="../api/mrcomba/comba_square.html">
            
                    
                    comba_square
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.3" data-path="../api/mrcomba/comba_redc.html">
            
                <a href="../api/mrcomba/comba_redc.html">
            
                    
                    comba_redc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.4" data-path="../api/mrcomba/comba_modadd.html">
            
                <a href="../api/mrcomba/comba_modadd.html">
            
                    
                    comba_modadd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.5" data-path="../api/mrcomba/comba_modsub.html">
            
                <a href="../api/mrcomba/comba_modsub.html">
            
                    
                    comba_modsub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.6" data-path="../api/mrcomba/comba_double_modadd.html">
            
                <a href="../api/mrcomba/comba_double_modadd.html">
            
                    
                    comba_double_modadd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.7" data-path="../api/mrcomba/comba_double_modsub.html">
            
                <a href="../api/mrcomba/comba_double_modsub.html">
            
                    
                    comba_double_modsub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.8" data-path="../api/mrcomba/comba_negate.html">
            
                <a href="../api/mrcomba/comba_negate.html">
            
                    
                    comba_negate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.9" data-path="../api/mrcomba/comba_add.html">
            
                <a href="../api/mrcomba/comba_add.html">
            
                    
                    comba_add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.10" data-path="../api/mrcomba/comba_sub.html">
            
                <a href="../api/mrcomba/comba_sub.html">
            
                    
                    comba_sub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.11" data-path="../api/mrcomba/comba_double_add.html">
            
                <a href="../api/mrcomba/comba_double_add.html">
            
                    
                    comba_double_add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.6.12" data-path="../api/mrcomba/comba_double_sub.html">
            
                <a href="../api/mrcomba/comba_double_sub.html">
            
                    
                    comba_double_sub
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.7" >
            
                <span>
            
                    
                    mrcore.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.7.1" data-path="../api/mrcore/convert.html">
            
                <a href="../api/mrcore/convert.html">
            
                    
                    convert
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.2" data-path="../api/mrcore/copy.html">
            
                <a href="../api/mrcore/copy.html">
            
                    
                    copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.3" data-path="../api/mrcore/ecp_memalloc.html">
            
                <a href="../api/mrcore/ecp_memalloc.html">
            
                    
                    ecp_memalloc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.4" data-path="../api/mrcore/epoint_init_mem.html">
            
                <a href="../api/mrcore/epoint_init_mem.html">
            
                    
                    epoint_init_mem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.5" data-path="../api/mrcore/epoint_init_mem_variable.html">
            
                <a href="../api/mrcore/epoint_init_mem_variable.html">
            
                    
                    epoint_init_mem_variable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.6" data-path="../api/mrcore/get_mip.html">
            
                <a href="../api/mrcore/get_mip.html">
            
                    
                    get_mip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.7" data-path="../api/mrcore/imuldiv.html">
            
                <a href="../api/mrcore/imuldiv.html">
            
                    
                    imuldiv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.8" data-path="../api/mrcore/irand.html">
            
                <a href="../api/mrcore/irand.html">
            
                    
                    irand
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.9" data-path="../api/mrcore/mirvar_mem_variable.html">
            
                <a href="../api/mrcore/mirvar_mem_variable.html">
            
                    
                    mirvar_mem_variable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.10" data-path="../api/mrcore/mputs.html">
            
                <a href="../api/mrcore/mputs.html">
            
                    
                    mputs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.11" data-path="../api/mrcore/mr_berror.html">
            
                <a href="../api/mrcore/mr_berror.html">
            
                    
                    mr_berror
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.12" data-path="../api/mrcore/mr_compare.html">
            
                <a href="../api/mrcore/mr_compare.html">
            
                    
                    mr_compare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.13" data-path="../api/mrcore/mr_lent.html">
            
                <a href="../api/mrcore/mr_lent.html">
            
                    
                    mr_lent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.14" data-path="../api/mrcore/mr_lzero.html">
            
                <a href="../api/mrcore/mr_lzero.html">
            
                    
                    mr_lzero
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.15" data-path="../api/mrcore/mr_notint.html">
            
                <a href="../api/mrcore/mr_notint.html">
            
                    
                    mr_notint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.16" data-path="../api/mrcore/muldiv.html">
            
                <a href="../api/mrcore/muldiv.html">
            
                    
                    muldiv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.17" data-path="../api/mrcore/muldvd.html">
            
                <a href="../api/mrcore/muldvd.html">
            
                    
                    muldvd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.18" data-path="../api/mrcore/muldvm.html">
            
                <a href="../api/mrcore/muldvm.html">
            
                    
                    muldvm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.19" data-path="../api/mrcore/size.html">
            
                <a href="../api/mrcore/size.html">
            
                    
                    size
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.20" data-path="../api/mrcore/uconvert.html">
            
                <a href="../api/mrcore/uconvert.html">
            
                    
                    uconvert
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.7.21" data-path="../api/mrcore/zero.html">
            
                <a href="../api/mrcore/zero.html">
            
                    
                    zero
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.8" >
            
                <span>
            
                    
                    big.cpp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.8.1" data-path="../api/big/ecurve.html">
            
                <a href="../api/big/ecurve.html">
            
                    
                    ecurve
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.9" >
            
                <span>
            
                    
                    mr87f.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.9.1" data-path="../api/mr87f/fastmodmult.html">
            
                <a href="../api/mr87f/fastmodmult.html">
            
                    
                    fastmodmult
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.9.2" data-path="../api/mr87f/fastmodsquare.html">
            
                <a href="../api/mr87f/fastmodsquare.html">
            
                    
                    fastmodsquare
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.10" >
            
                <span>
            
                    
                    mralloc.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.10.1" data-path="../api/mralloc/mr_alloc.html">
            
                <a href="../api/mralloc/mr_alloc.html">
            
                    
                    mr_alloc
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.11" >
            
                <span>
            
                    
                    mrcurve.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.11.1" data-path="../api/mrcurve/ecurve_add.html">
            
                <a href="../api/mrcurve/ecurve_add.html">
            
                    
                    ecurve_add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.2" data-path="../api/mrcurve/ecurve_double.html">
            
                <a href="../api/mrcurve/ecurve_double.html">
            
                    
                    ecurve_double
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.3" data-path="../api/mrcurve/ecurve_mult.html">
            
                <a href="../api/mrcurve/ecurve_mult.html">
            
                    
                    ecurve_mult
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.4" data-path="../api/mrcurve/ecurve_padd.html">
            
                <a href="../api/mrcurve/ecurve_padd.html">
            
                    
                    ecurve_padd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.5" data-path="../api/mrcurve/ecurve_sub.html">
            
                <a href="../api/mrcurve/ecurve_sub.html">
            
                    
                    ecurve_sub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.6" data-path="../api/mrcurve/epoint_copy.html">
            
                <a href="../api/mrcurve/epoint_copy.html">
            
                    
                    epoint_copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.7" data-path="../api/mrcurve/epoint_getrhs.html">
            
                <a href="../api/mrcurve/epoint_getrhs.html">
            
                    
                    epoint_getrhs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.8" data-path="../api/mrcurve/epoint_negate.html">
            
                <a href="../api/mrcurve/epoint_negate.html">
            
                    
                    epoint_negate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.11.9" data-path="../api/mrcurve/epoint_set.html">
            
                <a href="../api/mrcurve/epoint_set.html">
            
                    
                    epoint_set
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.12" >
            
                <span>
            
                    
                    mrkcm.tpl
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.12.1" data-path="../api/mrkcm/kcm_mul.html">
            
                <a href="../api/mrkcm/kcm_mul.html">
            
                    
                    kcm_mul
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.2" data-path="../api/mrkcm/kcm_multiply.html">
            
                <a href="../api/mrkcm/kcm_multiply.html">
            
                    
                    kcm_multiply
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.3" data-path="../api/mrkcm/kcm_redc.html">
            
                <a href="../api/mrkcm/kcm_redc.html">
            
                    
                    kcm_redc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.4" data-path="../api/mrkcm/kcm_sqr.html">
            
                <a href="../api/mrkcm/kcm_sqr.html">
            
                    
                    kcm_sqr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.5" data-path="../api/mrkcm/kcm_square.html">
            
                <a href="../api/mrkcm/kcm_square.html">
            
                    
                    kcm_square
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.6" data-path="../api/mrkcm/kcm_top.html">
            
                <a href="../api/mrkcm/kcm_top.html">
            
                    
                    kcm_top
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.7" data-path="../api/mrkcm/mr_addn.html">
            
                <a href="../api/mrkcm/mr_addn.html">
            
                    
                    mr_addn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.8" data-path="../api/mrkcm/mr_comba_halfm.html">
            
                <a href="../api/mrkcm/mr_comba_halfm.html">
            
                    
                    mr_comba_halfm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.9" data-path="../api/mrkcm/mr_comba_mul.html">
            
                <a href="../api/mrkcm/mr_comba_mul.html">
            
                    
                    mr_comba_mul
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.10" data-path="../api/mrkcm/mr_comba_sqr.html">
            
                <a href="../api/mrkcm/mr_comba_sqr.html">
            
                    
                    mr_comba_sqr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.11" data-path="../api/mrkcm/mr_cpy.html">
            
                <a href="../api/mrkcm/mr_cpy.html">
            
                    
                    mr_cpy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.12" data-path="../api/mrkcm/mr_decn.html">
            
                <a href="../api/mrkcm/mr_decn.html">
            
                    
                    mr_decn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.13" data-path="../api/mrkcm/mr_incn.html">
            
                <a href="../api/mrkcm/mr_incn.html">
            
                    
                    mr_incn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.14" data-path="../api/mrkcm/mr_karmul.html">
            
                <a href="../api/mrkcm/mr_karmul.html">
            
                    
                    mr_karmul
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.15" data-path="../api/mrkcm/mr_karmul_lower.html">
            
                <a href="../api/mrkcm/mr_karmul_lower.html">
            
                    
                    mr_karmul_lower
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.16" data-path="../api/mrkcm/mr_karmul_upper.html">
            
                <a href="../api/mrkcm/mr_karmul_upper.html">
            
                    
                    mr_karmul_upper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.12.17" data-path="../api/mrkcm/mr_karsqr.html">
            
                <a href="../api/mrkcm/mr_karsqr.html">
            
                    
                    mr_karsqr
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.13" >
            
                <span>
            
                    
                    miracl.h
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.13.1" data-path="../api/miracl/mr_abs.html">
            
                <a href="../api/miracl/mr_abs.html">
            
                    
                    mr_abs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.2" data-path="../api/miracl/mr_big_reserve.html">
            
                <a href="../api/miracl/mr_big_reserve.html">
            
                    
                    mr_big_reserve
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.3" data-path="../api/miracl/MR_DIV.html">
            
                <a href="../api/miracl/MR_DIV.html">
            
                    
                    MR_DIV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.4" data-path="../api/miracl/mr_ecp_reserve.html">
            
                <a href="../api/miracl/mr_ecp_reserve.html">
            
                    
                    mr_ecp_reserve
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.5" data-path="../api/miracl/mr_ecp_reserve_a.html">
            
                <a href="../api/miracl/mr_ecp_reserve_a.html">
            
                    
                    mr_ecp_reserve_a
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.6" data-path="../api/miracl/mr_esize.html">
            
                <a href="../api/miracl/mr_esize.html">
            
                    
                    mr_esize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.7" data-path="../api/miracl/mr_esize_a.html">
            
                <a href="../api/miracl/mr_esize_a.html">
            
                    
                    mr_esize_a
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.8" data-path="../api/miracl/MR_IN-MR_OUT.html">
            
                <a href="../api/miracl/MR_IN-MR_OUT.html">
            
                    
                    MR_IN和MR_OUT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.9" data-path="../api/miracl/MR_LROUND.html">
            
                <a href="../api/miracl/MR_LROUND.html">
            
                    
                    MR_LROUND
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.10" data-path="../api/miracl/MR_REMAIN.html">
            
                <a href="../api/miracl/MR_REMAIN.html">
            
                    
                    MR_REMAIN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.13.11" data-path="../api/miracl/mr_size.html">
            
                <a href="../api/miracl/mr_size.html">
            
                    
                    mr_size
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.14" >
            
                <span>
            
                    
                    ecn.h/ecn.cpp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.14.1" data-path="../api/ecn/operator-.html">
            
                <a href="../api/ecn/operator-.html">
            
                    
                    operator-
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.2" data-path="../api/ecn/add.html">
            
                <a href="../api/ecn/add.html">
            
                    
                    add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.3" data-path="../api/ecn/double_add.html">
            
                <a href="../api/ecn/double_add.html">
            
                    
                    double_add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.4" data-path="../api/ecn/get.html">
            
                <a href="../api/ecn/get.html">
            
                    
                    get
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.5" data-path="../api/ecn/getx.html">
            
                <a href="../api/ecn/getx.html">
            
                    
                    getx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.6" data-path="../api/ecn/getxy.html">
            
                <a href="../api/ecn/getxy.html">
            
                    
                    getxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.7" data-path="../api/ecn/getxyz.html">
            
                <a href="../api/ecn/getxyz.html">
            
                    
                    getxyz
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.8" data-path="../api/ecn/is_on_curve.html">
            
                <a href="../api/ecn/is_on_curve.html">
            
                    
                    is_on_curve
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.9" data-path="../api/ecn/iszero.html">
            
                <a href="../api/ecn/iszero.html">
            
                    
                    iszero
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.10" data-path="../api/ecn/operator-lb.html">
            
                <a href="../api/ecn/operator-lb.html">
            
                    
                    operator<<
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.11" data-path="../api/ecn/mul.html">
            
                <a href="../api/ecn/mul.html">
            
                    
                    mul
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.12" data-path="../api/ecn/multi_add.html">
            
                <a href="../api/ecn/multi_add.html">
            
                    
                    multi_add
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.13" data-path="../api/ecn/multi_norm.html">
            
                <a href="../api/ecn/multi_norm.html">
            
                    
                    multi_norm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.14" data-path="../api/ecn/sub.html">
            
                <a href="../api/ecn/sub.html">
            
                    
                    sub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.15" data-path="../api/ecn/get_point.html">
            
                <a href="../api/ecn/get_point.html">
            
                    
                    get_point
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.16" data-path="../api/ecn/operator-x.html">
            
                <a href="../api/ecn/operator-x.html">
            
                    
                    operator*
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.14.17" data-path="../api/ecn/get_status.html">
            
                <a href="../api/ecn/get_status.html">
            
                    
                    get_status
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.15" >
            
                <span>
            
                    
                    mrmonty.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.15.1" data-path="../api/mrmonty/nres.html">
            
                <a href="../api/mrmonty/nres.html">
            
                    
                    nres
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.15.2" data-path="../api/mrmonty/nres_modmult.html">
            
                <a href="../api/mrmonty/nres_modmult.html">
            
                    
                    nres_modmult
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.15.3" data-path="../api/mrmonty/nres_modadd.html">
            
                <a href="../api/mrmonty/nres_modadd.html">
            
                    
                    nres_modadd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.15.4" data-path="../api/mrmonty/nres_premult.html">
            
                <a href="../api/mrmonty/nres_premult.html">
            
                    
                    nres_premult
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.4.16" >
            
                <span>
            
                    
                    mrsroot.c
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.4.16.1" data-path="../api/mrsroot/nres_sqroot.html">
            
                <a href="../api/mrsroot/nres_sqroot.html">
            
                    
                    nres_sqroot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4.16.2" data-path="../api/mrsroot/sqroot.html">
            
                <a href="../api/mrsroot/sqroot.html">
            
                    
                    sqroot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.1.5" >
            
                <span>
            
                    
                    工具类
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.5.1" data-path="../packg/big.html">
            
                <a href="../packg/big.html">
            
                    
                    big
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.5.2" data-path="../packg/ecn.html">
            
                <a href="../packg/ecn.html">
            
                    
                    ecn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.5.3" data-path="../packg/pairing3h.html">
            
                <a href="../packg/pairing3h.html">
            
                    
                    pairing_3.h
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >mraes.c</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#mraesc"><b> </b>mraes.c</a></li><ul><li><span class="title-icon "></span><a href="#makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;"><b>1. </b>Makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;</a></li><li><span class="title-icon "></span><a href="#&#x89E3;&#x6790;aes&#x7B97;&#x6CD5;"><b>2. </b>&#x89E3;&#x6790;AES&#x7B97;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#mraesc&#x6587;&#x4EF6;&#x6E90;&#x7801;"><b>3. </b>mraes.c&#x6587;&#x4EF6;&#x6E90;&#x7801;</a></li></ul></ul></div><h1 id="mraesc"><a name="mraesc" class="anchor-navigation-ex-anchor" href="#mraesc"><i class="fa fa-link" aria-hidden="true"></i></a> mraes.c</h1>
<p>&#x6D4B;&#x8BD5;<a href="https://link.springer.com/book/10.1007/978-3-662-60769-5" target="_blank">AES&#x7B97;&#x6CD5;</a>&#xFF0C;&#x51C6;&#x5907;&#x76F8;&#x5173;&#x6587;&#x4EF6;&#x3002;&#x5176;&#x4E2D;<code>mraes.c</code>&#x5C31;&#x662F;&#x9700;&#x8981;&#x6D4B;&#x8BD5;&#x7684;&#x6587;&#x4EF6;&#xFF0C;<code>miracl.a</code>&#x5C31;&#x662F;&#x7F16;&#x8BD1;&#x5F97;&#x5230;&#x7684;&#x9759;&#x6001;&#x5E93;&#x3002;</p>
<pre class="language-"><code class="lang-c">Makefile    miracl<span class="token punctuation">.</span>a    miracl<span class="token punctuation">.</span>h    mirdef<span class="token punctuation">.</span>h    mraes<span class="token punctuation">.</span>c
</code></pre>
<p>AES&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x53EA;&#x9700;&#x8981;<code>miracl.a</code>&#x548C;&#x76F8;&#x5173;&#x5934;&#x6587;&#x4EF6;&#xFF0C;&#x53CA;Miracl&#x7684;&#x9759;&#x6001;&#x5E93;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x76F8;&#x5173;&#x53C2;&#x6570;&#x5168;&#x90E8;&#x7528;&#x6570;&#x7EC4;&#x7684;&#x5217;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E34;&#x65F6;&#x8BA1;&#x7B97;&#x3002;&#x5982;&#x679C;&#x4E34;&#x65F6;&#x8BA1;&#x7B97;&#xFF0C;&#x90A3;&#x5C31;&#x9700;&#x8981;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x8F85;&#x52A9;&#x3002;</p>
<h2 id="makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;"><a name="makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>1. Makefile&#x6587;&#x4EF6;&#x548C;&#x6D4B;&#x8BD5;</h2>
<p>&#x7528;<code>Makefile</code>&#x7BA1;&#x7406;&#x9879;&#x76EE;&#xFF0C;<code>Makefile</code>&#x7684;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">AES&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6D4B;&#x8BD5;</span></span>
    # &#x6D4B;&#x8BD5; mraes<span class="token punctuation">.</span>c &#x6587;&#x4EF6;

aes <span class="token operator">:</span> aes<span class="token punctuation">.</span>o miracl<span class="token punctuation">.</span>a
    gcc <span class="token operator">-</span>o aes aes<span class="token punctuation">.</span>o miracl<span class="token punctuation">.</span>a

aes<span class="token punctuation">.</span>o <span class="token operator">:</span> mraes<span class="token punctuation">.</span>c
    gcc <span class="token operator">-</span>c <span class="token operator">-</span>o aes<span class="token punctuation">.</span>o mraes<span class="token punctuation">.</span>c


clean <span class="token operator">:</span>
    rm <span class="token operator">-</span>f <span class="token operator">*</span><span class="token punctuation">.</span>o aes
</code></pre>
<p>&#x7ECF;&#x8FC7;&#x7F16;&#x8BD1;&#xFF0C;&#x5F97;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#xFF0C;&#x8868;&#x793A;&#x7F16;&#x8BD1;&#x901A;&#x8FC7;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token operator">%</span> make
gcc <span class="token operator">-</span>c <span class="token operator">-</span>o aes<span class="token punctuation">.</span>o mraes<span class="token punctuation">.</span>c
gcc <span class="token operator">-</span>o aes aes<span class="token punctuation">.</span>o miracl<span class="token punctuation">.</span>a
</code></pre>
<p>&#x6267;&#x884C;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;</p>
<pre class="language-"><code class="lang-c"><span class="token operator">%</span> <span class="token punctuation">.</span><span class="token operator">/</span>aes 

Key Size<span class="token operator">=</span> <span class="token number">128</span> bits
Plain<span class="token operator">=</span>   <span class="token number">000102030405060708090</span>a0b0c0d0e0f
Encrypt<span class="token operator">=</span> fb8c0d88a89188332414b542f0a7d5d2
Decrypt<span class="token operator">=</span> <span class="token number">000102030405060708090</span>a0b0c0d0e0f

Key Size<span class="token operator">=</span> <span class="token number">192</span> bits
Plain<span class="token operator">=</span>   <span class="token number">000102030405060708090</span>a0b0c0d0e0f
Encrypt<span class="token operator">=</span> <span class="token number">0</span>ec4d187a56d28f36b3959f445a956b9
Decrypt<span class="token operator">=</span> <span class="token number">000102030405060708090</span>a0b0c0d0e0f

Key Size<span class="token operator">=</span> <span class="token number">256</span> bits
Plain<span class="token operator">=</span>   <span class="token number">000102030405060708090</span>a0b0c0d0e0f
Encrypt<span class="token operator">=</span> e66e17e6963d760a8a80e000f2da44eb
Decrypt<span class="token operator">=</span> <span class="token number">000102030405060708090</span>a0b0c0d0e0f
</code></pre>
<h2 id="&#x89E3;&#x6790;aes&#x7B97;&#x6CD5;"><a name="&#x89E3;&#x6790;aes&#x7B97;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#&#x89E3;&#x6790;aes&#x7B97;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x89E3;&#x6790;AES&#x7B97;&#x6CD5;</h2>
<p>1&#x3001;&#x5B9A;&#x4E49;&#x76F8;&#x5173;&#x8FD0;&#x7B97;&#x548C;&#x5E38;&#x91CF;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">// &#x5728; mirdef.h &#x4E2D;&#xFF0C;&#x6709;&#x5BF9; mr_unsign32 &#x7684;&#x5B9A;&#x4E49;&#xFF1A;#define mr_unsign32 unsigned int</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MR_WORD</span> <span class="token expression">mr_unsign32</span></span>

<span class="token comment">// &#x72B6;&#x6001;&#x5B57;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5373;&#x660E;&#x6587;&#x5206;&#x7EC4;&#x7684;&#x5B57;&#x957F;&#xFF0C;128/32=4&#xFF0C;&#x6784;&#x9020;&#x72B6;&#x6001;&#x77E9;&#x9635;&#x7684;&#x5217;&#x6570;</span>
<span class="token comment">/* this is fixed */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NB</span> <span class="token expression"><span class="token number">4</span></span></span>

<span class="token comment">/* rotates x one bit to the left */</span>
<span class="token comment">// 8&#x4F4D;&#x4E8C;&#x8FDB;&#x5236;&#x6570; x &#x7684;&#x6700;&#x9AD8;&#x4F4D;&#x8C03;&#x6362;&#x5230;&#x6700;&#x4F4E;&#x4F4D;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token comment">/* Rotates 32-bit word left by 1, 2 or 3 byte  */</span>
<span class="token comment">// 4&#x5B57;&#x8282;&#x5FAA;&#x73AF;&#x5DE6;&#x79FB;&#x8FD0;&#x7B97;&#xFF0C;&#x5DE6;&#x79FB;1&#x3001;2&#x3001;3&#x4E2A;&#x5B57;&#x8282;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL8</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL16</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL24</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre>
<ol>
<li>&#x5B8C;&#x6210;&#x6BD4;&#x7279;&#x4F4D;&#x5DE6;&#x79FB;1&#x4F4D;&#x64CD;&#x4F5C;</li>
<li>&#x5B8C;&#x6210;4&#x5B57;&#x8282;&#x5DE6;&#x79FB;&#xFF0C;&#x5DE6;&#x79FB;1&#x5B57;&#x8282;</li>
<li>&#x5B8C;&#x6210;4&#x5B57;&#x8282;&#x5DE6;&#x79FB;&#xFF0C;&#x5DE6;&#x79FB;2&#x5B57;&#x8282;</li>
<li>&#x5B8C;&#x6210;4&#x5B57;&#x8282;&#x5DE6;&#x79FB;&#xFF0C;&#x5DE6;&#x79FB;3&#x5B57;&#x8282;</li>
</ol>
<p>2&#x3001;&#x56FA;&#x5B9A;S&#x76D2;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x907F;&#x514D;&#x4E34;&#x65F6;&#x8BA1;&#x7B97;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE InCo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE ptab<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE ltab<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE fbsub<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE rbsub<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rco<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable1<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable1<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable2<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable2<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable3<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable3<span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre>
<p>3&#x3001;&#x5B9A;&#x4E49;&#x968F;&#x673A;&#x6570;&#x7EC4;&#xFF0C;&#x7528;&#x4E8E;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">// unsigned 4 chars to unsigned int is 4 bytes to 32-bit</span>
<span class="token comment">// MR_WORD&#xFF1A;unsigned int</span>
<span class="token comment">// MR_BYTE&#xFF1A;unsigned char</span>
<span class="token comment">// &#x5C06;4&#x4E2A;char&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;int&#x6570;&#x636E;</span>
<span class="token keyword">static</span> MR_WORD <span class="token function">pack</span><span class="token punctuation">(</span><span class="token keyword">const</span> MR_BYTE <span class="token operator">*</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* pack bytes into a 32-bit Word */</span>
  <span class="token comment">// 4&#x4E2A;&#x5B57;&#x8282;&#x5168;&#x90E8;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x4E3A; MR_WORD &#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x5206;&#x522B;&#x5DE6;&#x79FB;3&#x3001;2&#x3001;1&#x3001;0&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4F7F;&#x5F97; 4*byte = int</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x5C06;1&#x4E2A;int&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;char&#x6570;&#x636E;</span>
<span class="token comment">// &#x5C06; int &#x7C7B;&#x578B;&#x6570;&#x636E;&#x62C6;&#x5206;&#x4E3A;4&#x4E2A; char &#x7C7B;&#x578B;&#x6570;&#x636E;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">unpack</span><span class="token punctuation">(</span>MR_WORD a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* unpack bytes from a word */</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>4&#x3001;&#x8BA1;&#x7B97; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><mi>L</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Log(x) + Log(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> &#x7684;&#x53CD;&#x5BF9;&#x6570;&#xFF0C;&#x5373; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>&#x2217;</mo><mi>y</mi><mo>=</mo><mi>A</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>L</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>L</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><mi>L</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>y</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">x*y= AntiLog(Log(x) + Log(y))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mbin">&#x2217;</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathit">A</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<pre class="language-"><code class="lang-c"><span class="token comment">// &#x8BA1;&#x7B97; Log(x) + Log(y) &#x7684;&#x53CD;&#x5BF9;&#x6570;&#xFF0C;&#x5373; x.y= AntiLog(Log(x) + Log(y))</span>
<span class="token comment">// &#x5982;&#x679C; x &amp;&amp; y != 0&#xFF0C;&#x5373;x&#x548C;y&#x90FD;&#x4E0D;&#x4E3A;0&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x53CD;&#x5BF9;&#x6570;</span>
<span class="token comment">// bmul() &#x5E76;&#x6CA1;&#x6709;&#x7ED9;&#x51FA;&#x53CD;&#x5BF9;&#x6570;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x53EA;&#x662F;&#x7528;&#x6570;&#x7EC4;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x6848;&#x4F8B;</span>
<span class="token keyword">static</span> MR_BYTE <span class="token function">bmul</span><span class="token punctuation">(</span>MR_BYTE x<span class="token punctuation">,</span>MR_BYTE y<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* x.y= AntiLog(Log(x) + Log(y)) */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> ptab<span class="token punctuation">[</span><span class="token punctuation">(</span>ltab<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">+</span>ltab<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>5&#x3001;&#x5B8C;&#x6210;1&#x4E2A;Word&#xFF08;4&#x4E2A;Byte&#xFF09;&#x7684;&#x7F6E;&#x6362;&#xFF0C;&#x5148;&#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte&#xFF0C;&#x7136;&#x540E;&#x67E5;&#x8868;&#x7F6E;&#x6362;&#xFF0C;&#x6700;&#x540E;&#x5C06;4&#x4E2A;Byte&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;Word&#x8FD4;&#x56DE;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">// &#x5B8C;&#x6210;1&#x4E2A;Word&#xFF08;4&#x4E2A;Byte&#xFF09;&#x7684;&#x7F6E;&#x6362;</span>
<span class="token keyword">static</span> MR_WORD <span class="token function">SubByte</span><span class="token punctuation">(</span>MR_WORD a<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MR_BYTE b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte</span>
    <span class="token comment">// &#x67E5;&#x8868;&#x5B8C;&#x6210;&#x7F6E;&#x6362;</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">pack</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &#x5C06;4&#x4E2A;Byte&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;Word</span>
<span class="token punctuation">}</span>
</code></pre>
<p>6&#x3001;&#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x70B9;&#x4E58;&#xFF0C;&#x5148;&#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x4E24;&#x4E24;&#x76F8;&#x4E58;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x70B9;&#x4E58;&#x7684;&#x7ED3;&#x679C;&#x505A;&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x8FD4;&#x56DE;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">// &#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x70B9;&#x4E58;</span>
<span class="token keyword">static</span> MR_BYTE <span class="token function">product</span><span class="token punctuation">(</span>MR_WORD x<span class="token punctuation">,</span>MR_WORD y<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* dot product of two 4-byte arrays */</span>
    MR_BYTE xb<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>xb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>yb<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// &#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x4E24;&#x4E24;&#x76F8;&#x4E58;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x70B9;&#x4E58;&#x7684;&#x7ED3;&#x679C;&#x505A;&#x5F02;&#x6216;&#x8FD0;&#x7B97;</span>
    <span class="token keyword">return</span> <span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>7&#x3001;&#x5B9E;&#x73B0;&#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x77E9;&#x9635;&#x4E58;&#x6CD5;&#x8FD0;&#x7B97;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">static</span> MR_WORD <span class="token function">InvMixCol</span><span class="token punctuation">(</span>MR_WORD x<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* matrix Multiplication */</span>
    MR_WORD y<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    MR_BYTE b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    m<span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span>InCo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;4&#x4E2A;Byte&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;Word</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x77E9;&#x9635;&#x70B9;&#x4E58;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5DE6;&#x79FB;3&#x4E2A;&#x5B57;&#x8282;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>8&#x3001;&#x91CD;&#x7F6E;AES&#xFF0C;&#x5C06;16&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x5168;&#x90E8;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">/*
&#x91CD;&#x7F6E;AES&#xFF0C;&#x5C06;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x5168;&#x90E8;&#x521D;&#x59CB;&#x5316;
aes&#x7C7B;&#x578B;&#x53D8;&#x91CF;&#xFF0C;&#x786E;&#x5B9A;AES&#x76F8;&#x5173;&#x7684;&#x53C2;&#x6570;
&#x53C2;&#x6570;mode&#xFF1A;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#xFF0C;AES&#x4E3A;CBC&#x6A21;&#x5F0F;
&#x53C2;&#x6570;iv&#xFF1A;&#x521D;&#x59CB;&#x5411;&#x91CF;
*/</span>
<span class="token keyword">void</span> <span class="token function">aes_reset</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* reset mode, or reset iv */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    a<span class="token operator">-&gt;</span>mode<span class="token operator">=</span>mode<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode<span class="token operator">!=</span>MR_ECB <span class="token operator">&amp;&amp;</span> iv<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x5176;&#x4E2D;aes&#x7684;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF0C;&#x5206;&#x522B;&#x89C4;&#x5B9A;&#x4E86;AES &#x7684;&#x5BC6;&#x94A5;&#x5B57;&#x957F;&#x5EA6;&#xFF0C;&#x8FED;&#x4EE3;&#x6B21;&#x6570;&#xFF0C;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#x7B49;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#x6709;&#x4E94;&#x79CD;&#xFF1A;</p>
<ol>
<li>&#x7535;&#x7801;&#x672C;&#x6A21;&#x5F0F;&#xFF08;Electronic Codebook Book (ECB)&#xFF09;&#xFF1B;</li>
<li>&#x5BC6;&#x7801;&#x5206;&#x7EC4;&#x94FE;&#x63A5;&#x6A21;&#x5F0F;&#xFF08;Cipher Block Chaining (CBC)&#xFF09;&#xFF1B;</li>
<li>&#x8BA1;&#x7B97;&#x5668;&#x6A21;&#x5F0F;&#xFF08;Counter (CTR)&#xFF09;&#xFF1B;</li>
<li>&#x5BC6;&#x7801;&#x53CD;&#x9988;&#x6A21;&#x5F0F;&#xFF08;Cipher FeedBack (CFB)&#xFF09;&#xFF1B;</li>
<li>&#x8F93;&#x51FA;&#x53CD;&#x9988;&#x6A21;&#x5F0F;&#xFF08;Output FeedBack (OFB)&#xFF09;&#xFF1B;</li>
</ol>
<p>&#x5728;<code>miracl.h</code>&#x5B9A;&#x4E49;&#x4E86;<code>aes</code>&#x7C7B;&#x578B;&#xFF0C;&#x5C31;&#x6709;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#x7684;&#x9009;&#x62E9;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> Nk<span class="token punctuation">,</span>Nr<span class="token punctuation">;</span>
    <span class="token keyword">int</span> mode<span class="token punctuation">;</span>
    mr_unsign32 fkey<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mr_unsign32 rkey<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> aes<span class="token punctuation">;</span>
</code></pre>
<p>&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x7A0D;&#x5FAE;&#x8C03;&#x6574;&#xFF0C;&#x4EE5;&#x4F18;&#x5316;&#x6548;&#x7387;&#xFF0C;&#x4F18;&#x5316;&#x5982;&#x4E0B;&#xFF0C;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">aes_reset</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* reset mode, or reset iv */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    a<span class="token operator">-&gt;</span>mode<span class="token operator">=</span>mode<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode<span class="token operator">!=</span>MR_ECB <span class="token operator">&amp;&amp;</span> iv<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>9&#x3001;&#x83B7;&#x53D6;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x7684;&#x5168;&#x90E8;&#x5143;&#x7D20;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">aes_getreg</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>ir<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> ir<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>10&#x3001;&#x521D;&#x59CB;&#x5316; </p>
<pre class="language-"><code class="lang-c"><span class="token comment">/*
&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;
a&#xFF1A;&#x83B7;&#x53D6;AES&#x7684;&#x76F8;&#x5173;&#x53C2;&#x6570;
mode&#xFF1A;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;
nk&#xFF1A;&#x5BC6;&#x94A5;&#x5B57;&#x957F;&#x5EA6;
key&#xFF1A;&#x5BC6;&#x94A5;&#x77E9;&#x9635;
iv&#xFF1A;&#x521D;&#x59CB;&#x5411;&#x91CF;
*/</span>
BOOL <span class="token function">aes_init</span><span class="token punctuation">(</span>aes<span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token keyword">int</span> nk<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* Key=nk bytes */</span>
  <span class="token comment">/* currently NB.nk = 16, 24 or 32          */</span>
  <span class="token comment">/* Key Scheduler. Create expanded encryption key */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">,</span>N<span class="token punctuation">,</span>nr<span class="token punctuation">;</span>
    MR_WORD CipherKey<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x6700;&#x591A;&#x6709;8&#x4E2A;&#x5B57;&#x957F;&#x7684;&#x5BC6;&#x94A5;</span>

    nk<span class="token operator">/=</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// &#x5BC6;&#x94A5;&#x957F;&#x5EA6;&#x9664;&#x4EE5;4&#xFF0C;&#x53D8;&#x6210;&#x5B57;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5217;&#x6570;</span>

    <span class="token comment">// &#x5982;&#x679C;&#x5217;&#x6570;&#x4E0D;&#x662F;4&#x3001;6&#x3001;8&#xFF0C;&#x5373;&#x4E0D;&#x662F;AES-128&#x3001;AES-192&#x3001;AES-256</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nk<span class="token operator">!=</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> nk<span class="token operator">!=</span><span class="token number">6</span> <span class="token operator">&amp;&amp;</span> nk<span class="token operator">!=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

    <span class="token comment">// &#x5982;&#x679C;&#x662F;AES-128&#x3001;AES-192&#x3001;AES-256&#xFF0C;nk=4&#x3001;6&#x3001;8</span>
  <span class="token comment">/* nr is number of rounds */</span>
    nr<span class="token operator">=</span><span class="token number">6</span><span class="token operator">+</span>nk<span class="token punctuation">;</span> <span class="token comment">// AES-128&#x3001;AES-192&#x3001;AES-256&#x8FED;&#x4EE3;&#x7684;&#x8F6E;&#x6570; nr=10&#x3001;12&#x3001;14</span>

    a<span class="token operator">-&gt;</span>Nk<span class="token operator">=</span>nk<span class="token punctuation">;</span> a<span class="token operator">-&gt;</span>Nr<span class="token operator">=</span>nr<span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x5217;&#x6570;&#x548C;&#x8F6E;&#x6570;</span>

    <span class="token function">aes_reset</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>mode<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;AES&#x7684;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x548C;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;</span>

    N<span class="token operator">=</span>NB<span class="token operator">*</span><span class="token punctuation">(</span>nr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5171;&#x9700;&#x8981;&#x7684;&#x5217;&#x6570;</span>

    <span class="token comment">// &#x5C06;&#x521D;&#x59CB;&#x5BC6;&#x94A5;16/24/32&#x5B57;&#x8282;&#x8F6C;&#x6362;&#x4E3A;4/6/8&#x5BC6;&#x94A5;&#x5B57;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        CipherKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>key<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// &#x5C06;&#x5BC6;&#x94A5;&#x5B57;&#x5B58;&#x50A8;&#x5230;AES&#x7ED3;&#x6784;&#x4E2D;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>CipherKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x5BC6;&#x94A5;&#x6269;&#x5145;</span>
    <span class="token comment">// &#x5217;&#x6570;j&#x4ECE;nk&#x5F00;&#x59CB;&#xFF0C;&#x8F6E;&#x6570;k&#x4ECE;0&#x5F00;&#x59CB;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>nk<span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>N<span class="token punctuation">;</span>j<span class="token operator">+=</span>nk<span class="token punctuation">,</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// &#x7B2C;j-nk&#x5217;&#x4E0E;S&#x76D2;&#x53D8;&#x6362;&#x540E;&#x7684;&#x7B2C;j-1&#x5217;&#x5F02;&#x6216;&#xFF0C;&#x7136;&#x540E;&#x4E0E;&#x8F6E;&#x5E38;&#x91CF;&#x5F02;&#x6216;</span>
        a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span><span class="token function">SubByte</span><span class="token punctuation">(</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span>rco<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nk<span class="token operator">&lt;=</span><span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span> <span class="token comment">// if(nk&gt;6)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span><span class="token function">SubByte</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

 <span class="token comment">/* now for the expanded decrypt key in reverse order */</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>j<span class="token operator">+</span>N<span class="token operator">-</span>NB<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>NB<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>N<span class="token operator">-</span>NB<span class="token punctuation">;</span>i<span class="token operator">+=</span>NB<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        k<span class="token operator">=</span>N<span class="token operator">-</span>NB<span class="token operator">-</span>i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">InvMixCol</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>N<span class="token operator">-</span>NB<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>N<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>j<span class="token operator">-</span>N<span class="token operator">+</span>NB<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>11&#x3001;&#x52A0;&#x5BC6;</p>
<p>&#x52A0;&#x5BC6;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7528;&#x5230;&#x4E86;<a href="../api/cplus.html">SSE&#x6307;&#x4EE4;&#x96C6;</a>&#xFF0C;&#x5982;<code>_mm_loadu_si128</code>&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
    MR_WORD p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>x<span class="token punctuation">,</span><span class="token operator">*</span>y<span class="token punctuation">,</span><span class="token operator">*</span>t<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AES_NI_SUPPORT</span></span>
    __m128i ky<span class="token punctuation">,</span>m <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ky <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token function">_mm_xor_si128</span>       <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m <span class="token operator">=</span><span class="token function">_mm_aesenc_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">_mm_aesenclast_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_mm_storeu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    x<span class="token operator">=</span>p<span class="token punctuation">;</span> y<span class="token operator">=</span>q<span class="token punctuation">;</span>

<span class="token comment">/* State alternates between x and y */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span> <span class="token comment">/* Nr is number of rounds. May be odd. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MR_SMALL_AES</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>x<span class="token punctuation">;</span> x<span class="token operator">=</span>y<span class="token punctuation">;</span> y<span class="token operator">=</span>t<span class="token punctuation">;</span>      <span class="token comment">/* swap pointers */</span>
    <span class="token punctuation">}</span>

<span class="token comment">/* Last Round */</span> 

    y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">/* clean up stack */</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>
</code></pre>
<p>12&#x3001;&#x89E3;&#x5BC6;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
    MR_WORD p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>x<span class="token punctuation">,</span><span class="token operator">*</span>y<span class="token punctuation">,</span><span class="token operator">*</span>t<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AES_NI_SUPPORT</span></span>
    __m128i ky<span class="token punctuation">,</span>m <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ky <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token function">_mm_xor_si128</span>       <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m <span class="token operator">=</span><span class="token function">_mm_aesdec_si128</span>    <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">_mm_aesdeclast_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_mm_storeu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    x<span class="token operator">=</span>p<span class="token punctuation">;</span> y<span class="token operator">=</span>q<span class="token punctuation">;</span>

<span class="token comment">/* State alternates between x and y */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span> <span class="token comment">/* Nr is number of rounds. May be odd. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MR_SMALL_AES</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>x<span class="token punctuation">;</span> x<span class="token operator">=</span>y<span class="token punctuation">;</span> y<span class="token operator">=</span>t<span class="token punctuation">;</span>      <span class="token comment">/* swap pointers */</span>
    <span class="token punctuation">}</span>

<span class="token comment">/* Last Round */</span> 
    y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">/* clean up stack */</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>
</code></pre>
<p>13&#x3001;&#x52A0;&#x5BC6;&#x548C;&#x89E3;&#x5BC6;</p>
<pre class="language-"><code class="lang-c">mr_unsign32 <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>aes<span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span>bytes<span class="token punctuation">;</span>
    <span class="token keyword">char</span> st<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mr_unsign32 fell_off<span class="token punctuation">;</span>

<span class="token comment">/* Supported Modes of Operation */</span>

    fell_off<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>mode<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> MR_ECB<span class="token operator">:</span> 
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CBC<span class="token operator">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_CFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB4<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_CFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_OFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB4<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB8<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB16<span class="token operator">:</span>

        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_OFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_PCFB1<span class="token operator">:</span>   <span class="token comment">/* error propagating CFB */</span>
    <span class="token keyword">case</span> MR_PCFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_PCFB4<span class="token operator">:</span>   
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_PCFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^</span>st<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>

    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

mr_unsign32 <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span>bytes<span class="token punctuation">;</span>
    <span class="token keyword">char</span> st<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mr_unsign32 fell_off<span class="token punctuation">;</span>

   <span class="token comment">/* Supported modes of operation */</span>
    fell_off<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>mode<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> MR_ECB<span class="token operator">:</span>
        <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CBC<span class="token operator">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span> 
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB4<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_CFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_OFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB4<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB8<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB16<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_OFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_PCFB1<span class="token operator">:</span>   <span class="token comment">/* error propagating CFB */</span>
    <span class="token keyword">case</span> MR_PCFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_PCFB4<span class="token operator">:</span>

        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_PCFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^</span>st<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>14&#x3001;&#x91CD;&#x7F6E; aes &#x53D8;&#x91CF;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">/*
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x91CD;&#x7F6E; aes &#x53D8;&#x91CF;

NB : 4
Nr : 10 12 14
*/</span>
<span class="token keyword">void</span> <span class="token function">aes_end</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* clean up */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token comment">// &#x5C06; aes &#x4E2D;&#x7684;&#x5BC6;&#x94A5;&#x6570;&#x7EC4;&#x6E05;&#x7A7A;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>Nr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x6E05;&#x7A7A;16&#x5B57;&#x8282;&#x7684;&#x6570;&#x7EC4; f</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>15&#x3001;&#x6D4B;&#x8BD5;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>  <span class="token comment">// &#x4E0B;&#x6807;&#x53C2;&#x6570;</span>
    <span class="token keyword">int</span> nk<span class="token punctuation">;</span> <span class="token comment">// &#x63A7;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x5B57;&#x8282;&#x6570;</span>
    aes a<span class="token punctuation">;</span>  <span class="token comment">// AES &#x7C7B;&#x578B;&#x53D8;&#x91CF;</span>
    MR_BYTE y<span class="token punctuation">,</span>x<span class="token punctuation">,</span>m<span class="token punctuation">;</span>  <span class="token comment">// #define MR_BYTE unsigned char</span>
    <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> block<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x5BC6;&#x94A5;&#x6570;&#x7EC4;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x521D;&#x59CB;&#x5411;&#x91CF;&#xFF0C;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5BC6;&#x94A5;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x660E;&#x6587;&#x5206;&#x7EC4;</span>

    <span class="token comment">// nk &#x63A7;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x589E;&#x91CF;&#x4E3A;8&#xFF0C;&#x5B8C;&#x6210;AES-128&#x3001;AES-192&#x3001;AES-256&#x7684;&#x52A0;&#x89E3;&#x5BC6;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>nk<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">;</span>nk<span class="token operator">&lt;=</span><span class="token number">32</span><span class="token punctuation">;</span>nk<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\nKey Size= %d bits\n&quot;</span><span class="token punctuation">,</span>nk<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">aes_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>MR_CBC<span class="token punctuation">,</span>nk<span class="token punctuation">,</span>key<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to Initialize\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Plain=   &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_encrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypt= &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_reset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>MR_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_decrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Decrypt= &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">aes_end</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!-- mraes.c文件源码 -->
<h2 id="mraesc&#x6587;&#x4EF6;&#x6E90;&#x7801;"><a name="mraesc&#x6587;&#x4EF6;&#x6E90;&#x7801;" class="anchor-navigation-ex-anchor" href="#mraesc&#x6587;&#x4EF6;&#x6E90;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a>3. mraes.c&#x6587;&#x4EF6;&#x6E90;&#x7801;</h2>
<pre class="language-"><code class="lang-c"><span class="token comment">/*
 * Implementation of the NIST Advanced Ecryption Standard
 *
 * Could/Should be speeded up by assembly patches in time critical loops in
 * aes_ecb_encrypt() and aes_ecb_decrypt()
 *
 * Note that the AES winner has not yet been determined! Nonetheless
 * we are jumping the gun a little and implementing one of the favourites
 * RIJNDAEL, partly because it is entirely patent-free.
 *
 * We were right! Rijndael is the AES from October 2nd 2000
 */</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;miracl.h&quot;</span></span>

<span class="token comment">// &#x5982;&#x679C;&#x652F;&#x6301; INTEL AES-NI &#x7CFB;&#x7EDF;&#x7684; intrinsics &#x51FD;&#x6570;&#xFF0C;&#x5219;&#x5B9A;&#x4E49; AES_NI_SUPPORT&#xFF0C;intrinsics &#x51FD;&#x6570;&#x5305;&#x542B;&#x5728; wmmintrin.h &#x5934;&#x6587;&#x4EF6;&#xFF0C;&#x5305;&#x542B;&#x4E86;MMX&#x6307;&#x4EE4;&#x96C6;&#x7684;&#x63CF;&#x8FF0;</span>
<span class="token comment">/* Define this if INTEL AES-NI intrinsics are supported - for example with GCC compiler - use flag -maes */</span> 
<span class="token comment">/* #define AES_NI_SUPPORT */</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AES_NI_SUPPORT</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wmmintrin.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">// &#x5728; mirdef.h &#x4E2D;&#xFF0C;&#x6709;&#x5BF9; mr_unsign32 &#x7684;&#x5B9A;&#x4E49;&#xFF1A;#define mr_unsign32 unsigned int</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MR_WORD</span> <span class="token expression">mr_unsign32</span></span>

<span class="token comment">// &#x72B6;&#x6001;&#x5B57;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5373;&#x660E;&#x6587;&#x5206;&#x7EC4;&#x7684;&#x5B57;&#x957F;&#xFF0C;128/32=4&#xFF0C;&#x6784;&#x9020;&#x72B6;&#x6001;&#x77E9;&#x9635;&#x7684;&#x5217;&#x6570;</span>
<span class="token comment">/* this is fixed */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NB</span> <span class="token expression"><span class="token number">4</span></span></span>

<span class="token comment">/* rotates x one bit to the left */</span>
<span class="token comment">// 8&#x4F4D;&#x4E8C;&#x8FDB;&#x5236;&#x6570; x &#x7684;&#x6700;&#x9AD8;&#x4F4D;&#x8C03;&#x6362;&#x5230;&#x6700;&#x4F4E;&#x4F4D;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token comment">/* Rotates 32-bit word left by 1, 2 or 3 byte  */</span>
<span class="token comment">// 4&#x5B57;&#x8282;&#x5FAA;&#x73AF;&#x5DE6;&#x79FB;&#x8FD0;&#x7B97;&#xFF0C;&#x5DE6;&#x79FB;1&#x3001;2&#x3001;3&#x4E2A;&#x5B57;&#x8282;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL8</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL16</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">ROTL24</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token comment">// &#x5728; miracl.h &#x4E2D;&#x6709;&#x5BF9; MR_BYTE &#x7684;&#x5B9A;&#x4E49;&#xFF1A;#define MR_BYTE unsigned char</span>
<span class="token comment">// InCo &#x4E3A;4&#x5B57;&#x8282;&#x6570;&#x7EC4;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE InCo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0xB</span><span class="token punctuation">,</span><span class="token number">0xD</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0xE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">/* Inverse Coefficients */</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE ptab<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">161</span><span class="token punctuation">,</span><span class="token number">248</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span>
<span class="token number">95</span><span class="token punctuation">,</span><span class="token number">225</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">149</span><span class="token punctuation">,</span><span class="token number">164</span><span class="token punctuation">,</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">,</span>
<span class="token number">229</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">228</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">235</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">190</span><span class="token punctuation">,</span><span class="token number">217</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">144</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">,</span><span class="token number">230</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span>
<span class="token number">83</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">204</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">209</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">178</span><span class="token punctuation">,</span><span class="token number">205</span><span class="token punctuation">,</span>
<span class="token number">76</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">169</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">215</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">166</span><span class="token punctuation">,</span><span class="token number">241</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span>
<span class="token number">131</span><span class="token punctuation">,</span><span class="token number">158</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">,</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">189</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">129</span><span class="token punctuation">,</span><span class="token number">152</span><span class="token punctuation">,</span><span class="token number">179</span><span class="token punctuation">,</span><span class="token number">206</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">219</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">154</span><span class="token punctuation">,</span>
<span class="token number">181</span><span class="token punctuation">,</span><span class="token number">196</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">249</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">187</span><span class="token punctuation">,</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">163</span><span class="token punctuation">,</span>
<span class="token number">254</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">135</span><span class="token punctuation">,</span><span class="token number">146</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">,</span><span class="token number">236</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">147</span><span class="token punctuation">,</span><span class="token number">174</span><span class="token punctuation">,</span><span class="token number">233</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">,</span>
<span class="token number">251</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">183</span><span class="token punctuation">,</span><span class="token number">194</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">231</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span>
<span class="token number">195</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">226</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">192</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">237</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">156</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span>
<span class="token number">159</span><span class="token punctuation">,</span><span class="token number">186</span><span class="token punctuation">,</span><span class="token number">213</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">172</span><span class="token punctuation">,</span><span class="token number">239</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">126</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span><span class="token number">188</span><span class="token punctuation">,</span><span class="token number">223</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">142</span><span class="token punctuation">,</span><span class="token number">137</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span>
<span class="token number">155</span><span class="token punctuation">,</span><span class="token number">182</span><span class="token punctuation">,</span><span class="token number">193</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">175</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">177</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">197</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span>
<span class="token number">252</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">165</span><span class="token punctuation">,</span><span class="token number">244</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">153</span><span class="token punctuation">,</span><span class="token number">176</span><span class="token punctuation">,</span><span class="token number">203</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">202</span><span class="token punctuation">,</span>
<span class="token number">69</span><span class="token punctuation">,</span><span class="token number">207</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">222</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">134</span><span class="token punctuation">,</span><span class="token number">145</span><span class="token punctuation">,</span><span class="token number">168</span><span class="token punctuation">,</span><span class="token number">227</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">198</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">243</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span>
<span class="token number">18</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">140</span><span class="token punctuation">,</span><span class="token number">143</span><span class="token punctuation">,</span><span class="token number">138</span><span class="token punctuation">,</span><span class="token number">133</span><span class="token punctuation">,</span><span class="token number">148</span><span class="token punctuation">,</span><span class="token number">167</span><span class="token punctuation">,</span><span class="token number">242</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span>
<span class="token number">57</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">221</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">132</span><span class="token punctuation">,</span><span class="token number">151</span><span class="token punctuation">,</span><span class="token number">162</span><span class="token punctuation">,</span><span class="token number">253</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">199</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">246</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE ltab<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">198</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">199</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">223</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>
<span class="token number">100</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">129</span><span class="token punctuation">,</span><span class="token number">239</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">248</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">193</span><span class="token punctuation">,</span>
<span class="token number">125</span><span class="token punctuation">,</span><span class="token number">194</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">181</span><span class="token punctuation">,</span><span class="token number">249</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">228</span><span class="token punctuation">,</span><span class="token number">166</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span>
<span class="token number">101</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">138</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">225</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">147</span><span class="token punctuation">,</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token number">142</span><span class="token punctuation">,</span>
<span class="token number">150</span><span class="token punctuation">,</span><span class="token number">143</span><span class="token punctuation">,</span><span class="token number">219</span><span class="token punctuation">,</span><span class="token number">189</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">208</span><span class="token punctuation">,</span><span class="token number">206</span><span class="token punctuation">,</span><span class="token number">148</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">241</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">131</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span>
<span class="token number">102</span><span class="token punctuation">,</span><span class="token number">221</span><span class="token punctuation">,</span><span class="token number">253</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">179</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">226</span><span class="token punctuation">,</span><span class="token number">152</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span><span class="token number">145</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span>
<span class="token number">126</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">195</span><span class="token punctuation">,</span><span class="token number">163</span><span class="token punctuation">,</span><span class="token number">182</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">133</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">186</span><span class="token punctuation">,</span>
<span class="token number">43</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">155</span><span class="token punctuation">,</span><span class="token number">159</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">,</span><span class="token number">172</span><span class="token punctuation">,</span><span class="token number">229</span><span class="token punctuation">,</span><span class="token number">243</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">167</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span>
<span class="token number">175</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">168</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">244</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">174</span><span class="token punctuation">,</span><span class="token number">233</span><span class="token punctuation">,</span><span class="token number">213</span><span class="token punctuation">,</span><span class="token number">231</span><span class="token punctuation">,</span><span class="token number">230</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">,</span>
<span class="token number">44</span><span class="token punctuation">,</span><span class="token number">215</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">235</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">203</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">176</span><span class="token punctuation">,</span><span class="token number">156</span><span class="token punctuation">,</span><span class="token number">169</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">,</span>
<span class="token number">127</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">246</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">196</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">236</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">164</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">183</span><span class="token punctuation">,</span>
<span class="token number">204</span><span class="token punctuation">,</span><span class="token number">187</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">177</span><span class="token punctuation">,</span><span class="token number">134</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">161</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span>
<span class="token number">151</span><span class="token punctuation">,</span><span class="token number">178</span><span class="token punctuation">,</span><span class="token number">135</span><span class="token punctuation">,</span><span class="token number">144</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">190</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token number">252</span><span class="token punctuation">,</span><span class="token number">188</span><span class="token punctuation">,</span><span class="token number">149</span><span class="token punctuation">,</span><span class="token number">207</span><span class="token punctuation">,</span><span class="token number">205</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">209</span><span class="token punctuation">,</span>
<span class="token number">83</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">132</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">162</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">158</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">242</span><span class="token punctuation">,</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">,</span>
<span class="token number">68</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">146</span><span class="token punctuation">,</span><span class="token number">217</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">137</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">153</span><span class="token punctuation">,</span><span class="token number">227</span><span class="token punctuation">,</span><span class="token number">165</span><span class="token punctuation">,</span>
<span class="token number">103</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">237</span><span class="token punctuation">,</span><span class="token number">222</span><span class="token punctuation">,</span><span class="token number">197</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">140</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">192</span><span class="token punctuation">,</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE fbsub<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">242</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">197</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">,</span><span class="token number">215</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span>
<span class="token number">202</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">,</span><span class="token number">162</span><span class="token punctuation">,</span><span class="token number">175</span><span class="token punctuation">,</span><span class="token number">156</span><span class="token punctuation">,</span><span class="token number">164</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">192</span><span class="token punctuation">,</span>
<span class="token number">183</span><span class="token punctuation">,</span><span class="token number">253</span><span class="token punctuation">,</span><span class="token number">147</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">204</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">165</span><span class="token punctuation">,</span><span class="token number">229</span><span class="token punctuation">,</span><span class="token number">241</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">199</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">195</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">226</span><span class="token punctuation">,</span><span class="token number">235</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">178</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span>
<span class="token number">9</span><span class="token punctuation">,</span><span class="token number">131</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token number">179</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">227</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">132</span><span class="token punctuation">,</span>
<span class="token number">83</span><span class="token punctuation">,</span><span class="token number">209</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">237</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">252</span><span class="token punctuation">,</span><span class="token number">177</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">203</span><span class="token punctuation">,</span><span class="token number">190</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">207</span><span class="token punctuation">,</span>
<span class="token number">208</span><span class="token punctuation">,</span><span class="token number">239</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">133</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">249</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">159</span><span class="token punctuation">,</span><span class="token number">168</span><span class="token punctuation">,</span>
<span class="token number">81</span><span class="token punctuation">,</span><span class="token number">163</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">143</span><span class="token punctuation">,</span><span class="token number">146</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">188</span><span class="token punctuation">,</span><span class="token number">182</span><span class="token punctuation">,</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">243</span><span class="token punctuation">,</span><span class="token number">210</span><span class="token punctuation">,</span>
<span class="token number">205</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">236</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">151</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">196</span><span class="token punctuation">,</span><span class="token number">167</span><span class="token punctuation">,</span><span class="token number">126</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span>
<span class="token number">96</span><span class="token punctuation">,</span><span class="token number">129</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">144</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">222</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">219</span><span class="token punctuation">,</span>
<span class="token number">224</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">194</span><span class="token punctuation">,</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">172</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">145</span><span class="token punctuation">,</span><span class="token number">149</span><span class="token punctuation">,</span><span class="token number">228</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span>
<span class="token number">231</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">213</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">169</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">244</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">174</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>
<span class="token number">186</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">166</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">198</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">,</span><span class="token number">221</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">189</span><span class="token punctuation">,</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">138</span><span class="token punctuation">,</span>
<span class="token number">112</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">181</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">246</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">,</span><span class="token number">134</span><span class="token punctuation">,</span><span class="token number">193</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">158</span><span class="token punctuation">,</span>
<span class="token number">225</span><span class="token punctuation">,</span><span class="token number">248</span><span class="token punctuation">,</span><span class="token number">152</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">217</span><span class="token punctuation">,</span><span class="token number">142</span><span class="token punctuation">,</span><span class="token number">148</span><span class="token punctuation">,</span><span class="token number">155</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">135</span><span class="token punctuation">,</span><span class="token number">233</span><span class="token punctuation">,</span><span class="token number">206</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">223</span><span class="token punctuation">,</span>
<span class="token number">140</span><span class="token punctuation">,</span><span class="token number">161</span><span class="token punctuation">,</span><span class="token number">137</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">230</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">153</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">176</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">187</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_BYTE rbsub<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">213</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">165</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">163</span><span class="token punctuation">,</span><span class="token number">158</span><span class="token punctuation">,</span><span class="token number">129</span><span class="token punctuation">,</span><span class="token number">243</span><span class="token punctuation">,</span><span class="token number">215</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span>
<span class="token number">124</span><span class="token punctuation">,</span><span class="token number">227</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">130</span><span class="token punctuation">,</span><span class="token number">155</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">135</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">142</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">196</span><span class="token punctuation">,</span><span class="token number">222</span><span class="token punctuation">,</span><span class="token number">233</span><span class="token punctuation">,</span><span class="token number">203</span><span class="token punctuation">,</span>
<span class="token number">84</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">148</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">166</span><span class="token punctuation">,</span><span class="token number">194</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">149</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">195</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span>
<span class="token number">8</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">161</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">217</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">178</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">162</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">139</span><span class="token punctuation">,</span><span class="token number">209</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span>
<span class="token number">114</span><span class="token punctuation">,</span><span class="token number">248</span><span class="token punctuation">,</span><span class="token number">246</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">134</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">152</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">,</span><span class="token number">164</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">204</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">182</span><span class="token punctuation">,</span><span class="token number">146</span><span class="token punctuation">,</span>
<span class="token number">108</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">253</span><span class="token punctuation">,</span><span class="token number">237</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">,</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">167</span><span class="token punctuation">,</span><span class="token number">141</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span><span class="token number">132</span><span class="token punctuation">,</span>
<span class="token number">144</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">140</span><span class="token punctuation">,</span><span class="token number">188</span><span class="token punctuation">,</span><span class="token number">211</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">247</span><span class="token punctuation">,</span><span class="token number">228</span><span class="token punctuation">,</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">179</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span>
<span class="token number">208</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">143</span><span class="token punctuation">,</span><span class="token number">202</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">193</span><span class="token punctuation">,</span><span class="token number">175</span><span class="token punctuation">,</span><span class="token number">189</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">138</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span>
<span class="token number">58</span><span class="token punctuation">,</span><span class="token number">145</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">220</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">151</span><span class="token punctuation">,</span><span class="token number">242</span><span class="token punctuation">,</span><span class="token number">207</span><span class="token punctuation">,</span><span class="token number">206</span><span class="token punctuation">,</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">230</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span>
<span class="token number">150</span><span class="token punctuation">,</span><span class="token number">172</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">231</span><span class="token punctuation">,</span><span class="token number">173</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">133</span><span class="token punctuation">,</span><span class="token number">226</span><span class="token punctuation">,</span><span class="token number">249</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">223</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span>
<span class="token number">71</span><span class="token punctuation">,</span><span class="token number">241</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">197</span><span class="token punctuation">,</span><span class="token number">137</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">183</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">190</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span>
<span class="token number">252</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">198</span><span class="token punctuation">,</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">219</span><span class="token punctuation">,</span><span class="token number">192</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">205</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">244</span><span class="token punctuation">,</span>
<span class="token number">31</span><span class="token punctuation">,</span><span class="token number">221</span><span class="token punctuation">,</span><span class="token number">168</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">199</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">177</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">236</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span>
<span class="token number">96</span><span class="token punctuation">,</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">169</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">181</span><span class="token punctuation">,</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">229</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">159</span><span class="token punctuation">,</span><span class="token number">147</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">,</span><span class="token number">156</span><span class="token punctuation">,</span><span class="token number">239</span><span class="token punctuation">,</span>
<span class="token number">160</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">174</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">176</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">235</span><span class="token punctuation">,</span><span class="token number">187</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">131</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">153</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span>
<span class="token number">23</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">126</span><span class="token punctuation">,</span><span class="token number">186</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">225</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rco<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0xa56363c6</span><span class="token punctuation">,</span><span class="token number">0x847c7cf8</span><span class="token punctuation">,</span><span class="token number">0x997777ee</span><span class="token punctuation">,</span><span class="token number">0x8d7b7bf6</span><span class="token punctuation">,</span><span class="token number">0xdf2f2ff</span><span class="token punctuation">,</span><span class="token number">0xbd6b6bd6</span><span class="token punctuation">,</span>
<span class="token number">0xb16f6fde</span><span class="token punctuation">,</span><span class="token number">0x54c5c591</span><span class="token punctuation">,</span><span class="token number">0x50303060</span><span class="token punctuation">,</span><span class="token number">0x3010102</span><span class="token punctuation">,</span><span class="token number">0xa96767ce</span><span class="token punctuation">,</span><span class="token number">0x7d2b2b56</span><span class="token punctuation">,</span>
<span class="token number">0x19fefee7</span><span class="token punctuation">,</span><span class="token number">0x62d7d7b5</span><span class="token punctuation">,</span><span class="token number">0xe6abab4d</span><span class="token punctuation">,</span><span class="token number">0x9a7676ec</span><span class="token punctuation">,</span><span class="token number">0x45caca8f</span><span class="token punctuation">,</span><span class="token number">0x9d82821f</span><span class="token punctuation">,</span>
<span class="token number">0x40c9c989</span><span class="token punctuation">,</span><span class="token number">0x877d7dfa</span><span class="token punctuation">,</span><span class="token number">0x15fafaef</span><span class="token punctuation">,</span><span class="token number">0xeb5959b2</span><span class="token punctuation">,</span><span class="token number">0xc947478e</span><span class="token punctuation">,</span><span class="token number">0xbf0f0fb</span><span class="token punctuation">,</span>
<span class="token number">0xecadad41</span><span class="token punctuation">,</span><span class="token number">0x67d4d4b3</span><span class="token punctuation">,</span><span class="token number">0xfda2a25f</span><span class="token punctuation">,</span><span class="token number">0xeaafaf45</span><span class="token punctuation">,</span><span class="token number">0xbf9c9c23</span><span class="token punctuation">,</span><span class="token number">0xf7a4a453</span><span class="token punctuation">,</span>
<span class="token number">0x967272e4</span><span class="token punctuation">,</span><span class="token number">0x5bc0c09b</span><span class="token punctuation">,</span><span class="token number">0xc2b7b775</span><span class="token punctuation">,</span><span class="token number">0x1cfdfde1</span><span class="token punctuation">,</span><span class="token number">0xae93933d</span><span class="token punctuation">,</span><span class="token number">0x6a26264c</span><span class="token punctuation">,</span>
<span class="token number">0x5a36366c</span><span class="token punctuation">,</span><span class="token number">0x413f3f7e</span><span class="token punctuation">,</span><span class="token number">0x2f7f7f5</span><span class="token punctuation">,</span><span class="token number">0x4fcccc83</span><span class="token punctuation">,</span><span class="token number">0x5c343468</span><span class="token punctuation">,</span><span class="token number">0xf4a5a551</span><span class="token punctuation">,</span>
<span class="token number">0x34e5e5d1</span><span class="token punctuation">,</span><span class="token number">0x8f1f1f9</span><span class="token punctuation">,</span><span class="token number">0x937171e2</span><span class="token punctuation">,</span><span class="token number">0x73d8d8ab</span><span class="token punctuation">,</span><span class="token number">0x53313162</span><span class="token punctuation">,</span><span class="token number">0x3f15152a</span><span class="token punctuation">,</span>
<span class="token number">0xc040408</span><span class="token punctuation">,</span><span class="token number">0x52c7c795</span><span class="token punctuation">,</span><span class="token number">0x65232346</span><span class="token punctuation">,</span><span class="token number">0x5ec3c39d</span><span class="token punctuation">,</span><span class="token number">0x28181830</span><span class="token punctuation">,</span><span class="token number">0xa1969637</span><span class="token punctuation">,</span>
<span class="token number">0xf05050a</span><span class="token punctuation">,</span><span class="token number">0xb59a9a2f</span><span class="token punctuation">,</span><span class="token number">0x907070e</span><span class="token punctuation">,</span><span class="token number">0x36121224</span><span class="token punctuation">,</span><span class="token number">0x9b80801b</span><span class="token punctuation">,</span><span class="token number">0x3de2e2df</span><span class="token punctuation">,</span>
<span class="token number">0x26ebebcd</span><span class="token punctuation">,</span><span class="token number">0x6927274e</span><span class="token punctuation">,</span><span class="token number">0xcdb2b27f</span><span class="token punctuation">,</span><span class="token number">0x9f7575ea</span><span class="token punctuation">,</span><span class="token number">0x1b090912</span><span class="token punctuation">,</span><span class="token number">0x9e83831d</span><span class="token punctuation">,</span>
<span class="token number">0x742c2c58</span><span class="token punctuation">,</span><span class="token number">0x2e1a1a34</span><span class="token punctuation">,</span><span class="token number">0x2d1b1b36</span><span class="token punctuation">,</span><span class="token number">0xb26e6edc</span><span class="token punctuation">,</span><span class="token number">0xee5a5ab4</span><span class="token punctuation">,</span><span class="token number">0xfba0a05b</span><span class="token punctuation">,</span>
<span class="token number">0xf65252a4</span><span class="token punctuation">,</span><span class="token number">0x4d3b3b76</span><span class="token punctuation">,</span><span class="token number">0x61d6d6b7</span><span class="token punctuation">,</span><span class="token number">0xceb3b37d</span><span class="token punctuation">,</span><span class="token number">0x7b292952</span><span class="token punctuation">,</span><span class="token number">0x3ee3e3dd</span><span class="token punctuation">,</span>
<span class="token number">0x712f2f5e</span><span class="token punctuation">,</span><span class="token number">0x97848413</span><span class="token punctuation">,</span><span class="token number">0xf55353a6</span><span class="token punctuation">,</span><span class="token number">0x68d1d1b9</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x2cededc1</span><span class="token punctuation">,</span>
<span class="token number">0x60202040</span><span class="token punctuation">,</span><span class="token number">0x1ffcfce3</span><span class="token punctuation">,</span><span class="token number">0xc8b1b179</span><span class="token punctuation">,</span><span class="token number">0xed5b5bb6</span><span class="token punctuation">,</span><span class="token number">0xbe6a6ad4</span><span class="token punctuation">,</span><span class="token number">0x46cbcb8d</span><span class="token punctuation">,</span>
<span class="token number">0xd9bebe67</span><span class="token punctuation">,</span><span class="token number">0x4b393972</span><span class="token punctuation">,</span><span class="token number">0xde4a4a94</span><span class="token punctuation">,</span><span class="token number">0xd44c4c98</span><span class="token punctuation">,</span><span class="token number">0xe85858b0</span><span class="token punctuation">,</span><span class="token number">0x4acfcf85</span><span class="token punctuation">,</span>
<span class="token number">0x6bd0d0bb</span><span class="token punctuation">,</span><span class="token number">0x2aefefc5</span><span class="token punctuation">,</span><span class="token number">0xe5aaaa4f</span><span class="token punctuation">,</span><span class="token number">0x16fbfbed</span><span class="token punctuation">,</span><span class="token number">0xc5434386</span><span class="token punctuation">,</span><span class="token number">0xd74d4d9a</span><span class="token punctuation">,</span>
<span class="token number">0x55333366</span><span class="token punctuation">,</span><span class="token number">0x94858511</span><span class="token punctuation">,</span><span class="token number">0xcf45458a</span><span class="token punctuation">,</span><span class="token number">0x10f9f9e9</span><span class="token punctuation">,</span><span class="token number">0x6020204</span><span class="token punctuation">,</span><span class="token number">0x817f7ffe</span><span class="token punctuation">,</span>
<span class="token number">0xf05050a0</span><span class="token punctuation">,</span><span class="token number">0x443c3c78</span><span class="token punctuation">,</span><span class="token number">0xba9f9f25</span><span class="token punctuation">,</span><span class="token number">0xe3a8a84b</span><span class="token punctuation">,</span><span class="token number">0xf35151a2</span><span class="token punctuation">,</span><span class="token number">0xfea3a35d</span><span class="token punctuation">,</span>
<span class="token number">0xc0404080</span><span class="token punctuation">,</span><span class="token number">0x8a8f8f05</span><span class="token punctuation">,</span><span class="token number">0xad92923f</span><span class="token punctuation">,</span><span class="token number">0xbc9d9d21</span><span class="token punctuation">,</span><span class="token number">0x48383870</span><span class="token punctuation">,</span><span class="token number">0x4f5f5f1</span><span class="token punctuation">,</span>
<span class="token number">0xdfbcbc63</span><span class="token punctuation">,</span><span class="token number">0xc1b6b677</span><span class="token punctuation">,</span><span class="token number">0x75dadaaf</span><span class="token punctuation">,</span><span class="token number">0x63212142</span><span class="token punctuation">,</span><span class="token number">0x30101020</span><span class="token punctuation">,</span><span class="token number">0x1affffe5</span><span class="token punctuation">,</span>
<span class="token number">0xef3f3fd</span><span class="token punctuation">,</span><span class="token number">0x6dd2d2bf</span><span class="token punctuation">,</span><span class="token number">0x4ccdcd81</span><span class="token punctuation">,</span><span class="token number">0x140c0c18</span><span class="token punctuation">,</span><span class="token number">0x35131326</span><span class="token punctuation">,</span><span class="token number">0x2fececc3</span><span class="token punctuation">,</span>
<span class="token number">0xe15f5fbe</span><span class="token punctuation">,</span><span class="token number">0xa2979735</span><span class="token punctuation">,</span><span class="token number">0xcc444488</span><span class="token punctuation">,</span><span class="token number">0x3917172e</span><span class="token punctuation">,</span><span class="token number">0x57c4c493</span><span class="token punctuation">,</span><span class="token number">0xf2a7a755</span><span class="token punctuation">,</span>
<span class="token number">0x827e7efc</span><span class="token punctuation">,</span><span class="token number">0x473d3d7a</span><span class="token punctuation">,</span><span class="token number">0xac6464c8</span><span class="token punctuation">,</span><span class="token number">0xe75d5dba</span><span class="token punctuation">,</span><span class="token number">0x2b191932</span><span class="token punctuation">,</span><span class="token number">0x957373e6</span><span class="token punctuation">,</span>
<span class="token number">0xa06060c0</span><span class="token punctuation">,</span><span class="token number">0x98818119</span><span class="token punctuation">,</span><span class="token number">0xd14f4f9e</span><span class="token punctuation">,</span><span class="token number">0x7fdcdca3</span><span class="token punctuation">,</span><span class="token number">0x66222244</span><span class="token punctuation">,</span><span class="token number">0x7e2a2a54</span><span class="token punctuation">,</span>
<span class="token number">0xab90903b</span><span class="token punctuation">,</span><span class="token number">0x8388880b</span><span class="token punctuation">,</span><span class="token number">0xca46468c</span><span class="token punctuation">,</span><span class="token number">0x29eeeec7</span><span class="token punctuation">,</span><span class="token number">0xd3b8b86b</span><span class="token punctuation">,</span><span class="token number">0x3c141428</span><span class="token punctuation">,</span>
<span class="token number">0x79dedea7</span><span class="token punctuation">,</span><span class="token number">0xe25e5ebc</span><span class="token punctuation">,</span><span class="token number">0x1d0b0b16</span><span class="token punctuation">,</span><span class="token number">0x76dbdbad</span><span class="token punctuation">,</span><span class="token number">0x3be0e0db</span><span class="token punctuation">,</span><span class="token number">0x56323264</span><span class="token punctuation">,</span>
<span class="token number">0x4e3a3a74</span><span class="token punctuation">,</span><span class="token number">0x1e0a0a14</span><span class="token punctuation">,</span><span class="token number">0xdb494992</span><span class="token punctuation">,</span><span class="token number">0xa06060c</span><span class="token punctuation">,</span><span class="token number">0x6c242448</span><span class="token punctuation">,</span><span class="token number">0xe45c5cb8</span><span class="token punctuation">,</span>
<span class="token number">0x5dc2c29f</span><span class="token punctuation">,</span><span class="token number">0x6ed3d3bd</span><span class="token punctuation">,</span><span class="token number">0xefacac43</span><span class="token punctuation">,</span><span class="token number">0xa66262c4</span><span class="token punctuation">,</span><span class="token number">0xa8919139</span><span class="token punctuation">,</span><span class="token number">0xa4959531</span><span class="token punctuation">,</span>
<span class="token number">0x37e4e4d3</span><span class="token punctuation">,</span><span class="token number">0x8b7979f2</span><span class="token punctuation">,</span><span class="token number">0x32e7e7d5</span><span class="token punctuation">,</span><span class="token number">0x43c8c88b</span><span class="token punctuation">,</span><span class="token number">0x5937376e</span><span class="token punctuation">,</span><span class="token number">0xb76d6dda</span><span class="token punctuation">,</span>
<span class="token number">0x8c8d8d01</span><span class="token punctuation">,</span><span class="token number">0x64d5d5b1</span><span class="token punctuation">,</span><span class="token number">0xd24e4e9c</span><span class="token punctuation">,</span><span class="token number">0xe0a9a949</span><span class="token punctuation">,</span><span class="token number">0xb46c6cd8</span><span class="token punctuation">,</span><span class="token number">0xfa5656ac</span><span class="token punctuation">,</span>
<span class="token number">0x7f4f4f3</span><span class="token punctuation">,</span><span class="token number">0x25eaeacf</span><span class="token punctuation">,</span><span class="token number">0xaf6565ca</span><span class="token punctuation">,</span><span class="token number">0x8e7a7af4</span><span class="token punctuation">,</span><span class="token number">0xe9aeae47</span><span class="token punctuation">,</span><span class="token number">0x18080810</span><span class="token punctuation">,</span>
<span class="token number">0xd5baba6f</span><span class="token punctuation">,</span><span class="token number">0x887878f0</span><span class="token punctuation">,</span><span class="token number">0x6f25254a</span><span class="token punctuation">,</span><span class="token number">0x722e2e5c</span><span class="token punctuation">,</span><span class="token number">0x241c1c38</span><span class="token punctuation">,</span><span class="token number">0xf1a6a657</span><span class="token punctuation">,</span>
<span class="token number">0xc7b4b473</span><span class="token punctuation">,</span><span class="token number">0x51c6c697</span><span class="token punctuation">,</span><span class="token number">0x23e8e8cb</span><span class="token punctuation">,</span><span class="token number">0x7cdddda1</span><span class="token punctuation">,</span><span class="token number">0x9c7474e8</span><span class="token punctuation">,</span><span class="token number">0x211f1f3e</span><span class="token punctuation">,</span>
<span class="token number">0xdd4b4b96</span><span class="token punctuation">,</span><span class="token number">0xdcbdbd61</span><span class="token punctuation">,</span><span class="token number">0x868b8b0d</span><span class="token punctuation">,</span><span class="token number">0x858a8a0f</span><span class="token punctuation">,</span><span class="token number">0x907070e0</span><span class="token punctuation">,</span><span class="token number">0x423e3e7c</span><span class="token punctuation">,</span>
<span class="token number">0xc4b5b571</span><span class="token punctuation">,</span><span class="token number">0xaa6666cc</span><span class="token punctuation">,</span><span class="token number">0xd8484890</span><span class="token punctuation">,</span><span class="token number">0x5030306</span><span class="token punctuation">,</span><span class="token number">0x1f6f6f7</span><span class="token punctuation">,</span><span class="token number">0x120e0e1c</span><span class="token punctuation">,</span>
<span class="token number">0xa36161c2</span><span class="token punctuation">,</span><span class="token number">0x5f35356a</span><span class="token punctuation">,</span><span class="token number">0xf95757ae</span><span class="token punctuation">,</span><span class="token number">0xd0b9b969</span><span class="token punctuation">,</span><span class="token number">0x91868617</span><span class="token punctuation">,</span><span class="token number">0x58c1c199</span><span class="token punctuation">,</span>
<span class="token number">0x271d1d3a</span><span class="token punctuation">,</span><span class="token number">0xb99e9e27</span><span class="token punctuation">,</span><span class="token number">0x38e1e1d9</span><span class="token punctuation">,</span><span class="token number">0x13f8f8eb</span><span class="token punctuation">,</span><span class="token number">0xb398982b</span><span class="token punctuation">,</span><span class="token number">0x33111122</span><span class="token punctuation">,</span>
<span class="token number">0xbb6969d2</span><span class="token punctuation">,</span><span class="token number">0x70d9d9a9</span><span class="token punctuation">,</span><span class="token number">0x898e8e07</span><span class="token punctuation">,</span><span class="token number">0xa7949433</span><span class="token punctuation">,</span><span class="token number">0xb69b9b2d</span><span class="token punctuation">,</span><span class="token number">0x221e1e3c</span><span class="token punctuation">,</span>
<span class="token number">0x92878715</span><span class="token punctuation">,</span><span class="token number">0x20e9e9c9</span><span class="token punctuation">,</span><span class="token number">0x49cece87</span><span class="token punctuation">,</span><span class="token number">0xff5555aa</span><span class="token punctuation">,</span><span class="token number">0x78282850</span><span class="token punctuation">,</span><span class="token number">0x7adfdfa5</span><span class="token punctuation">,</span>
<span class="token number">0x8f8c8c03</span><span class="token punctuation">,</span><span class="token number">0xf8a1a159</span><span class="token punctuation">,</span><span class="token number">0x80898909</span><span class="token punctuation">,</span><span class="token number">0x170d0d1a</span><span class="token punctuation">,</span><span class="token number">0xdabfbf65</span><span class="token punctuation">,</span><span class="token number">0x31e6e6d7</span><span class="token punctuation">,</span>
<span class="token number">0xc6424284</span><span class="token punctuation">,</span><span class="token number">0xb86868d0</span><span class="token punctuation">,</span><span class="token number">0xc3414182</span><span class="token punctuation">,</span><span class="token number">0xb0999929</span><span class="token punctuation">,</span><span class="token number">0x772d2d5a</span><span class="token punctuation">,</span><span class="token number">0x110f0f1e</span><span class="token punctuation">,</span>
<span class="token number">0xcbb0b07b</span><span class="token punctuation">,</span><span class="token number">0xfc5454a8</span><span class="token punctuation">,</span><span class="token number">0xd6bbbb6d</span><span class="token punctuation">,</span><span class="token number">0x3a16162c</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0x50a7f451</span><span class="token punctuation">,</span><span class="token number">0x5365417e</span><span class="token punctuation">,</span><span class="token number">0xc3a4171a</span><span class="token punctuation">,</span><span class="token number">0x965e273a</span><span class="token punctuation">,</span><span class="token number">0xcb6bab3b</span><span class="token punctuation">,</span><span class="token number">0xf1459d1f</span><span class="token punctuation">,</span>
<span class="token number">0xab58faac</span><span class="token punctuation">,</span><span class="token number">0x9303e34b</span><span class="token punctuation">,</span><span class="token number">0x55fa3020</span><span class="token punctuation">,</span><span class="token number">0xf66d76ad</span><span class="token punctuation">,</span><span class="token number">0x9176cc88</span><span class="token punctuation">,</span><span class="token number">0x254c02f5</span><span class="token punctuation">,</span>
<span class="token number">0xfcd7e54f</span><span class="token punctuation">,</span><span class="token number">0xd7cb2ac5</span><span class="token punctuation">,</span><span class="token number">0x80443526</span><span class="token punctuation">,</span><span class="token number">0x8fa362b5</span><span class="token punctuation">,</span><span class="token number">0x495ab1de</span><span class="token punctuation">,</span><span class="token number">0x671bba25</span><span class="token punctuation">,</span>
<span class="token number">0x980eea45</span><span class="token punctuation">,</span><span class="token number">0xe1c0fe5d</span><span class="token punctuation">,</span><span class="token number">0x2752fc3</span><span class="token punctuation">,</span><span class="token number">0x12f04c81</span><span class="token punctuation">,</span><span class="token number">0xa397468d</span><span class="token punctuation">,</span><span class="token number">0xc6f9d36b</span><span class="token punctuation">,</span>
<span class="token number">0xe75f8f03</span><span class="token punctuation">,</span><span class="token number">0x959c9215</span><span class="token punctuation">,</span><span class="token number">0xeb7a6dbf</span><span class="token punctuation">,</span><span class="token number">0xda595295</span><span class="token punctuation">,</span><span class="token number">0x2d83bed4</span><span class="token punctuation">,</span><span class="token number">0xd3217458</span><span class="token punctuation">,</span>
<span class="token number">0x2969e049</span><span class="token punctuation">,</span><span class="token number">0x44c8c98e</span><span class="token punctuation">,</span><span class="token number">0x6a89c275</span><span class="token punctuation">,</span><span class="token number">0x78798ef4</span><span class="token punctuation">,</span><span class="token number">0x6b3e5899</span><span class="token punctuation">,</span><span class="token number">0xdd71b927</span><span class="token punctuation">,</span>
<span class="token number">0xb64fe1be</span><span class="token punctuation">,</span><span class="token number">0x17ad88f0</span><span class="token punctuation">,</span><span class="token number">0x66ac20c9</span><span class="token punctuation">,</span><span class="token number">0xb43ace7d</span><span class="token punctuation">,</span><span class="token number">0x184adf63</span><span class="token punctuation">,</span><span class="token number">0x82311ae5</span><span class="token punctuation">,</span>
<span class="token number">0x60335197</span><span class="token punctuation">,</span><span class="token number">0x457f5362</span><span class="token punctuation">,</span><span class="token number">0xe07764b1</span><span class="token punctuation">,</span><span class="token number">0x84ae6bbb</span><span class="token punctuation">,</span><span class="token number">0x1ca081fe</span><span class="token punctuation">,</span><span class="token number">0x942b08f9</span><span class="token punctuation">,</span>
<span class="token number">0x58684870</span><span class="token punctuation">,</span><span class="token number">0x19fd458f</span><span class="token punctuation">,</span><span class="token number">0x876cde94</span><span class="token punctuation">,</span><span class="token number">0xb7f87b52</span><span class="token punctuation">,</span><span class="token number">0x23d373ab</span><span class="token punctuation">,</span><span class="token number">0xe2024b72</span><span class="token punctuation">,</span>
<span class="token number">0x578f1fe3</span><span class="token punctuation">,</span><span class="token number">0x2aab5566</span><span class="token punctuation">,</span><span class="token number">0x728ebb2</span><span class="token punctuation">,</span><span class="token number">0x3c2b52f</span><span class="token punctuation">,</span><span class="token number">0x9a7bc586</span><span class="token punctuation">,</span><span class="token number">0xa50837d3</span><span class="token punctuation">,</span>
<span class="token number">0xf2872830</span><span class="token punctuation">,</span><span class="token number">0xb2a5bf23</span><span class="token punctuation">,</span><span class="token number">0xba6a0302</span><span class="token punctuation">,</span><span class="token number">0x5c8216ed</span><span class="token punctuation">,</span><span class="token number">0x2b1ccf8a</span><span class="token punctuation">,</span><span class="token number">0x92b479a7</span><span class="token punctuation">,</span>
<span class="token number">0xf0f207f3</span><span class="token punctuation">,</span><span class="token number">0xa1e2694e</span><span class="token punctuation">,</span><span class="token number">0xcdf4da65</span><span class="token punctuation">,</span><span class="token number">0xd5be0506</span><span class="token punctuation">,</span><span class="token number">0x1f6234d1</span><span class="token punctuation">,</span><span class="token number">0x8afea6c4</span><span class="token punctuation">,</span>
<span class="token number">0x9d532e34</span><span class="token punctuation">,</span><span class="token number">0xa055f3a2</span><span class="token punctuation">,</span><span class="token number">0x32e18a05</span><span class="token punctuation">,</span><span class="token number">0x75ebf6a4</span><span class="token punctuation">,</span><span class="token number">0x39ec830b</span><span class="token punctuation">,</span><span class="token number">0xaaef6040</span><span class="token punctuation">,</span>
<span class="token number">0x69f715e</span><span class="token punctuation">,</span><span class="token number">0x51106ebd</span><span class="token punctuation">,</span><span class="token number">0xf98a213e</span><span class="token punctuation">,</span><span class="token number">0x3d06dd96</span><span class="token punctuation">,</span><span class="token number">0xae053edd</span><span class="token punctuation">,</span><span class="token number">0x46bde64d</span><span class="token punctuation">,</span>
<span class="token number">0xb58d5491</span><span class="token punctuation">,</span><span class="token number">0x55dc471</span><span class="token punctuation">,</span><span class="token number">0x6fd40604</span><span class="token punctuation">,</span><span class="token number">0xff155060</span><span class="token punctuation">,</span><span class="token number">0x24fb9819</span><span class="token punctuation">,</span><span class="token number">0x97e9bdd6</span><span class="token punctuation">,</span>
<span class="token number">0xcc434089</span><span class="token punctuation">,</span><span class="token number">0x779ed967</span><span class="token punctuation">,</span><span class="token number">0xbd42e8b0</span><span class="token punctuation">,</span><span class="token number">0x888b8907</span><span class="token punctuation">,</span><span class="token number">0x385b19e7</span><span class="token punctuation">,</span><span class="token number">0xdbeec879</span><span class="token punctuation">,</span>
<span class="token number">0x470a7ca1</span><span class="token punctuation">,</span><span class="token number">0xe90f427c</span><span class="token punctuation">,</span><span class="token number">0xc91e84f8</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x83868009</span><span class="token punctuation">,</span><span class="token number">0x48ed2b32</span><span class="token punctuation">,</span>
<span class="token number">0xac70111e</span><span class="token punctuation">,</span><span class="token number">0x4e725a6c</span><span class="token punctuation">,</span><span class="token number">0xfbff0efd</span><span class="token punctuation">,</span><span class="token number">0x5638850f</span><span class="token punctuation">,</span><span class="token number">0x1ed5ae3d</span><span class="token punctuation">,</span><span class="token number">0x27392d36</span><span class="token punctuation">,</span>
<span class="token number">0x64d90f0a</span><span class="token punctuation">,</span><span class="token number">0x21a65c68</span><span class="token punctuation">,</span><span class="token number">0xd1545b9b</span><span class="token punctuation">,</span><span class="token number">0x3a2e3624</span><span class="token punctuation">,</span><span class="token number">0xb1670a0c</span><span class="token punctuation">,</span><span class="token number">0xfe75793</span><span class="token punctuation">,</span>
<span class="token number">0xd296eeb4</span><span class="token punctuation">,</span><span class="token number">0x9e919b1b</span><span class="token punctuation">,</span><span class="token number">0x4fc5c080</span><span class="token punctuation">,</span><span class="token number">0xa220dc61</span><span class="token punctuation">,</span><span class="token number">0x694b775a</span><span class="token punctuation">,</span><span class="token number">0x161a121c</span><span class="token punctuation">,</span>
<span class="token number">0xaba93e2</span><span class="token punctuation">,</span><span class="token number">0xe52aa0c0</span><span class="token punctuation">,</span><span class="token number">0x43e0223c</span><span class="token punctuation">,</span><span class="token number">0x1d171b12</span><span class="token punctuation">,</span><span class="token number">0xb0d090e</span><span class="token punctuation">,</span><span class="token number">0xadc78bf2</span><span class="token punctuation">,</span>
<span class="token number">0xb9a8b62d</span><span class="token punctuation">,</span><span class="token number">0xc8a91e14</span><span class="token punctuation">,</span><span class="token number">0x8519f157</span><span class="token punctuation">,</span><span class="token number">0x4c0775af</span><span class="token punctuation">,</span><span class="token number">0xbbdd99ee</span><span class="token punctuation">,</span><span class="token number">0xfd607fa3</span><span class="token punctuation">,</span>
<span class="token number">0x9f2601f7</span><span class="token punctuation">,</span><span class="token number">0xbcf5725c</span><span class="token punctuation">,</span><span class="token number">0xc53b6644</span><span class="token punctuation">,</span><span class="token number">0x347efb5b</span><span class="token punctuation">,</span><span class="token number">0x7629438b</span><span class="token punctuation">,</span><span class="token number">0xdcc623cb</span><span class="token punctuation">,</span>
<span class="token number">0x68fcedb6</span><span class="token punctuation">,</span><span class="token number">0x63f1e4b8</span><span class="token punctuation">,</span><span class="token number">0xcadc31d7</span><span class="token punctuation">,</span><span class="token number">0x10856342</span><span class="token punctuation">,</span><span class="token number">0x40229713</span><span class="token punctuation">,</span><span class="token number">0x2011c684</span><span class="token punctuation">,</span>
<span class="token number">0x7d244a85</span><span class="token punctuation">,</span><span class="token number">0xf83dbbd2</span><span class="token punctuation">,</span><span class="token number">0x1132f9ae</span><span class="token punctuation">,</span><span class="token number">0x6da129c7</span><span class="token punctuation">,</span><span class="token number">0x4b2f9e1d</span><span class="token punctuation">,</span><span class="token number">0xf330b2dc</span><span class="token punctuation">,</span>
<span class="token number">0xec52860d</span><span class="token punctuation">,</span><span class="token number">0xd0e3c177</span><span class="token punctuation">,</span><span class="token number">0x6c16b32b</span><span class="token punctuation">,</span><span class="token number">0x99b970a9</span><span class="token punctuation">,</span><span class="token number">0xfa489411</span><span class="token punctuation">,</span><span class="token number">0x2264e947</span><span class="token punctuation">,</span>
<span class="token number">0xc48cfca8</span><span class="token punctuation">,</span><span class="token number">0x1a3ff0a0</span><span class="token punctuation">,</span><span class="token number">0xd82c7d56</span><span class="token punctuation">,</span><span class="token number">0xef903322</span><span class="token punctuation">,</span><span class="token number">0xc74e4987</span><span class="token punctuation">,</span><span class="token number">0xc1d138d9</span><span class="token punctuation">,</span>
<span class="token number">0xfea2ca8c</span><span class="token punctuation">,</span><span class="token number">0x360bd498</span><span class="token punctuation">,</span><span class="token number">0xcf81f5a6</span><span class="token punctuation">,</span><span class="token number">0x28de7aa5</span><span class="token punctuation">,</span><span class="token number">0x268eb7da</span><span class="token punctuation">,</span><span class="token number">0xa4bfad3f</span><span class="token punctuation">,</span>
<span class="token number">0xe49d3a2c</span><span class="token punctuation">,</span><span class="token number">0xd927850</span><span class="token punctuation">,</span><span class="token number">0x9bcc5f6a</span><span class="token punctuation">,</span><span class="token number">0x62467e54</span><span class="token punctuation">,</span><span class="token number">0xc2138df6</span><span class="token punctuation">,</span><span class="token number">0xe8b8d890</span><span class="token punctuation">,</span>
<span class="token number">0x5ef7392e</span><span class="token punctuation">,</span><span class="token number">0xf5afc382</span><span class="token punctuation">,</span><span class="token number">0xbe805d9f</span><span class="token punctuation">,</span><span class="token number">0x7c93d069</span><span class="token punctuation">,</span><span class="token number">0xa92dd56f</span><span class="token punctuation">,</span><span class="token number">0xb31225cf</span><span class="token punctuation">,</span>
<span class="token number">0x3b99acc8</span><span class="token punctuation">,</span><span class="token number">0xa77d1810</span><span class="token punctuation">,</span><span class="token number">0x6e639ce8</span><span class="token punctuation">,</span><span class="token number">0x7bbb3bdb</span><span class="token punctuation">,</span><span class="token number">0x97826cd</span><span class="token punctuation">,</span><span class="token number">0xf418596e</span><span class="token punctuation">,</span>
<span class="token number">0x1b79aec</span><span class="token punctuation">,</span><span class="token number">0xa89a4f83</span><span class="token punctuation">,</span><span class="token number">0x656e95e6</span><span class="token punctuation">,</span><span class="token number">0x7ee6ffaa</span><span class="token punctuation">,</span><span class="token number">0x8cfbc21</span><span class="token punctuation">,</span><span class="token number">0xe6e815ef</span><span class="token punctuation">,</span>
<span class="token number">0xd99be7ba</span><span class="token punctuation">,</span><span class="token number">0xce366f4a</span><span class="token punctuation">,</span><span class="token number">0xd4099fea</span><span class="token punctuation">,</span><span class="token number">0xd67cb029</span><span class="token punctuation">,</span><span class="token number">0xafb2a431</span><span class="token punctuation">,</span><span class="token number">0x31233f2a</span><span class="token punctuation">,</span>
<span class="token number">0x3094a5c6</span><span class="token punctuation">,</span><span class="token number">0xc066a235</span><span class="token punctuation">,</span><span class="token number">0x37bc4e74</span><span class="token punctuation">,</span><span class="token number">0xa6ca82fc</span><span class="token punctuation">,</span><span class="token number">0xb0d090e0</span><span class="token punctuation">,</span><span class="token number">0x15d8a733</span><span class="token punctuation">,</span>
<span class="token number">0x4a9804f1</span><span class="token punctuation">,</span><span class="token number">0xf7daec41</span><span class="token punctuation">,</span><span class="token number">0xe50cd7f</span><span class="token punctuation">,</span><span class="token number">0x2ff69117</span><span class="token punctuation">,</span><span class="token number">0x8dd64d76</span><span class="token punctuation">,</span><span class="token number">0x4db0ef43</span><span class="token punctuation">,</span>
<span class="token number">0x544daacc</span><span class="token punctuation">,</span><span class="token number">0xdf0496e4</span><span class="token punctuation">,</span><span class="token number">0xe3b5d19e</span><span class="token punctuation">,</span><span class="token number">0x1b886a4c</span><span class="token punctuation">,</span><span class="token number">0xb81f2cc1</span><span class="token punctuation">,</span><span class="token number">0x7f516546</span><span class="token punctuation">,</span>
<span class="token number">0x4ea5e9d</span><span class="token punctuation">,</span><span class="token number">0x5d358c01</span><span class="token punctuation">,</span><span class="token number">0x737487fa</span><span class="token punctuation">,</span><span class="token number">0x2e410bfb</span><span class="token punctuation">,</span><span class="token number">0x5a1d67b3</span><span class="token punctuation">,</span><span class="token number">0x52d2db92</span><span class="token punctuation">,</span>
<span class="token number">0x335610e9</span><span class="token punctuation">,</span><span class="token number">0x1347d66d</span><span class="token punctuation">,</span><span class="token number">0x8c61d79a</span><span class="token punctuation">,</span><span class="token number">0x7a0ca137</span><span class="token punctuation">,</span><span class="token number">0x8e14f859</span><span class="token punctuation">,</span><span class="token number">0x893c13eb</span><span class="token punctuation">,</span>
<span class="token number">0xee27a9ce</span><span class="token punctuation">,</span><span class="token number">0x35c961b7</span><span class="token punctuation">,</span><span class="token number">0xede51ce1</span><span class="token punctuation">,</span><span class="token number">0x3cb1477a</span><span class="token punctuation">,</span><span class="token number">0x59dfd29c</span><span class="token punctuation">,</span><span class="token number">0x3f73f255</span><span class="token punctuation">,</span>
<span class="token number">0x79ce1418</span><span class="token punctuation">,</span><span class="token number">0xbf37c773</span><span class="token punctuation">,</span><span class="token number">0xeacdf753</span><span class="token punctuation">,</span><span class="token number">0x5baafd5f</span><span class="token punctuation">,</span><span class="token number">0x146f3ddf</span><span class="token punctuation">,</span><span class="token number">0x86db4478</span><span class="token punctuation">,</span>
<span class="token number">0x81f3afca</span><span class="token punctuation">,</span><span class="token number">0x3ec468b9</span><span class="token punctuation">,</span><span class="token number">0x2c342438</span><span class="token punctuation">,</span><span class="token number">0x5f40a3c2</span><span class="token punctuation">,</span><span class="token number">0x72c31d16</span><span class="token punctuation">,</span><span class="token number">0xc25e2bc</span><span class="token punctuation">,</span>
<span class="token number">0x8b493c28</span><span class="token punctuation">,</span><span class="token number">0x41950dff</span><span class="token punctuation">,</span><span class="token number">0x7101a839</span><span class="token punctuation">,</span><span class="token number">0xdeb30c08</span><span class="token punctuation">,</span><span class="token number">0x9ce4b4d8</span><span class="token punctuation">,</span><span class="token number">0x90c15664</span><span class="token punctuation">,</span>
<span class="token number">0x6184cb7b</span><span class="token punctuation">,</span><span class="token number">0x70b632d5</span><span class="token punctuation">,</span><span class="token number">0x745c6c48</span><span class="token punctuation">,</span><span class="token number">0x4257b8d0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// &#x5728;&#x4EC0;&#x4E48;&#x60C5;&#x51B5;&#x4E0B;&#x4F7F;&#x7528; MR_SMALL_AES &#xFF1F;&#xFF1F;&#xFF1F;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MR_SMALL_AES</span></span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0x6363c6a5</span><span class="token punctuation">,</span><span class="token number">0x7c7cf884</span><span class="token punctuation">,</span><span class="token number">0x7777ee99</span><span class="token punctuation">,</span><span class="token number">0x7b7bf68d</span><span class="token punctuation">,</span><span class="token number">0xf2f2ff0d</span><span class="token punctuation">,</span><span class="token number">0x6b6bd6bd</span><span class="token punctuation">,</span>
<span class="token number">0x6f6fdeb1</span><span class="token punctuation">,</span><span class="token number">0xc5c59154</span><span class="token punctuation">,</span><span class="token number">0x30306050</span><span class="token punctuation">,</span><span class="token number">0x1010203</span><span class="token punctuation">,</span><span class="token number">0x6767cea9</span><span class="token punctuation">,</span><span class="token number">0x2b2b567d</span><span class="token punctuation">,</span>
<span class="token number">0xfefee719</span><span class="token punctuation">,</span><span class="token number">0xd7d7b562</span><span class="token punctuation">,</span><span class="token number">0xabab4de6</span><span class="token punctuation">,</span><span class="token number">0x7676ec9a</span><span class="token punctuation">,</span><span class="token number">0xcaca8f45</span><span class="token punctuation">,</span><span class="token number">0x82821f9d</span><span class="token punctuation">,</span>
<span class="token number">0xc9c98940</span><span class="token punctuation">,</span><span class="token number">0x7d7dfa87</span><span class="token punctuation">,</span><span class="token number">0xfafaef15</span><span class="token punctuation">,</span><span class="token number">0x5959b2eb</span><span class="token punctuation">,</span><span class="token number">0x47478ec9</span><span class="token punctuation">,</span><span class="token number">0xf0f0fb0b</span><span class="token punctuation">,</span>
<span class="token number">0xadad41ec</span><span class="token punctuation">,</span><span class="token number">0xd4d4b367</span><span class="token punctuation">,</span><span class="token number">0xa2a25ffd</span><span class="token punctuation">,</span><span class="token number">0xafaf45ea</span><span class="token punctuation">,</span><span class="token number">0x9c9c23bf</span><span class="token punctuation">,</span><span class="token number">0xa4a453f7</span><span class="token punctuation">,</span>
<span class="token number">0x7272e496</span><span class="token punctuation">,</span><span class="token number">0xc0c09b5b</span><span class="token punctuation">,</span><span class="token number">0xb7b775c2</span><span class="token punctuation">,</span><span class="token number">0xfdfde11c</span><span class="token punctuation">,</span><span class="token number">0x93933dae</span><span class="token punctuation">,</span><span class="token number">0x26264c6a</span><span class="token punctuation">,</span>
<span class="token number">0x36366c5a</span><span class="token punctuation">,</span><span class="token number">0x3f3f7e41</span><span class="token punctuation">,</span><span class="token number">0xf7f7f502</span><span class="token punctuation">,</span><span class="token number">0xcccc834f</span><span class="token punctuation">,</span><span class="token number">0x3434685c</span><span class="token punctuation">,</span><span class="token number">0xa5a551f4</span><span class="token punctuation">,</span>
<span class="token number">0xe5e5d134</span><span class="token punctuation">,</span><span class="token number">0xf1f1f908</span><span class="token punctuation">,</span><span class="token number">0x7171e293</span><span class="token punctuation">,</span><span class="token number">0xd8d8ab73</span><span class="token punctuation">,</span><span class="token number">0x31316253</span><span class="token punctuation">,</span><span class="token number">0x15152a3f</span><span class="token punctuation">,</span>
<span class="token number">0x404080c</span><span class="token punctuation">,</span><span class="token number">0xc7c79552</span><span class="token punctuation">,</span><span class="token number">0x23234665</span><span class="token punctuation">,</span><span class="token number">0xc3c39d5e</span><span class="token punctuation">,</span><span class="token number">0x18183028</span><span class="token punctuation">,</span><span class="token number">0x969637a1</span><span class="token punctuation">,</span>
<span class="token number">0x5050a0f</span><span class="token punctuation">,</span><span class="token number">0x9a9a2fb5</span><span class="token punctuation">,</span><span class="token number">0x7070e09</span><span class="token punctuation">,</span><span class="token number">0x12122436</span><span class="token punctuation">,</span><span class="token number">0x80801b9b</span><span class="token punctuation">,</span><span class="token number">0xe2e2df3d</span><span class="token punctuation">,</span>
<span class="token number">0xebebcd26</span><span class="token punctuation">,</span><span class="token number">0x27274e69</span><span class="token punctuation">,</span><span class="token number">0xb2b27fcd</span><span class="token punctuation">,</span><span class="token number">0x7575ea9f</span><span class="token punctuation">,</span><span class="token number">0x909121b</span><span class="token punctuation">,</span><span class="token number">0x83831d9e</span><span class="token punctuation">,</span>
<span class="token number">0x2c2c5874</span><span class="token punctuation">,</span><span class="token number">0x1a1a342e</span><span class="token punctuation">,</span><span class="token number">0x1b1b362d</span><span class="token punctuation">,</span><span class="token number">0x6e6edcb2</span><span class="token punctuation">,</span><span class="token number">0x5a5ab4ee</span><span class="token punctuation">,</span><span class="token number">0xa0a05bfb</span><span class="token punctuation">,</span>
<span class="token number">0x5252a4f6</span><span class="token punctuation">,</span><span class="token number">0x3b3b764d</span><span class="token punctuation">,</span><span class="token number">0xd6d6b761</span><span class="token punctuation">,</span><span class="token number">0xb3b37dce</span><span class="token punctuation">,</span><span class="token number">0x2929527b</span><span class="token punctuation">,</span><span class="token number">0xe3e3dd3e</span><span class="token punctuation">,</span>
<span class="token number">0x2f2f5e71</span><span class="token punctuation">,</span><span class="token number">0x84841397</span><span class="token punctuation">,</span><span class="token number">0x5353a6f5</span><span class="token punctuation">,</span><span class="token number">0xd1d1b968</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0xededc12c</span><span class="token punctuation">,</span>
<span class="token number">0x20204060</span><span class="token punctuation">,</span><span class="token number">0xfcfce31f</span><span class="token punctuation">,</span><span class="token number">0xb1b179c8</span><span class="token punctuation">,</span><span class="token number">0x5b5bb6ed</span><span class="token punctuation">,</span><span class="token number">0x6a6ad4be</span><span class="token punctuation">,</span><span class="token number">0xcbcb8d46</span><span class="token punctuation">,</span>
<span class="token number">0xbebe67d9</span><span class="token punctuation">,</span><span class="token number">0x3939724b</span><span class="token punctuation">,</span><span class="token number">0x4a4a94de</span><span class="token punctuation">,</span><span class="token number">0x4c4c98d4</span><span class="token punctuation">,</span><span class="token number">0x5858b0e8</span><span class="token punctuation">,</span><span class="token number">0xcfcf854a</span><span class="token punctuation">,</span>
<span class="token number">0xd0d0bb6b</span><span class="token punctuation">,</span><span class="token number">0xefefc52a</span><span class="token punctuation">,</span><span class="token number">0xaaaa4fe5</span><span class="token punctuation">,</span><span class="token number">0xfbfbed16</span><span class="token punctuation">,</span><span class="token number">0x434386c5</span><span class="token punctuation">,</span><span class="token number">0x4d4d9ad7</span><span class="token punctuation">,</span>
<span class="token number">0x33336655</span><span class="token punctuation">,</span><span class="token number">0x85851194</span><span class="token punctuation">,</span><span class="token number">0x45458acf</span><span class="token punctuation">,</span><span class="token number">0xf9f9e910</span><span class="token punctuation">,</span><span class="token number">0x2020406</span><span class="token punctuation">,</span><span class="token number">0x7f7ffe81</span><span class="token punctuation">,</span>
<span class="token number">0x5050a0f0</span><span class="token punctuation">,</span><span class="token number">0x3c3c7844</span><span class="token punctuation">,</span><span class="token number">0x9f9f25ba</span><span class="token punctuation">,</span><span class="token number">0xa8a84be3</span><span class="token punctuation">,</span><span class="token number">0x5151a2f3</span><span class="token punctuation">,</span><span class="token number">0xa3a35dfe</span><span class="token punctuation">,</span>
<span class="token number">0x404080c0</span><span class="token punctuation">,</span><span class="token number">0x8f8f058a</span><span class="token punctuation">,</span><span class="token number">0x92923fad</span><span class="token punctuation">,</span><span class="token number">0x9d9d21bc</span><span class="token punctuation">,</span><span class="token number">0x38387048</span><span class="token punctuation">,</span><span class="token number">0xf5f5f104</span><span class="token punctuation">,</span>
<span class="token number">0xbcbc63df</span><span class="token punctuation">,</span><span class="token number">0xb6b677c1</span><span class="token punctuation">,</span><span class="token number">0xdadaaf75</span><span class="token punctuation">,</span><span class="token number">0x21214263</span><span class="token punctuation">,</span><span class="token number">0x10102030</span><span class="token punctuation">,</span><span class="token number">0xffffe51a</span><span class="token punctuation">,</span>
<span class="token number">0xf3f3fd0e</span><span class="token punctuation">,</span><span class="token number">0xd2d2bf6d</span><span class="token punctuation">,</span><span class="token number">0xcdcd814c</span><span class="token punctuation">,</span><span class="token number">0xc0c1814</span><span class="token punctuation">,</span><span class="token number">0x13132635</span><span class="token punctuation">,</span><span class="token number">0xececc32f</span><span class="token punctuation">,</span>
<span class="token number">0x5f5fbee1</span><span class="token punctuation">,</span><span class="token number">0x979735a2</span><span class="token punctuation">,</span><span class="token number">0x444488cc</span><span class="token punctuation">,</span><span class="token number">0x17172e39</span><span class="token punctuation">,</span><span class="token number">0xc4c49357</span><span class="token punctuation">,</span><span class="token number">0xa7a755f2</span><span class="token punctuation">,</span>
<span class="token number">0x7e7efc82</span><span class="token punctuation">,</span><span class="token number">0x3d3d7a47</span><span class="token punctuation">,</span><span class="token number">0x6464c8ac</span><span class="token punctuation">,</span><span class="token number">0x5d5dbae7</span><span class="token punctuation">,</span><span class="token number">0x1919322b</span><span class="token punctuation">,</span><span class="token number">0x7373e695</span><span class="token punctuation">,</span>
<span class="token number">0x6060c0a0</span><span class="token punctuation">,</span><span class="token number">0x81811998</span><span class="token punctuation">,</span><span class="token number">0x4f4f9ed1</span><span class="token punctuation">,</span><span class="token number">0xdcdca37f</span><span class="token punctuation">,</span><span class="token number">0x22224466</span><span class="token punctuation">,</span><span class="token number">0x2a2a547e</span><span class="token punctuation">,</span>
<span class="token number">0x90903bab</span><span class="token punctuation">,</span><span class="token number">0x88880b83</span><span class="token punctuation">,</span><span class="token number">0x46468cca</span><span class="token punctuation">,</span><span class="token number">0xeeeec729</span><span class="token punctuation">,</span><span class="token number">0xb8b86bd3</span><span class="token punctuation">,</span><span class="token number">0x1414283c</span><span class="token punctuation">,</span>
<span class="token number">0xdedea779</span><span class="token punctuation">,</span><span class="token number">0x5e5ebce2</span><span class="token punctuation">,</span><span class="token number">0xb0b161d</span><span class="token punctuation">,</span><span class="token number">0xdbdbad76</span><span class="token punctuation">,</span><span class="token number">0xe0e0db3b</span><span class="token punctuation">,</span><span class="token number">0x32326456</span><span class="token punctuation">,</span>
<span class="token number">0x3a3a744e</span><span class="token punctuation">,</span><span class="token number">0xa0a141e</span><span class="token punctuation">,</span><span class="token number">0x494992db</span><span class="token punctuation">,</span><span class="token number">0x6060c0a</span><span class="token punctuation">,</span><span class="token number">0x2424486c</span><span class="token punctuation">,</span><span class="token number">0x5c5cb8e4</span><span class="token punctuation">,</span>
<span class="token number">0xc2c29f5d</span><span class="token punctuation">,</span><span class="token number">0xd3d3bd6e</span><span class="token punctuation">,</span><span class="token number">0xacac43ef</span><span class="token punctuation">,</span><span class="token number">0x6262c4a6</span><span class="token punctuation">,</span><span class="token number">0x919139a8</span><span class="token punctuation">,</span><span class="token number">0x959531a4</span><span class="token punctuation">,</span>
<span class="token number">0xe4e4d337</span><span class="token punctuation">,</span><span class="token number">0x7979f28b</span><span class="token punctuation">,</span><span class="token number">0xe7e7d532</span><span class="token punctuation">,</span><span class="token number">0xc8c88b43</span><span class="token punctuation">,</span><span class="token number">0x37376e59</span><span class="token punctuation">,</span><span class="token number">0x6d6ddab7</span><span class="token punctuation">,</span>
<span class="token number">0x8d8d018c</span><span class="token punctuation">,</span><span class="token number">0xd5d5b164</span><span class="token punctuation">,</span><span class="token number">0x4e4e9cd2</span><span class="token punctuation">,</span><span class="token number">0xa9a949e0</span><span class="token punctuation">,</span><span class="token number">0x6c6cd8b4</span><span class="token punctuation">,</span><span class="token number">0x5656acfa</span><span class="token punctuation">,</span>
<span class="token number">0xf4f4f307</span><span class="token punctuation">,</span><span class="token number">0xeaeacf25</span><span class="token punctuation">,</span><span class="token number">0x6565caaf</span><span class="token punctuation">,</span><span class="token number">0x7a7af48e</span><span class="token punctuation">,</span><span class="token number">0xaeae47e9</span><span class="token punctuation">,</span><span class="token number">0x8081018</span><span class="token punctuation">,</span>
<span class="token number">0xbaba6fd5</span><span class="token punctuation">,</span><span class="token number">0x7878f088</span><span class="token punctuation">,</span><span class="token number">0x25254a6f</span><span class="token punctuation">,</span><span class="token number">0x2e2e5c72</span><span class="token punctuation">,</span><span class="token number">0x1c1c3824</span><span class="token punctuation">,</span><span class="token number">0xa6a657f1</span><span class="token punctuation">,</span>
<span class="token number">0xb4b473c7</span><span class="token punctuation">,</span><span class="token number">0xc6c69751</span><span class="token punctuation">,</span><span class="token number">0xe8e8cb23</span><span class="token punctuation">,</span><span class="token number">0xdddda17c</span><span class="token punctuation">,</span><span class="token number">0x7474e89c</span><span class="token punctuation">,</span><span class="token number">0x1f1f3e21</span><span class="token punctuation">,</span>
<span class="token number">0x4b4b96dd</span><span class="token punctuation">,</span><span class="token number">0xbdbd61dc</span><span class="token punctuation">,</span><span class="token number">0x8b8b0d86</span><span class="token punctuation">,</span><span class="token number">0x8a8a0f85</span><span class="token punctuation">,</span><span class="token number">0x7070e090</span><span class="token punctuation">,</span><span class="token number">0x3e3e7c42</span><span class="token punctuation">,</span>
<span class="token number">0xb5b571c4</span><span class="token punctuation">,</span><span class="token number">0x6666ccaa</span><span class="token punctuation">,</span><span class="token number">0x484890d8</span><span class="token punctuation">,</span><span class="token number">0x3030605</span><span class="token punctuation">,</span><span class="token number">0xf6f6f701</span><span class="token punctuation">,</span><span class="token number">0xe0e1c12</span><span class="token punctuation">,</span>
<span class="token number">0x6161c2a3</span><span class="token punctuation">,</span><span class="token number">0x35356a5f</span><span class="token punctuation">,</span><span class="token number">0x5757aef9</span><span class="token punctuation">,</span><span class="token number">0xb9b969d0</span><span class="token punctuation">,</span><span class="token number">0x86861791</span><span class="token punctuation">,</span><span class="token number">0xc1c19958</span><span class="token punctuation">,</span>
<span class="token number">0x1d1d3a27</span><span class="token punctuation">,</span><span class="token number">0x9e9e27b9</span><span class="token punctuation">,</span><span class="token number">0xe1e1d938</span><span class="token punctuation">,</span><span class="token number">0xf8f8eb13</span><span class="token punctuation">,</span><span class="token number">0x98982bb3</span><span class="token punctuation">,</span><span class="token number">0x11112233</span><span class="token punctuation">,</span>
<span class="token number">0x6969d2bb</span><span class="token punctuation">,</span><span class="token number">0xd9d9a970</span><span class="token punctuation">,</span><span class="token number">0x8e8e0789</span><span class="token punctuation">,</span><span class="token number">0x949433a7</span><span class="token punctuation">,</span><span class="token number">0x9b9b2db6</span><span class="token punctuation">,</span><span class="token number">0x1e1e3c22</span><span class="token punctuation">,</span>
<span class="token number">0x87871592</span><span class="token punctuation">,</span><span class="token number">0xe9e9c920</span><span class="token punctuation">,</span><span class="token number">0xcece8749</span><span class="token punctuation">,</span><span class="token number">0x5555aaff</span><span class="token punctuation">,</span><span class="token number">0x28285078</span><span class="token punctuation">,</span><span class="token number">0xdfdfa57a</span><span class="token punctuation">,</span>
<span class="token number">0x8c8c038f</span><span class="token punctuation">,</span><span class="token number">0xa1a159f8</span><span class="token punctuation">,</span><span class="token number">0x89890980</span><span class="token punctuation">,</span><span class="token number">0xd0d1a17</span><span class="token punctuation">,</span><span class="token number">0xbfbf65da</span><span class="token punctuation">,</span><span class="token number">0xe6e6d731</span><span class="token punctuation">,</span>
<span class="token number">0x424284c6</span><span class="token punctuation">,</span><span class="token number">0x6868d0b8</span><span class="token punctuation">,</span><span class="token number">0x414182c3</span><span class="token punctuation">,</span><span class="token number">0x999929b0</span><span class="token punctuation">,</span><span class="token number">0x2d2d5a77</span><span class="token punctuation">,</span><span class="token number">0xf0f1e11</span><span class="token punctuation">,</span>
<span class="token number">0xb0b07bcb</span><span class="token punctuation">,</span><span class="token number">0x5454a8fc</span><span class="token punctuation">,</span><span class="token number">0xbbbb6dd6</span><span class="token punctuation">,</span><span class="token number">0x16162c3a</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0xa7f45150</span><span class="token punctuation">,</span><span class="token number">0x65417e53</span><span class="token punctuation">,</span><span class="token number">0xa4171ac3</span><span class="token punctuation">,</span><span class="token number">0x5e273a96</span><span class="token punctuation">,</span><span class="token number">0x6bab3bcb</span><span class="token punctuation">,</span><span class="token number">0x459d1ff1</span><span class="token punctuation">,</span>
<span class="token number">0x58faacab</span><span class="token punctuation">,</span><span class="token number">0x3e34b93</span><span class="token punctuation">,</span><span class="token number">0xfa302055</span><span class="token punctuation">,</span><span class="token number">0x6d76adf6</span><span class="token punctuation">,</span><span class="token number">0x76cc8891</span><span class="token punctuation">,</span><span class="token number">0x4c02f525</span><span class="token punctuation">,</span>
<span class="token number">0xd7e54ffc</span><span class="token punctuation">,</span><span class="token number">0xcb2ac5d7</span><span class="token punctuation">,</span><span class="token number">0x44352680</span><span class="token punctuation">,</span><span class="token number">0xa362b58f</span><span class="token punctuation">,</span><span class="token number">0x5ab1de49</span><span class="token punctuation">,</span><span class="token number">0x1bba2567</span><span class="token punctuation">,</span>
<span class="token number">0xeea4598</span><span class="token punctuation">,</span><span class="token number">0xc0fe5de1</span><span class="token punctuation">,</span><span class="token number">0x752fc302</span><span class="token punctuation">,</span><span class="token number">0xf04c8112</span><span class="token punctuation">,</span><span class="token number">0x97468da3</span><span class="token punctuation">,</span><span class="token number">0xf9d36bc6</span><span class="token punctuation">,</span>
<span class="token number">0x5f8f03e7</span><span class="token punctuation">,</span><span class="token number">0x9c921595</span><span class="token punctuation">,</span><span class="token number">0x7a6dbfeb</span><span class="token punctuation">,</span><span class="token number">0x595295da</span><span class="token punctuation">,</span><span class="token number">0x83bed42d</span><span class="token punctuation">,</span><span class="token number">0x217458d3</span><span class="token punctuation">,</span>
<span class="token number">0x69e04929</span><span class="token punctuation">,</span><span class="token number">0xc8c98e44</span><span class="token punctuation">,</span><span class="token number">0x89c2756a</span><span class="token punctuation">,</span><span class="token number">0x798ef478</span><span class="token punctuation">,</span><span class="token number">0x3e58996b</span><span class="token punctuation">,</span><span class="token number">0x71b927dd</span><span class="token punctuation">,</span>
<span class="token number">0x4fe1beb6</span><span class="token punctuation">,</span><span class="token number">0xad88f017</span><span class="token punctuation">,</span><span class="token number">0xac20c966</span><span class="token punctuation">,</span><span class="token number">0x3ace7db4</span><span class="token punctuation">,</span><span class="token number">0x4adf6318</span><span class="token punctuation">,</span><span class="token number">0x311ae582</span><span class="token punctuation">,</span>
<span class="token number">0x33519760</span><span class="token punctuation">,</span><span class="token number">0x7f536245</span><span class="token punctuation">,</span><span class="token number">0x7764b1e0</span><span class="token punctuation">,</span><span class="token number">0xae6bbb84</span><span class="token punctuation">,</span><span class="token number">0xa081fe1c</span><span class="token punctuation">,</span><span class="token number">0x2b08f994</span><span class="token punctuation">,</span>
<span class="token number">0x68487058</span><span class="token punctuation">,</span><span class="token number">0xfd458f19</span><span class="token punctuation">,</span><span class="token number">0x6cde9487</span><span class="token punctuation">,</span><span class="token number">0xf87b52b7</span><span class="token punctuation">,</span><span class="token number">0xd373ab23</span><span class="token punctuation">,</span><span class="token number">0x24b72e2</span><span class="token punctuation">,</span>
<span class="token number">0x8f1fe357</span><span class="token punctuation">,</span><span class="token number">0xab55662a</span><span class="token punctuation">,</span><span class="token number">0x28ebb207</span><span class="token punctuation">,</span><span class="token number">0xc2b52f03</span><span class="token punctuation">,</span><span class="token number">0x7bc5869a</span><span class="token punctuation">,</span><span class="token number">0x837d3a5</span><span class="token punctuation">,</span>
<span class="token number">0x872830f2</span><span class="token punctuation">,</span><span class="token number">0xa5bf23b2</span><span class="token punctuation">,</span><span class="token number">0x6a0302ba</span><span class="token punctuation">,</span><span class="token number">0x8216ed5c</span><span class="token punctuation">,</span><span class="token number">0x1ccf8a2b</span><span class="token punctuation">,</span><span class="token number">0xb479a792</span><span class="token punctuation">,</span>
<span class="token number">0xf207f3f0</span><span class="token punctuation">,</span><span class="token number">0xe2694ea1</span><span class="token punctuation">,</span><span class="token number">0xf4da65cd</span><span class="token punctuation">,</span><span class="token number">0xbe0506d5</span><span class="token punctuation">,</span><span class="token number">0x6234d11f</span><span class="token punctuation">,</span><span class="token number">0xfea6c48a</span><span class="token punctuation">,</span>
<span class="token number">0x532e349d</span><span class="token punctuation">,</span><span class="token number">0x55f3a2a0</span><span class="token punctuation">,</span><span class="token number">0xe18a0532</span><span class="token punctuation">,</span><span class="token number">0xebf6a475</span><span class="token punctuation">,</span><span class="token number">0xec830b39</span><span class="token punctuation">,</span><span class="token number">0xef6040aa</span><span class="token punctuation">,</span>
<span class="token number">0x9f715e06</span><span class="token punctuation">,</span><span class="token number">0x106ebd51</span><span class="token punctuation">,</span><span class="token number">0x8a213ef9</span><span class="token punctuation">,</span><span class="token number">0x6dd963d</span><span class="token punctuation">,</span><span class="token number">0x53eddae</span><span class="token punctuation">,</span><span class="token number">0xbde64d46</span><span class="token punctuation">,</span>
<span class="token number">0x8d5491b5</span><span class="token punctuation">,</span><span class="token number">0x5dc47105</span><span class="token punctuation">,</span><span class="token number">0xd406046f</span><span class="token punctuation">,</span><span class="token number">0x155060ff</span><span class="token punctuation">,</span><span class="token number">0xfb981924</span><span class="token punctuation">,</span><span class="token number">0xe9bdd697</span><span class="token punctuation">,</span>
<span class="token number">0x434089cc</span><span class="token punctuation">,</span><span class="token number">0x9ed96777</span><span class="token punctuation">,</span><span class="token number">0x42e8b0bd</span><span class="token punctuation">,</span><span class="token number">0x8b890788</span><span class="token punctuation">,</span><span class="token number">0x5b19e738</span><span class="token punctuation">,</span><span class="token number">0xeec879db</span><span class="token punctuation">,</span>
<span class="token number">0xa7ca147</span><span class="token punctuation">,</span><span class="token number">0xf427ce9</span><span class="token punctuation">,</span><span class="token number">0x1e84f8c9</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x86800983</span><span class="token punctuation">,</span><span class="token number">0xed2b3248</span><span class="token punctuation">,</span>
<span class="token number">0x70111eac</span><span class="token punctuation">,</span><span class="token number">0x725a6c4e</span><span class="token punctuation">,</span><span class="token number">0xff0efdfb</span><span class="token punctuation">,</span><span class="token number">0x38850f56</span><span class="token punctuation">,</span><span class="token number">0xd5ae3d1e</span><span class="token punctuation">,</span><span class="token number">0x392d3627</span><span class="token punctuation">,</span>
<span class="token number">0xd90f0a64</span><span class="token punctuation">,</span><span class="token number">0xa65c6821</span><span class="token punctuation">,</span><span class="token number">0x545b9bd1</span><span class="token punctuation">,</span><span class="token number">0x2e36243a</span><span class="token punctuation">,</span><span class="token number">0x670a0cb1</span><span class="token punctuation">,</span><span class="token number">0xe757930f</span><span class="token punctuation">,</span>
<span class="token number">0x96eeb4d2</span><span class="token punctuation">,</span><span class="token number">0x919b1b9e</span><span class="token punctuation">,</span><span class="token number">0xc5c0804f</span><span class="token punctuation">,</span><span class="token number">0x20dc61a2</span><span class="token punctuation">,</span><span class="token number">0x4b775a69</span><span class="token punctuation">,</span><span class="token number">0x1a121c16</span><span class="token punctuation">,</span>
<span class="token number">0xba93e20a</span><span class="token punctuation">,</span><span class="token number">0x2aa0c0e5</span><span class="token punctuation">,</span><span class="token number">0xe0223c43</span><span class="token punctuation">,</span><span class="token number">0x171b121d</span><span class="token punctuation">,</span><span class="token number">0xd090e0b</span><span class="token punctuation">,</span><span class="token number">0xc78bf2ad</span><span class="token punctuation">,</span>
<span class="token number">0xa8b62db9</span><span class="token punctuation">,</span><span class="token number">0xa91e14c8</span><span class="token punctuation">,</span><span class="token number">0x19f15785</span><span class="token punctuation">,</span><span class="token number">0x775af4c</span><span class="token punctuation">,</span><span class="token number">0xdd99eebb</span><span class="token punctuation">,</span><span class="token number">0x607fa3fd</span><span class="token punctuation">,</span>
<span class="token number">0x2601f79f</span><span class="token punctuation">,</span><span class="token number">0xf5725cbc</span><span class="token punctuation">,</span><span class="token number">0x3b6644c5</span><span class="token punctuation">,</span><span class="token number">0x7efb5b34</span><span class="token punctuation">,</span><span class="token number">0x29438b76</span><span class="token punctuation">,</span><span class="token number">0xc623cbdc</span><span class="token punctuation">,</span>
<span class="token number">0xfcedb668</span><span class="token punctuation">,</span><span class="token number">0xf1e4b863</span><span class="token punctuation">,</span><span class="token number">0xdc31d7ca</span><span class="token punctuation">,</span><span class="token number">0x85634210</span><span class="token punctuation">,</span><span class="token number">0x22971340</span><span class="token punctuation">,</span><span class="token number">0x11c68420</span><span class="token punctuation">,</span>
<span class="token number">0x244a857d</span><span class="token punctuation">,</span><span class="token number">0x3dbbd2f8</span><span class="token punctuation">,</span><span class="token number">0x32f9ae11</span><span class="token punctuation">,</span><span class="token number">0xa129c76d</span><span class="token punctuation">,</span><span class="token number">0x2f9e1d4b</span><span class="token punctuation">,</span><span class="token number">0x30b2dcf3</span><span class="token punctuation">,</span>
<span class="token number">0x52860dec</span><span class="token punctuation">,</span><span class="token number">0xe3c177d0</span><span class="token punctuation">,</span><span class="token number">0x16b32b6c</span><span class="token punctuation">,</span><span class="token number">0xb970a999</span><span class="token punctuation">,</span><span class="token number">0x489411fa</span><span class="token punctuation">,</span><span class="token number">0x64e94722</span><span class="token punctuation">,</span>
<span class="token number">0x8cfca8c4</span><span class="token punctuation">,</span><span class="token number">0x3ff0a01a</span><span class="token punctuation">,</span><span class="token number">0x2c7d56d8</span><span class="token punctuation">,</span><span class="token number">0x903322ef</span><span class="token punctuation">,</span><span class="token number">0x4e4987c7</span><span class="token punctuation">,</span><span class="token number">0xd138d9c1</span><span class="token punctuation">,</span>
<span class="token number">0xa2ca8cfe</span><span class="token punctuation">,</span><span class="token number">0xbd49836</span><span class="token punctuation">,</span><span class="token number">0x81f5a6cf</span><span class="token punctuation">,</span><span class="token number">0xde7aa528</span><span class="token punctuation">,</span><span class="token number">0x8eb7da26</span><span class="token punctuation">,</span><span class="token number">0xbfad3fa4</span><span class="token punctuation">,</span>
<span class="token number">0x9d3a2ce4</span><span class="token punctuation">,</span><span class="token number">0x9278500d</span><span class="token punctuation">,</span><span class="token number">0xcc5f6a9b</span><span class="token punctuation">,</span><span class="token number">0x467e5462</span><span class="token punctuation">,</span><span class="token number">0x138df6c2</span><span class="token punctuation">,</span><span class="token number">0xb8d890e8</span><span class="token punctuation">,</span>
<span class="token number">0xf7392e5e</span><span class="token punctuation">,</span><span class="token number">0xafc382f5</span><span class="token punctuation">,</span><span class="token number">0x805d9fbe</span><span class="token punctuation">,</span><span class="token number">0x93d0697c</span><span class="token punctuation">,</span><span class="token number">0x2dd56fa9</span><span class="token punctuation">,</span><span class="token number">0x1225cfb3</span><span class="token punctuation">,</span>
<span class="token number">0x99acc83b</span><span class="token punctuation">,</span><span class="token number">0x7d1810a7</span><span class="token punctuation">,</span><span class="token number">0x639ce86e</span><span class="token punctuation">,</span><span class="token number">0xbb3bdb7b</span><span class="token punctuation">,</span><span class="token number">0x7826cd09</span><span class="token punctuation">,</span><span class="token number">0x18596ef4</span><span class="token punctuation">,</span>
<span class="token number">0xb79aec01</span><span class="token punctuation">,</span><span class="token number">0x9a4f83a8</span><span class="token punctuation">,</span><span class="token number">0x6e95e665</span><span class="token punctuation">,</span><span class="token number">0xe6ffaa7e</span><span class="token punctuation">,</span><span class="token number">0xcfbc2108</span><span class="token punctuation">,</span><span class="token number">0xe815efe6</span><span class="token punctuation">,</span>
<span class="token number">0x9be7bad9</span><span class="token punctuation">,</span><span class="token number">0x366f4ace</span><span class="token punctuation">,</span><span class="token number">0x99fead4</span><span class="token punctuation">,</span><span class="token number">0x7cb029d6</span><span class="token punctuation">,</span><span class="token number">0xb2a431af</span><span class="token punctuation">,</span><span class="token number">0x233f2a31</span><span class="token punctuation">,</span>
<span class="token number">0x94a5c630</span><span class="token punctuation">,</span><span class="token number">0x66a235c0</span><span class="token punctuation">,</span><span class="token number">0xbc4e7437</span><span class="token punctuation">,</span><span class="token number">0xca82fca6</span><span class="token punctuation">,</span><span class="token number">0xd090e0b0</span><span class="token punctuation">,</span><span class="token number">0xd8a73315</span><span class="token punctuation">,</span>
<span class="token number">0x9804f14a</span><span class="token punctuation">,</span><span class="token number">0xdaec41f7</span><span class="token punctuation">,</span><span class="token number">0x50cd7f0e</span><span class="token punctuation">,</span><span class="token number">0xf691172f</span><span class="token punctuation">,</span><span class="token number">0xd64d768d</span><span class="token punctuation">,</span><span class="token number">0xb0ef434d</span><span class="token punctuation">,</span>
<span class="token number">0x4daacc54</span><span class="token punctuation">,</span><span class="token number">0x496e4df</span><span class="token punctuation">,</span><span class="token number">0xb5d19ee3</span><span class="token punctuation">,</span><span class="token number">0x886a4c1b</span><span class="token punctuation">,</span><span class="token number">0x1f2cc1b8</span><span class="token punctuation">,</span><span class="token number">0x5165467f</span><span class="token punctuation">,</span>
<span class="token number">0xea5e9d04</span><span class="token punctuation">,</span><span class="token number">0x358c015d</span><span class="token punctuation">,</span><span class="token number">0x7487fa73</span><span class="token punctuation">,</span><span class="token number">0x410bfb2e</span><span class="token punctuation">,</span><span class="token number">0x1d67b35a</span><span class="token punctuation">,</span><span class="token number">0xd2db9252</span><span class="token punctuation">,</span>
<span class="token number">0x5610e933</span><span class="token punctuation">,</span><span class="token number">0x47d66d13</span><span class="token punctuation">,</span><span class="token number">0x61d79a8c</span><span class="token punctuation">,</span><span class="token number">0xca1377a</span><span class="token punctuation">,</span><span class="token number">0x14f8598e</span><span class="token punctuation">,</span><span class="token number">0x3c13eb89</span><span class="token punctuation">,</span>
<span class="token number">0x27a9ceee</span><span class="token punctuation">,</span><span class="token number">0xc961b735</span><span class="token punctuation">,</span><span class="token number">0xe51ce1ed</span><span class="token punctuation">,</span><span class="token number">0xb1477a3c</span><span class="token punctuation">,</span><span class="token number">0xdfd29c59</span><span class="token punctuation">,</span><span class="token number">0x73f2553f</span><span class="token punctuation">,</span>
<span class="token number">0xce141879</span><span class="token punctuation">,</span><span class="token number">0x37c773bf</span><span class="token punctuation">,</span><span class="token number">0xcdf753ea</span><span class="token punctuation">,</span><span class="token number">0xaafd5f5b</span><span class="token punctuation">,</span><span class="token number">0x6f3ddf14</span><span class="token punctuation">,</span><span class="token number">0xdb447886</span><span class="token punctuation">,</span>
<span class="token number">0xf3afca81</span><span class="token punctuation">,</span><span class="token number">0xc468b93e</span><span class="token punctuation">,</span><span class="token number">0x3424382c</span><span class="token punctuation">,</span><span class="token number">0x40a3c25f</span><span class="token punctuation">,</span><span class="token number">0xc31d1672</span><span class="token punctuation">,</span><span class="token number">0x25e2bc0c</span><span class="token punctuation">,</span>
<span class="token number">0x493c288b</span><span class="token punctuation">,</span><span class="token number">0x950dff41</span><span class="token punctuation">,</span><span class="token number">0x1a83971</span><span class="token punctuation">,</span><span class="token number">0xb30c08de</span><span class="token punctuation">,</span><span class="token number">0xe4b4d89c</span><span class="token punctuation">,</span><span class="token number">0xc1566490</span><span class="token punctuation">,</span>
<span class="token number">0x84cb7b61</span><span class="token punctuation">,</span><span class="token number">0xb632d570</span><span class="token punctuation">,</span><span class="token number">0x5c6c4874</span><span class="token punctuation">,</span><span class="token number">0x57b8d042</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0x63c6a563</span><span class="token punctuation">,</span><span class="token number">0x7cf8847c</span><span class="token punctuation">,</span><span class="token number">0x77ee9977</span><span class="token punctuation">,</span><span class="token number">0x7bf68d7b</span><span class="token punctuation">,</span><span class="token number">0xf2ff0df2</span><span class="token punctuation">,</span><span class="token number">0x6bd6bd6b</span><span class="token punctuation">,</span>
<span class="token number">0x6fdeb16f</span><span class="token punctuation">,</span><span class="token number">0xc59154c5</span><span class="token punctuation">,</span><span class="token number">0x30605030</span><span class="token punctuation">,</span><span class="token number">0x1020301</span><span class="token punctuation">,</span><span class="token number">0x67cea967</span><span class="token punctuation">,</span><span class="token number">0x2b567d2b</span><span class="token punctuation">,</span>
<span class="token number">0xfee719fe</span><span class="token punctuation">,</span><span class="token number">0xd7b562d7</span><span class="token punctuation">,</span><span class="token number">0xab4de6ab</span><span class="token punctuation">,</span><span class="token number">0x76ec9a76</span><span class="token punctuation">,</span><span class="token number">0xca8f45ca</span><span class="token punctuation">,</span><span class="token number">0x821f9d82</span><span class="token punctuation">,</span>
<span class="token number">0xc98940c9</span><span class="token punctuation">,</span><span class="token number">0x7dfa877d</span><span class="token punctuation">,</span><span class="token number">0xfaef15fa</span><span class="token punctuation">,</span><span class="token number">0x59b2eb59</span><span class="token punctuation">,</span><span class="token number">0x478ec947</span><span class="token punctuation">,</span><span class="token number">0xf0fb0bf0</span><span class="token punctuation">,</span>
<span class="token number">0xad41ecad</span><span class="token punctuation">,</span><span class="token number">0xd4b367d4</span><span class="token punctuation">,</span><span class="token number">0xa25ffda2</span><span class="token punctuation">,</span><span class="token number">0xaf45eaaf</span><span class="token punctuation">,</span><span class="token number">0x9c23bf9c</span><span class="token punctuation">,</span><span class="token number">0xa453f7a4</span><span class="token punctuation">,</span>
<span class="token number">0x72e49672</span><span class="token punctuation">,</span><span class="token number">0xc09b5bc0</span><span class="token punctuation">,</span><span class="token number">0xb775c2b7</span><span class="token punctuation">,</span><span class="token number">0xfde11cfd</span><span class="token punctuation">,</span><span class="token number">0x933dae93</span><span class="token punctuation">,</span><span class="token number">0x264c6a26</span><span class="token punctuation">,</span>
<span class="token number">0x366c5a36</span><span class="token punctuation">,</span><span class="token number">0x3f7e413f</span><span class="token punctuation">,</span><span class="token number">0xf7f502f7</span><span class="token punctuation">,</span><span class="token number">0xcc834fcc</span><span class="token punctuation">,</span><span class="token number">0x34685c34</span><span class="token punctuation">,</span><span class="token number">0xa551f4a5</span><span class="token punctuation">,</span>
<span class="token number">0xe5d134e5</span><span class="token punctuation">,</span><span class="token number">0xf1f908f1</span><span class="token punctuation">,</span><span class="token number">0x71e29371</span><span class="token punctuation">,</span><span class="token number">0xd8ab73d8</span><span class="token punctuation">,</span><span class="token number">0x31625331</span><span class="token punctuation">,</span><span class="token number">0x152a3f15</span><span class="token punctuation">,</span>
<span class="token number">0x4080c04</span><span class="token punctuation">,</span><span class="token number">0xc79552c7</span><span class="token punctuation">,</span><span class="token number">0x23466523</span><span class="token punctuation">,</span><span class="token number">0xc39d5ec3</span><span class="token punctuation">,</span><span class="token number">0x18302818</span><span class="token punctuation">,</span><span class="token number">0x9637a196</span><span class="token punctuation">,</span>
<span class="token number">0x50a0f05</span><span class="token punctuation">,</span><span class="token number">0x9a2fb59a</span><span class="token punctuation">,</span><span class="token number">0x70e0907</span><span class="token punctuation">,</span><span class="token number">0x12243612</span><span class="token punctuation">,</span><span class="token number">0x801b9b80</span><span class="token punctuation">,</span><span class="token number">0xe2df3de2</span><span class="token punctuation">,</span>
<span class="token number">0xebcd26eb</span><span class="token punctuation">,</span><span class="token number">0x274e6927</span><span class="token punctuation">,</span><span class="token number">0xb27fcdb2</span><span class="token punctuation">,</span><span class="token number">0x75ea9f75</span><span class="token punctuation">,</span><span class="token number">0x9121b09</span><span class="token punctuation">,</span><span class="token number">0x831d9e83</span><span class="token punctuation">,</span>
<span class="token number">0x2c58742c</span><span class="token punctuation">,</span><span class="token number">0x1a342e1a</span><span class="token punctuation">,</span><span class="token number">0x1b362d1b</span><span class="token punctuation">,</span><span class="token number">0x6edcb26e</span><span class="token punctuation">,</span><span class="token number">0x5ab4ee5a</span><span class="token punctuation">,</span><span class="token number">0xa05bfba0</span><span class="token punctuation">,</span>
<span class="token number">0x52a4f652</span><span class="token punctuation">,</span><span class="token number">0x3b764d3b</span><span class="token punctuation">,</span><span class="token number">0xd6b761d6</span><span class="token punctuation">,</span><span class="token number">0xb37dceb3</span><span class="token punctuation">,</span><span class="token number">0x29527b29</span><span class="token punctuation">,</span><span class="token number">0xe3dd3ee3</span><span class="token punctuation">,</span>
<span class="token number">0x2f5e712f</span><span class="token punctuation">,</span><span class="token number">0x84139784</span><span class="token punctuation">,</span><span class="token number">0x53a6f553</span><span class="token punctuation">,</span><span class="token number">0xd1b968d1</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0xedc12ced</span><span class="token punctuation">,</span>
<span class="token number">0x20406020</span><span class="token punctuation">,</span><span class="token number">0xfce31ffc</span><span class="token punctuation">,</span><span class="token number">0xb179c8b1</span><span class="token punctuation">,</span><span class="token number">0x5bb6ed5b</span><span class="token punctuation">,</span><span class="token number">0x6ad4be6a</span><span class="token punctuation">,</span><span class="token number">0xcb8d46cb</span><span class="token punctuation">,</span>
<span class="token number">0xbe67d9be</span><span class="token punctuation">,</span><span class="token number">0x39724b39</span><span class="token punctuation">,</span><span class="token number">0x4a94de4a</span><span class="token punctuation">,</span><span class="token number">0x4c98d44c</span><span class="token punctuation">,</span><span class="token number">0x58b0e858</span><span class="token punctuation">,</span><span class="token number">0xcf854acf</span><span class="token punctuation">,</span>
<span class="token number">0xd0bb6bd0</span><span class="token punctuation">,</span><span class="token number">0xefc52aef</span><span class="token punctuation">,</span><span class="token number">0xaa4fe5aa</span><span class="token punctuation">,</span><span class="token number">0xfbed16fb</span><span class="token punctuation">,</span><span class="token number">0x4386c543</span><span class="token punctuation">,</span><span class="token number">0x4d9ad74d</span><span class="token punctuation">,</span>
<span class="token number">0x33665533</span><span class="token punctuation">,</span><span class="token number">0x85119485</span><span class="token punctuation">,</span><span class="token number">0x458acf45</span><span class="token punctuation">,</span><span class="token number">0xf9e910f9</span><span class="token punctuation">,</span><span class="token number">0x2040602</span><span class="token punctuation">,</span><span class="token number">0x7ffe817f</span><span class="token punctuation">,</span>
<span class="token number">0x50a0f050</span><span class="token punctuation">,</span><span class="token number">0x3c78443c</span><span class="token punctuation">,</span><span class="token number">0x9f25ba9f</span><span class="token punctuation">,</span><span class="token number">0xa84be3a8</span><span class="token punctuation">,</span><span class="token number">0x51a2f351</span><span class="token punctuation">,</span><span class="token number">0xa35dfea3</span><span class="token punctuation">,</span>
<span class="token number">0x4080c040</span><span class="token punctuation">,</span><span class="token number">0x8f058a8f</span><span class="token punctuation">,</span><span class="token number">0x923fad92</span><span class="token punctuation">,</span><span class="token number">0x9d21bc9d</span><span class="token punctuation">,</span><span class="token number">0x38704838</span><span class="token punctuation">,</span><span class="token number">0xf5f104f5</span><span class="token punctuation">,</span>
<span class="token number">0xbc63dfbc</span><span class="token punctuation">,</span><span class="token number">0xb677c1b6</span><span class="token punctuation">,</span><span class="token number">0xdaaf75da</span><span class="token punctuation">,</span><span class="token number">0x21426321</span><span class="token punctuation">,</span><span class="token number">0x10203010</span><span class="token punctuation">,</span><span class="token number">0xffe51aff</span><span class="token punctuation">,</span>
<span class="token number">0xf3fd0ef3</span><span class="token punctuation">,</span><span class="token number">0xd2bf6dd2</span><span class="token punctuation">,</span><span class="token number">0xcd814ccd</span><span class="token punctuation">,</span><span class="token number">0xc18140c</span><span class="token punctuation">,</span><span class="token number">0x13263513</span><span class="token punctuation">,</span><span class="token number">0xecc32fec</span><span class="token punctuation">,</span>
<span class="token number">0x5fbee15f</span><span class="token punctuation">,</span><span class="token number">0x9735a297</span><span class="token punctuation">,</span><span class="token number">0x4488cc44</span><span class="token punctuation">,</span><span class="token number">0x172e3917</span><span class="token punctuation">,</span><span class="token number">0xc49357c4</span><span class="token punctuation">,</span><span class="token number">0xa755f2a7</span><span class="token punctuation">,</span>
<span class="token number">0x7efc827e</span><span class="token punctuation">,</span><span class="token number">0x3d7a473d</span><span class="token punctuation">,</span><span class="token number">0x64c8ac64</span><span class="token punctuation">,</span><span class="token number">0x5dbae75d</span><span class="token punctuation">,</span><span class="token number">0x19322b19</span><span class="token punctuation">,</span><span class="token number">0x73e69573</span><span class="token punctuation">,</span>
<span class="token number">0x60c0a060</span><span class="token punctuation">,</span><span class="token number">0x81199881</span><span class="token punctuation">,</span><span class="token number">0x4f9ed14f</span><span class="token punctuation">,</span><span class="token number">0xdca37fdc</span><span class="token punctuation">,</span><span class="token number">0x22446622</span><span class="token punctuation">,</span><span class="token number">0x2a547e2a</span><span class="token punctuation">,</span>
<span class="token number">0x903bab90</span><span class="token punctuation">,</span><span class="token number">0x880b8388</span><span class="token punctuation">,</span><span class="token number">0x468cca46</span><span class="token punctuation">,</span><span class="token number">0xeec729ee</span><span class="token punctuation">,</span><span class="token number">0xb86bd3b8</span><span class="token punctuation">,</span><span class="token number">0x14283c14</span><span class="token punctuation">,</span>
<span class="token number">0xdea779de</span><span class="token punctuation">,</span><span class="token number">0x5ebce25e</span><span class="token punctuation">,</span><span class="token number">0xb161d0b</span><span class="token punctuation">,</span><span class="token number">0xdbad76db</span><span class="token punctuation">,</span><span class="token number">0xe0db3be0</span><span class="token punctuation">,</span><span class="token number">0x32645632</span><span class="token punctuation">,</span>
<span class="token number">0x3a744e3a</span><span class="token punctuation">,</span><span class="token number">0xa141e0a</span><span class="token punctuation">,</span><span class="token number">0x4992db49</span><span class="token punctuation">,</span><span class="token number">0x60c0a06</span><span class="token punctuation">,</span><span class="token number">0x24486c24</span><span class="token punctuation">,</span><span class="token number">0x5cb8e45c</span><span class="token punctuation">,</span>
<span class="token number">0xc29f5dc2</span><span class="token punctuation">,</span><span class="token number">0xd3bd6ed3</span><span class="token punctuation">,</span><span class="token number">0xac43efac</span><span class="token punctuation">,</span><span class="token number">0x62c4a662</span><span class="token punctuation">,</span><span class="token number">0x9139a891</span><span class="token punctuation">,</span><span class="token number">0x9531a495</span><span class="token punctuation">,</span>
<span class="token number">0xe4d337e4</span><span class="token punctuation">,</span><span class="token number">0x79f28b79</span><span class="token punctuation">,</span><span class="token number">0xe7d532e7</span><span class="token punctuation">,</span><span class="token number">0xc88b43c8</span><span class="token punctuation">,</span><span class="token number">0x376e5937</span><span class="token punctuation">,</span><span class="token number">0x6ddab76d</span><span class="token punctuation">,</span>
<span class="token number">0x8d018c8d</span><span class="token punctuation">,</span><span class="token number">0xd5b164d5</span><span class="token punctuation">,</span><span class="token number">0x4e9cd24e</span><span class="token punctuation">,</span><span class="token number">0xa949e0a9</span><span class="token punctuation">,</span><span class="token number">0x6cd8b46c</span><span class="token punctuation">,</span><span class="token number">0x56acfa56</span><span class="token punctuation">,</span>
<span class="token number">0xf4f307f4</span><span class="token punctuation">,</span><span class="token number">0xeacf25ea</span><span class="token punctuation">,</span><span class="token number">0x65caaf65</span><span class="token punctuation">,</span><span class="token number">0x7af48e7a</span><span class="token punctuation">,</span><span class="token number">0xae47e9ae</span><span class="token punctuation">,</span><span class="token number">0x8101808</span><span class="token punctuation">,</span>
<span class="token number">0xba6fd5ba</span><span class="token punctuation">,</span><span class="token number">0x78f08878</span><span class="token punctuation">,</span><span class="token number">0x254a6f25</span><span class="token punctuation">,</span><span class="token number">0x2e5c722e</span><span class="token punctuation">,</span><span class="token number">0x1c38241c</span><span class="token punctuation">,</span><span class="token number">0xa657f1a6</span><span class="token punctuation">,</span>
<span class="token number">0xb473c7b4</span><span class="token punctuation">,</span><span class="token number">0xc69751c6</span><span class="token punctuation">,</span><span class="token number">0xe8cb23e8</span><span class="token punctuation">,</span><span class="token number">0xdda17cdd</span><span class="token punctuation">,</span><span class="token number">0x74e89c74</span><span class="token punctuation">,</span><span class="token number">0x1f3e211f</span><span class="token punctuation">,</span>
<span class="token number">0x4b96dd4b</span><span class="token punctuation">,</span><span class="token number">0xbd61dcbd</span><span class="token punctuation">,</span><span class="token number">0x8b0d868b</span><span class="token punctuation">,</span><span class="token number">0x8a0f858a</span><span class="token punctuation">,</span><span class="token number">0x70e09070</span><span class="token punctuation">,</span><span class="token number">0x3e7c423e</span><span class="token punctuation">,</span>
<span class="token number">0xb571c4b5</span><span class="token punctuation">,</span><span class="token number">0x66ccaa66</span><span class="token punctuation">,</span><span class="token number">0x4890d848</span><span class="token punctuation">,</span><span class="token number">0x3060503</span><span class="token punctuation">,</span><span class="token number">0xf6f701f6</span><span class="token punctuation">,</span><span class="token number">0xe1c120e</span><span class="token punctuation">,</span>
<span class="token number">0x61c2a361</span><span class="token punctuation">,</span><span class="token number">0x356a5f35</span><span class="token punctuation">,</span><span class="token number">0x57aef957</span><span class="token punctuation">,</span><span class="token number">0xb969d0b9</span><span class="token punctuation">,</span><span class="token number">0x86179186</span><span class="token punctuation">,</span><span class="token number">0xc19958c1</span><span class="token punctuation">,</span>
<span class="token number">0x1d3a271d</span><span class="token punctuation">,</span><span class="token number">0x9e27b99e</span><span class="token punctuation">,</span><span class="token number">0xe1d938e1</span><span class="token punctuation">,</span><span class="token number">0xf8eb13f8</span><span class="token punctuation">,</span><span class="token number">0x982bb398</span><span class="token punctuation">,</span><span class="token number">0x11223311</span><span class="token punctuation">,</span>
<span class="token number">0x69d2bb69</span><span class="token punctuation">,</span><span class="token number">0xd9a970d9</span><span class="token punctuation">,</span><span class="token number">0x8e07898e</span><span class="token punctuation">,</span><span class="token number">0x9433a794</span><span class="token punctuation">,</span><span class="token number">0x9b2db69b</span><span class="token punctuation">,</span><span class="token number">0x1e3c221e</span><span class="token punctuation">,</span>
<span class="token number">0x87159287</span><span class="token punctuation">,</span><span class="token number">0xe9c920e9</span><span class="token punctuation">,</span><span class="token number">0xce8749ce</span><span class="token punctuation">,</span><span class="token number">0x55aaff55</span><span class="token punctuation">,</span><span class="token number">0x28507828</span><span class="token punctuation">,</span><span class="token number">0xdfa57adf</span><span class="token punctuation">,</span>
<span class="token number">0x8c038f8c</span><span class="token punctuation">,</span><span class="token number">0xa159f8a1</span><span class="token punctuation">,</span><span class="token number">0x89098089</span><span class="token punctuation">,</span><span class="token number">0xd1a170d</span><span class="token punctuation">,</span><span class="token number">0xbf65dabf</span><span class="token punctuation">,</span><span class="token number">0xe6d731e6</span><span class="token punctuation">,</span>
<span class="token number">0x4284c642</span><span class="token punctuation">,</span><span class="token number">0x68d0b868</span><span class="token punctuation">,</span><span class="token number">0x4182c341</span><span class="token punctuation">,</span><span class="token number">0x9929b099</span><span class="token punctuation">,</span><span class="token number">0x2d5a772d</span><span class="token punctuation">,</span><span class="token number">0xf1e110f</span><span class="token punctuation">,</span>
<span class="token number">0xb07bcbb0</span><span class="token punctuation">,</span><span class="token number">0x54a8fc54</span><span class="token punctuation">,</span><span class="token number">0xbb6dd6bb</span><span class="token punctuation">,</span><span class="token number">0x162c3a16</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0xf45150a7</span><span class="token punctuation">,</span><span class="token number">0x417e5365</span><span class="token punctuation">,</span><span class="token number">0x171ac3a4</span><span class="token punctuation">,</span><span class="token number">0x273a965e</span><span class="token punctuation">,</span><span class="token number">0xab3bcb6b</span><span class="token punctuation">,</span><span class="token number">0x9d1ff145</span><span class="token punctuation">,</span>
<span class="token number">0xfaacab58</span><span class="token punctuation">,</span><span class="token number">0xe34b9303</span><span class="token punctuation">,</span><span class="token number">0x302055fa</span><span class="token punctuation">,</span><span class="token number">0x76adf66d</span><span class="token punctuation">,</span><span class="token number">0xcc889176</span><span class="token punctuation">,</span><span class="token number">0x2f5254c</span><span class="token punctuation">,</span>
<span class="token number">0xe54ffcd7</span><span class="token punctuation">,</span><span class="token number">0x2ac5d7cb</span><span class="token punctuation">,</span><span class="token number">0x35268044</span><span class="token punctuation">,</span><span class="token number">0x62b58fa3</span><span class="token punctuation">,</span><span class="token number">0xb1de495a</span><span class="token punctuation">,</span><span class="token number">0xba25671b</span><span class="token punctuation">,</span>
<span class="token number">0xea45980e</span><span class="token punctuation">,</span><span class="token number">0xfe5de1c0</span><span class="token punctuation">,</span><span class="token number">0x2fc30275</span><span class="token punctuation">,</span><span class="token number">0x4c8112f0</span><span class="token punctuation">,</span><span class="token number">0x468da397</span><span class="token punctuation">,</span><span class="token number">0xd36bc6f9</span><span class="token punctuation">,</span>
<span class="token number">0x8f03e75f</span><span class="token punctuation">,</span><span class="token number">0x9215959c</span><span class="token punctuation">,</span><span class="token number">0x6dbfeb7a</span><span class="token punctuation">,</span><span class="token number">0x5295da59</span><span class="token punctuation">,</span><span class="token number">0xbed42d83</span><span class="token punctuation">,</span><span class="token number">0x7458d321</span><span class="token punctuation">,</span>
<span class="token number">0xe0492969</span><span class="token punctuation">,</span><span class="token number">0xc98e44c8</span><span class="token punctuation">,</span><span class="token number">0xc2756a89</span><span class="token punctuation">,</span><span class="token number">0x8ef47879</span><span class="token punctuation">,</span><span class="token number">0x58996b3e</span><span class="token punctuation">,</span><span class="token number">0xb927dd71</span><span class="token punctuation">,</span>
<span class="token number">0xe1beb64f</span><span class="token punctuation">,</span><span class="token number">0x88f017ad</span><span class="token punctuation">,</span><span class="token number">0x20c966ac</span><span class="token punctuation">,</span><span class="token number">0xce7db43a</span><span class="token punctuation">,</span><span class="token number">0xdf63184a</span><span class="token punctuation">,</span><span class="token number">0x1ae58231</span><span class="token punctuation">,</span>
<span class="token number">0x51976033</span><span class="token punctuation">,</span><span class="token number">0x5362457f</span><span class="token punctuation">,</span><span class="token number">0x64b1e077</span><span class="token punctuation">,</span><span class="token number">0x6bbb84ae</span><span class="token punctuation">,</span><span class="token number">0x81fe1ca0</span><span class="token punctuation">,</span><span class="token number">0x8f9942b</span><span class="token punctuation">,</span>
<span class="token number">0x48705868</span><span class="token punctuation">,</span><span class="token number">0x458f19fd</span><span class="token punctuation">,</span><span class="token number">0xde94876c</span><span class="token punctuation">,</span><span class="token number">0x7b52b7f8</span><span class="token punctuation">,</span><span class="token number">0x73ab23d3</span><span class="token punctuation">,</span><span class="token number">0x4b72e202</span><span class="token punctuation">,</span>
<span class="token number">0x1fe3578f</span><span class="token punctuation">,</span><span class="token number">0x55662aab</span><span class="token punctuation">,</span><span class="token number">0xebb20728</span><span class="token punctuation">,</span><span class="token number">0xb52f03c2</span><span class="token punctuation">,</span><span class="token number">0xc5869a7b</span><span class="token punctuation">,</span><span class="token number">0x37d3a508</span><span class="token punctuation">,</span>
<span class="token number">0x2830f287</span><span class="token punctuation">,</span><span class="token number">0xbf23b2a5</span><span class="token punctuation">,</span><span class="token number">0x302ba6a</span><span class="token punctuation">,</span><span class="token number">0x16ed5c82</span><span class="token punctuation">,</span><span class="token number">0xcf8a2b1c</span><span class="token punctuation">,</span><span class="token number">0x79a792b4</span><span class="token punctuation">,</span>
<span class="token number">0x7f3f0f2</span><span class="token punctuation">,</span><span class="token number">0x694ea1e2</span><span class="token punctuation">,</span><span class="token number">0xda65cdf4</span><span class="token punctuation">,</span><span class="token number">0x506d5be</span><span class="token punctuation">,</span><span class="token number">0x34d11f62</span><span class="token punctuation">,</span><span class="token number">0xa6c48afe</span><span class="token punctuation">,</span>
<span class="token number">0x2e349d53</span><span class="token punctuation">,</span><span class="token number">0xf3a2a055</span><span class="token punctuation">,</span><span class="token number">0x8a0532e1</span><span class="token punctuation">,</span><span class="token number">0xf6a475eb</span><span class="token punctuation">,</span><span class="token number">0x830b39ec</span><span class="token punctuation">,</span><span class="token number">0x6040aaef</span><span class="token punctuation">,</span>
<span class="token number">0x715e069f</span><span class="token punctuation">,</span><span class="token number">0x6ebd5110</span><span class="token punctuation">,</span><span class="token number">0x213ef98a</span><span class="token punctuation">,</span><span class="token number">0xdd963d06</span><span class="token punctuation">,</span><span class="token number">0x3eddae05</span><span class="token punctuation">,</span><span class="token number">0xe64d46bd</span><span class="token punctuation">,</span>
<span class="token number">0x5491b58d</span><span class="token punctuation">,</span><span class="token number">0xc471055d</span><span class="token punctuation">,</span><span class="token number">0x6046fd4</span><span class="token punctuation">,</span><span class="token number">0x5060ff15</span><span class="token punctuation">,</span><span class="token number">0x981924fb</span><span class="token punctuation">,</span><span class="token number">0xbdd697e9</span><span class="token punctuation">,</span>
<span class="token number">0x4089cc43</span><span class="token punctuation">,</span><span class="token number">0xd967779e</span><span class="token punctuation">,</span><span class="token number">0xe8b0bd42</span><span class="token punctuation">,</span><span class="token number">0x8907888b</span><span class="token punctuation">,</span><span class="token number">0x19e7385b</span><span class="token punctuation">,</span><span class="token number">0xc879dbee</span><span class="token punctuation">,</span>
<span class="token number">0x7ca1470a</span><span class="token punctuation">,</span><span class="token number">0x427ce90f</span><span class="token punctuation">,</span><span class="token number">0x84f8c91e</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x80098386</span><span class="token punctuation">,</span><span class="token number">0x2b3248ed</span><span class="token punctuation">,</span>
<span class="token number">0x111eac70</span><span class="token punctuation">,</span><span class="token number">0x5a6c4e72</span><span class="token punctuation">,</span><span class="token number">0xefdfbff</span><span class="token punctuation">,</span><span class="token number">0x850f5638</span><span class="token punctuation">,</span><span class="token number">0xae3d1ed5</span><span class="token punctuation">,</span><span class="token number">0x2d362739</span><span class="token punctuation">,</span>
<span class="token number">0xf0a64d9</span><span class="token punctuation">,</span><span class="token number">0x5c6821a6</span><span class="token punctuation">,</span><span class="token number">0x5b9bd154</span><span class="token punctuation">,</span><span class="token number">0x36243a2e</span><span class="token punctuation">,</span><span class="token number">0xa0cb167</span><span class="token punctuation">,</span><span class="token number">0x57930fe7</span><span class="token punctuation">,</span>
<span class="token number">0xeeb4d296</span><span class="token punctuation">,</span><span class="token number">0x9b1b9e91</span><span class="token punctuation">,</span><span class="token number">0xc0804fc5</span><span class="token punctuation">,</span><span class="token number">0xdc61a220</span><span class="token punctuation">,</span><span class="token number">0x775a694b</span><span class="token punctuation">,</span><span class="token number">0x121c161a</span><span class="token punctuation">,</span>
<span class="token number">0x93e20aba</span><span class="token punctuation">,</span><span class="token number">0xa0c0e52a</span><span class="token punctuation">,</span><span class="token number">0x223c43e0</span><span class="token punctuation">,</span><span class="token number">0x1b121d17</span><span class="token punctuation">,</span><span class="token number">0x90e0b0d</span><span class="token punctuation">,</span><span class="token number">0x8bf2adc7</span><span class="token punctuation">,</span>
<span class="token number">0xb62db9a8</span><span class="token punctuation">,</span><span class="token number">0x1e14c8a9</span><span class="token punctuation">,</span><span class="token number">0xf1578519</span><span class="token punctuation">,</span><span class="token number">0x75af4c07</span><span class="token punctuation">,</span><span class="token number">0x99eebbdd</span><span class="token punctuation">,</span><span class="token number">0x7fa3fd60</span><span class="token punctuation">,</span>
<span class="token number">0x1f79f26</span><span class="token punctuation">,</span><span class="token number">0x725cbcf5</span><span class="token punctuation">,</span><span class="token number">0x6644c53b</span><span class="token punctuation">,</span><span class="token number">0xfb5b347e</span><span class="token punctuation">,</span><span class="token number">0x438b7629</span><span class="token punctuation">,</span><span class="token number">0x23cbdcc6</span><span class="token punctuation">,</span>
<span class="token number">0xedb668fc</span><span class="token punctuation">,</span><span class="token number">0xe4b863f1</span><span class="token punctuation">,</span><span class="token number">0x31d7cadc</span><span class="token punctuation">,</span><span class="token number">0x63421085</span><span class="token punctuation">,</span><span class="token number">0x97134022</span><span class="token punctuation">,</span><span class="token number">0xc6842011</span><span class="token punctuation">,</span>
<span class="token number">0x4a857d24</span><span class="token punctuation">,</span><span class="token number">0xbbd2f83d</span><span class="token punctuation">,</span><span class="token number">0xf9ae1132</span><span class="token punctuation">,</span><span class="token number">0x29c76da1</span><span class="token punctuation">,</span><span class="token number">0x9e1d4b2f</span><span class="token punctuation">,</span><span class="token number">0xb2dcf330</span><span class="token punctuation">,</span>
<span class="token number">0x860dec52</span><span class="token punctuation">,</span><span class="token number">0xc177d0e3</span><span class="token punctuation">,</span><span class="token number">0xb32b6c16</span><span class="token punctuation">,</span><span class="token number">0x70a999b9</span><span class="token punctuation">,</span><span class="token number">0x9411fa48</span><span class="token punctuation">,</span><span class="token number">0xe9472264</span><span class="token punctuation">,</span>
<span class="token number">0xfca8c48c</span><span class="token punctuation">,</span><span class="token number">0xf0a01a3f</span><span class="token punctuation">,</span><span class="token number">0x7d56d82c</span><span class="token punctuation">,</span><span class="token number">0x3322ef90</span><span class="token punctuation">,</span><span class="token number">0x4987c74e</span><span class="token punctuation">,</span><span class="token number">0x38d9c1d1</span><span class="token punctuation">,</span>
<span class="token number">0xca8cfea2</span><span class="token punctuation">,</span><span class="token number">0xd498360b</span><span class="token punctuation">,</span><span class="token number">0xf5a6cf81</span><span class="token punctuation">,</span><span class="token number">0x7aa528de</span><span class="token punctuation">,</span><span class="token number">0xb7da268e</span><span class="token punctuation">,</span><span class="token number">0xad3fa4bf</span><span class="token punctuation">,</span>
<span class="token number">0x3a2ce49d</span><span class="token punctuation">,</span><span class="token number">0x78500d92</span><span class="token punctuation">,</span><span class="token number">0x5f6a9bcc</span><span class="token punctuation">,</span><span class="token number">0x7e546246</span><span class="token punctuation">,</span><span class="token number">0x8df6c213</span><span class="token punctuation">,</span><span class="token number">0xd890e8b8</span><span class="token punctuation">,</span>
<span class="token number">0x392e5ef7</span><span class="token punctuation">,</span><span class="token number">0xc382f5af</span><span class="token punctuation">,</span><span class="token number">0x5d9fbe80</span><span class="token punctuation">,</span><span class="token number">0xd0697c93</span><span class="token punctuation">,</span><span class="token number">0xd56fa92d</span><span class="token punctuation">,</span><span class="token number">0x25cfb312</span><span class="token punctuation">,</span>
<span class="token number">0xacc83b99</span><span class="token punctuation">,</span><span class="token number">0x1810a77d</span><span class="token punctuation">,</span><span class="token number">0x9ce86e63</span><span class="token punctuation">,</span><span class="token number">0x3bdb7bbb</span><span class="token punctuation">,</span><span class="token number">0x26cd0978</span><span class="token punctuation">,</span><span class="token number">0x596ef418</span><span class="token punctuation">,</span>
<span class="token number">0x9aec01b7</span><span class="token punctuation">,</span><span class="token number">0x4f83a89a</span><span class="token punctuation">,</span><span class="token number">0x95e6656e</span><span class="token punctuation">,</span><span class="token number">0xffaa7ee6</span><span class="token punctuation">,</span><span class="token number">0xbc2108cf</span><span class="token punctuation">,</span><span class="token number">0x15efe6e8</span><span class="token punctuation">,</span>
<span class="token number">0xe7bad99b</span><span class="token punctuation">,</span><span class="token number">0x6f4ace36</span><span class="token punctuation">,</span><span class="token number">0x9fead409</span><span class="token punctuation">,</span><span class="token number">0xb029d67c</span><span class="token punctuation">,</span><span class="token number">0xa431afb2</span><span class="token punctuation">,</span><span class="token number">0x3f2a3123</span><span class="token punctuation">,</span>
<span class="token number">0xa5c63094</span><span class="token punctuation">,</span><span class="token number">0xa235c066</span><span class="token punctuation">,</span><span class="token number">0x4e7437bc</span><span class="token punctuation">,</span><span class="token number">0x82fca6ca</span><span class="token punctuation">,</span><span class="token number">0x90e0b0d0</span><span class="token punctuation">,</span><span class="token number">0xa73315d8</span><span class="token punctuation">,</span>
<span class="token number">0x4f14a98</span><span class="token punctuation">,</span><span class="token number">0xec41f7da</span><span class="token punctuation">,</span><span class="token number">0xcd7f0e50</span><span class="token punctuation">,</span><span class="token number">0x91172ff6</span><span class="token punctuation">,</span><span class="token number">0x4d768dd6</span><span class="token punctuation">,</span><span class="token number">0xef434db0</span><span class="token punctuation">,</span>
<span class="token number">0xaacc544d</span><span class="token punctuation">,</span><span class="token number">0x96e4df04</span><span class="token punctuation">,</span><span class="token number">0xd19ee3b5</span><span class="token punctuation">,</span><span class="token number">0x6a4c1b88</span><span class="token punctuation">,</span><span class="token number">0x2cc1b81f</span><span class="token punctuation">,</span><span class="token number">0x65467f51</span><span class="token punctuation">,</span>
<span class="token number">0x5e9d04ea</span><span class="token punctuation">,</span><span class="token number">0x8c015d35</span><span class="token punctuation">,</span><span class="token number">0x87fa7374</span><span class="token punctuation">,</span><span class="token number">0xbfb2e41</span><span class="token punctuation">,</span><span class="token number">0x67b35a1d</span><span class="token punctuation">,</span><span class="token number">0xdb9252d2</span><span class="token punctuation">,</span>
<span class="token number">0x10e93356</span><span class="token punctuation">,</span><span class="token number">0xd66d1347</span><span class="token punctuation">,</span><span class="token number">0xd79a8c61</span><span class="token punctuation">,</span><span class="token number">0xa1377a0c</span><span class="token punctuation">,</span><span class="token number">0xf8598e14</span><span class="token punctuation">,</span><span class="token number">0x13eb893c</span><span class="token punctuation">,</span>
<span class="token number">0xa9ceee27</span><span class="token punctuation">,</span><span class="token number">0x61b735c9</span><span class="token punctuation">,</span><span class="token number">0x1ce1ede5</span><span class="token punctuation">,</span><span class="token number">0x477a3cb1</span><span class="token punctuation">,</span><span class="token number">0xd29c59df</span><span class="token punctuation">,</span><span class="token number">0xf2553f73</span><span class="token punctuation">,</span>
<span class="token number">0x141879ce</span><span class="token punctuation">,</span><span class="token number">0xc773bf37</span><span class="token punctuation">,</span><span class="token number">0xf753eacd</span><span class="token punctuation">,</span><span class="token number">0xfd5f5baa</span><span class="token punctuation">,</span><span class="token number">0x3ddf146f</span><span class="token punctuation">,</span><span class="token number">0x447886db</span><span class="token punctuation">,</span>
<span class="token number">0xafca81f3</span><span class="token punctuation">,</span><span class="token number">0x68b93ec4</span><span class="token punctuation">,</span><span class="token number">0x24382c34</span><span class="token punctuation">,</span><span class="token number">0xa3c25f40</span><span class="token punctuation">,</span><span class="token number">0x1d1672c3</span><span class="token punctuation">,</span><span class="token number">0xe2bc0c25</span><span class="token punctuation">,</span>
<span class="token number">0x3c288b49</span><span class="token punctuation">,</span><span class="token number">0xdff4195</span><span class="token punctuation">,</span><span class="token number">0xa8397101</span><span class="token punctuation">,</span><span class="token number">0xc08deb3</span><span class="token punctuation">,</span><span class="token number">0xb4d89ce4</span><span class="token punctuation">,</span><span class="token number">0x566490c1</span><span class="token punctuation">,</span>
<span class="token number">0xcb7b6184</span><span class="token punctuation">,</span><span class="token number">0x32d570b6</span><span class="token punctuation">,</span><span class="token number">0x6c48745c</span><span class="token punctuation">,</span><span class="token number">0xb8d04257</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD ftable3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0xc6a56363</span><span class="token punctuation">,</span><span class="token number">0xf8847c7c</span><span class="token punctuation">,</span><span class="token number">0xee997777</span><span class="token punctuation">,</span><span class="token number">0xf68d7b7b</span><span class="token punctuation">,</span><span class="token number">0xff0df2f2</span><span class="token punctuation">,</span><span class="token number">0xd6bd6b6b</span><span class="token punctuation">,</span>
<span class="token number">0xdeb16f6f</span><span class="token punctuation">,</span><span class="token number">0x9154c5c5</span><span class="token punctuation">,</span><span class="token number">0x60503030</span><span class="token punctuation">,</span><span class="token number">0x2030101</span><span class="token punctuation">,</span><span class="token number">0xcea96767</span><span class="token punctuation">,</span><span class="token number">0x567d2b2b</span><span class="token punctuation">,</span>
<span class="token number">0xe719fefe</span><span class="token punctuation">,</span><span class="token number">0xb562d7d7</span><span class="token punctuation">,</span><span class="token number">0x4de6abab</span><span class="token punctuation">,</span><span class="token number">0xec9a7676</span><span class="token punctuation">,</span><span class="token number">0x8f45caca</span><span class="token punctuation">,</span><span class="token number">0x1f9d8282</span><span class="token punctuation">,</span>
<span class="token number">0x8940c9c9</span><span class="token punctuation">,</span><span class="token number">0xfa877d7d</span><span class="token punctuation">,</span><span class="token number">0xef15fafa</span><span class="token punctuation">,</span><span class="token number">0xb2eb5959</span><span class="token punctuation">,</span><span class="token number">0x8ec94747</span><span class="token punctuation">,</span><span class="token number">0xfb0bf0f0</span><span class="token punctuation">,</span>
<span class="token number">0x41ecadad</span><span class="token punctuation">,</span><span class="token number">0xb367d4d4</span><span class="token punctuation">,</span><span class="token number">0x5ffda2a2</span><span class="token punctuation">,</span><span class="token number">0x45eaafaf</span><span class="token punctuation">,</span><span class="token number">0x23bf9c9c</span><span class="token punctuation">,</span><span class="token number">0x53f7a4a4</span><span class="token punctuation">,</span>
<span class="token number">0xe4967272</span><span class="token punctuation">,</span><span class="token number">0x9b5bc0c0</span><span class="token punctuation">,</span><span class="token number">0x75c2b7b7</span><span class="token punctuation">,</span><span class="token number">0xe11cfdfd</span><span class="token punctuation">,</span><span class="token number">0x3dae9393</span><span class="token punctuation">,</span><span class="token number">0x4c6a2626</span><span class="token punctuation">,</span>
<span class="token number">0x6c5a3636</span><span class="token punctuation">,</span><span class="token number">0x7e413f3f</span><span class="token punctuation">,</span><span class="token number">0xf502f7f7</span><span class="token punctuation">,</span><span class="token number">0x834fcccc</span><span class="token punctuation">,</span><span class="token number">0x685c3434</span><span class="token punctuation">,</span><span class="token number">0x51f4a5a5</span><span class="token punctuation">,</span>
<span class="token number">0xd134e5e5</span><span class="token punctuation">,</span><span class="token number">0xf908f1f1</span><span class="token punctuation">,</span><span class="token number">0xe2937171</span><span class="token punctuation">,</span><span class="token number">0xab73d8d8</span><span class="token punctuation">,</span><span class="token number">0x62533131</span><span class="token punctuation">,</span><span class="token number">0x2a3f1515</span><span class="token punctuation">,</span>
<span class="token number">0x80c0404</span><span class="token punctuation">,</span><span class="token number">0x9552c7c7</span><span class="token punctuation">,</span><span class="token number">0x46652323</span><span class="token punctuation">,</span><span class="token number">0x9d5ec3c3</span><span class="token punctuation">,</span><span class="token number">0x30281818</span><span class="token punctuation">,</span><span class="token number">0x37a19696</span><span class="token punctuation">,</span>
<span class="token number">0xa0f0505</span><span class="token punctuation">,</span><span class="token number">0x2fb59a9a</span><span class="token punctuation">,</span><span class="token number">0xe090707</span><span class="token punctuation">,</span><span class="token number">0x24361212</span><span class="token punctuation">,</span><span class="token number">0x1b9b8080</span><span class="token punctuation">,</span><span class="token number">0xdf3de2e2</span><span class="token punctuation">,</span>
<span class="token number">0xcd26ebeb</span><span class="token punctuation">,</span><span class="token number">0x4e692727</span><span class="token punctuation">,</span><span class="token number">0x7fcdb2b2</span><span class="token punctuation">,</span><span class="token number">0xea9f7575</span><span class="token punctuation">,</span><span class="token number">0x121b0909</span><span class="token punctuation">,</span><span class="token number">0x1d9e8383</span><span class="token punctuation">,</span>
<span class="token number">0x58742c2c</span><span class="token punctuation">,</span><span class="token number">0x342e1a1a</span><span class="token punctuation">,</span><span class="token number">0x362d1b1b</span><span class="token punctuation">,</span><span class="token number">0xdcb26e6e</span><span class="token punctuation">,</span><span class="token number">0xb4ee5a5a</span><span class="token punctuation">,</span><span class="token number">0x5bfba0a0</span><span class="token punctuation">,</span>
<span class="token number">0xa4f65252</span><span class="token punctuation">,</span><span class="token number">0x764d3b3b</span><span class="token punctuation">,</span><span class="token number">0xb761d6d6</span><span class="token punctuation">,</span><span class="token number">0x7dceb3b3</span><span class="token punctuation">,</span><span class="token number">0x527b2929</span><span class="token punctuation">,</span><span class="token number">0xdd3ee3e3</span><span class="token punctuation">,</span>
<span class="token number">0x5e712f2f</span><span class="token punctuation">,</span><span class="token number">0x13978484</span><span class="token punctuation">,</span><span class="token number">0xa6f55353</span><span class="token punctuation">,</span><span class="token number">0xb968d1d1</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0xc12ceded</span><span class="token punctuation">,</span>
<span class="token number">0x40602020</span><span class="token punctuation">,</span><span class="token number">0xe31ffcfc</span><span class="token punctuation">,</span><span class="token number">0x79c8b1b1</span><span class="token punctuation">,</span><span class="token number">0xb6ed5b5b</span><span class="token punctuation">,</span><span class="token number">0xd4be6a6a</span><span class="token punctuation">,</span><span class="token number">0x8d46cbcb</span><span class="token punctuation">,</span>
<span class="token number">0x67d9bebe</span><span class="token punctuation">,</span><span class="token number">0x724b3939</span><span class="token punctuation">,</span><span class="token number">0x94de4a4a</span><span class="token punctuation">,</span><span class="token number">0x98d44c4c</span><span class="token punctuation">,</span><span class="token number">0xb0e85858</span><span class="token punctuation">,</span><span class="token number">0x854acfcf</span><span class="token punctuation">,</span>
<span class="token number">0xbb6bd0d0</span><span class="token punctuation">,</span><span class="token number">0xc52aefef</span><span class="token punctuation">,</span><span class="token number">0x4fe5aaaa</span><span class="token punctuation">,</span><span class="token number">0xed16fbfb</span><span class="token punctuation">,</span><span class="token number">0x86c54343</span><span class="token punctuation">,</span><span class="token number">0x9ad74d4d</span><span class="token punctuation">,</span>
<span class="token number">0x66553333</span><span class="token punctuation">,</span><span class="token number">0x11948585</span><span class="token punctuation">,</span><span class="token number">0x8acf4545</span><span class="token punctuation">,</span><span class="token number">0xe910f9f9</span><span class="token punctuation">,</span><span class="token number">0x4060202</span><span class="token punctuation">,</span><span class="token number">0xfe817f7f</span><span class="token punctuation">,</span>
<span class="token number">0xa0f05050</span><span class="token punctuation">,</span><span class="token number">0x78443c3c</span><span class="token punctuation">,</span><span class="token number">0x25ba9f9f</span><span class="token punctuation">,</span><span class="token number">0x4be3a8a8</span><span class="token punctuation">,</span><span class="token number">0xa2f35151</span><span class="token punctuation">,</span><span class="token number">0x5dfea3a3</span><span class="token punctuation">,</span>
<span class="token number">0x80c04040</span><span class="token punctuation">,</span><span class="token number">0x58a8f8f</span><span class="token punctuation">,</span><span class="token number">0x3fad9292</span><span class="token punctuation">,</span><span class="token number">0x21bc9d9d</span><span class="token punctuation">,</span><span class="token number">0x70483838</span><span class="token punctuation">,</span><span class="token number">0xf104f5f5</span><span class="token punctuation">,</span>
<span class="token number">0x63dfbcbc</span><span class="token punctuation">,</span><span class="token number">0x77c1b6b6</span><span class="token punctuation">,</span><span class="token number">0xaf75dada</span><span class="token punctuation">,</span><span class="token number">0x42632121</span><span class="token punctuation">,</span><span class="token number">0x20301010</span><span class="token punctuation">,</span><span class="token number">0xe51affff</span><span class="token punctuation">,</span>
<span class="token number">0xfd0ef3f3</span><span class="token punctuation">,</span><span class="token number">0xbf6dd2d2</span><span class="token punctuation">,</span><span class="token number">0x814ccdcd</span><span class="token punctuation">,</span><span class="token number">0x18140c0c</span><span class="token punctuation">,</span><span class="token number">0x26351313</span><span class="token punctuation">,</span><span class="token number">0xc32fecec</span><span class="token punctuation">,</span>
<span class="token number">0xbee15f5f</span><span class="token punctuation">,</span><span class="token number">0x35a29797</span><span class="token punctuation">,</span><span class="token number">0x88cc4444</span><span class="token punctuation">,</span><span class="token number">0x2e391717</span><span class="token punctuation">,</span><span class="token number">0x9357c4c4</span><span class="token punctuation">,</span><span class="token number">0x55f2a7a7</span><span class="token punctuation">,</span>
<span class="token number">0xfc827e7e</span><span class="token punctuation">,</span><span class="token number">0x7a473d3d</span><span class="token punctuation">,</span><span class="token number">0xc8ac6464</span><span class="token punctuation">,</span><span class="token number">0xbae75d5d</span><span class="token punctuation">,</span><span class="token number">0x322b1919</span><span class="token punctuation">,</span><span class="token number">0xe6957373</span><span class="token punctuation">,</span>
<span class="token number">0xc0a06060</span><span class="token punctuation">,</span><span class="token number">0x19988181</span><span class="token punctuation">,</span><span class="token number">0x9ed14f4f</span><span class="token punctuation">,</span><span class="token number">0xa37fdcdc</span><span class="token punctuation">,</span><span class="token number">0x44662222</span><span class="token punctuation">,</span><span class="token number">0x547e2a2a</span><span class="token punctuation">,</span>
<span class="token number">0x3bab9090</span><span class="token punctuation">,</span><span class="token number">0xb838888</span><span class="token punctuation">,</span><span class="token number">0x8cca4646</span><span class="token punctuation">,</span><span class="token number">0xc729eeee</span><span class="token punctuation">,</span><span class="token number">0x6bd3b8b8</span><span class="token punctuation">,</span><span class="token number">0x283c1414</span><span class="token punctuation">,</span>
<span class="token number">0xa779dede</span><span class="token punctuation">,</span><span class="token number">0xbce25e5e</span><span class="token punctuation">,</span><span class="token number">0x161d0b0b</span><span class="token punctuation">,</span><span class="token number">0xad76dbdb</span><span class="token punctuation">,</span><span class="token number">0xdb3be0e0</span><span class="token punctuation">,</span><span class="token number">0x64563232</span><span class="token punctuation">,</span>
<span class="token number">0x744e3a3a</span><span class="token punctuation">,</span><span class="token number">0x141e0a0a</span><span class="token punctuation">,</span><span class="token number">0x92db4949</span><span class="token punctuation">,</span><span class="token number">0xc0a0606</span><span class="token punctuation">,</span><span class="token number">0x486c2424</span><span class="token punctuation">,</span><span class="token number">0xb8e45c5c</span><span class="token punctuation">,</span>
<span class="token number">0x9f5dc2c2</span><span class="token punctuation">,</span><span class="token number">0xbd6ed3d3</span><span class="token punctuation">,</span><span class="token number">0x43efacac</span><span class="token punctuation">,</span><span class="token number">0xc4a66262</span><span class="token punctuation">,</span><span class="token number">0x39a89191</span><span class="token punctuation">,</span><span class="token number">0x31a49595</span><span class="token punctuation">,</span>
<span class="token number">0xd337e4e4</span><span class="token punctuation">,</span><span class="token number">0xf28b7979</span><span class="token punctuation">,</span><span class="token number">0xd532e7e7</span><span class="token punctuation">,</span><span class="token number">0x8b43c8c8</span><span class="token punctuation">,</span><span class="token number">0x6e593737</span><span class="token punctuation">,</span><span class="token number">0xdab76d6d</span><span class="token punctuation">,</span>
<span class="token number">0x18c8d8d</span><span class="token punctuation">,</span><span class="token number">0xb164d5d5</span><span class="token punctuation">,</span><span class="token number">0x9cd24e4e</span><span class="token punctuation">,</span><span class="token number">0x49e0a9a9</span><span class="token punctuation">,</span><span class="token number">0xd8b46c6c</span><span class="token punctuation">,</span><span class="token number">0xacfa5656</span><span class="token punctuation">,</span>
<span class="token number">0xf307f4f4</span><span class="token punctuation">,</span><span class="token number">0xcf25eaea</span><span class="token punctuation">,</span><span class="token number">0xcaaf6565</span><span class="token punctuation">,</span><span class="token number">0xf48e7a7a</span><span class="token punctuation">,</span><span class="token number">0x47e9aeae</span><span class="token punctuation">,</span><span class="token number">0x10180808</span><span class="token punctuation">,</span>
<span class="token number">0x6fd5baba</span><span class="token punctuation">,</span><span class="token number">0xf0887878</span><span class="token punctuation">,</span><span class="token number">0x4a6f2525</span><span class="token punctuation">,</span><span class="token number">0x5c722e2e</span><span class="token punctuation">,</span><span class="token number">0x38241c1c</span><span class="token punctuation">,</span><span class="token number">0x57f1a6a6</span><span class="token punctuation">,</span>
<span class="token number">0x73c7b4b4</span><span class="token punctuation">,</span><span class="token number">0x9751c6c6</span><span class="token punctuation">,</span><span class="token number">0xcb23e8e8</span><span class="token punctuation">,</span><span class="token number">0xa17cdddd</span><span class="token punctuation">,</span><span class="token number">0xe89c7474</span><span class="token punctuation">,</span><span class="token number">0x3e211f1f</span><span class="token punctuation">,</span>
<span class="token number">0x96dd4b4b</span><span class="token punctuation">,</span><span class="token number">0x61dcbdbd</span><span class="token punctuation">,</span><span class="token number">0xd868b8b</span><span class="token punctuation">,</span><span class="token number">0xf858a8a</span><span class="token punctuation">,</span><span class="token number">0xe0907070</span><span class="token punctuation">,</span><span class="token number">0x7c423e3e</span><span class="token punctuation">,</span>
<span class="token number">0x71c4b5b5</span><span class="token punctuation">,</span><span class="token number">0xccaa6666</span><span class="token punctuation">,</span><span class="token number">0x90d84848</span><span class="token punctuation">,</span><span class="token number">0x6050303</span><span class="token punctuation">,</span><span class="token number">0xf701f6f6</span><span class="token punctuation">,</span><span class="token number">0x1c120e0e</span><span class="token punctuation">,</span>
<span class="token number">0xc2a36161</span><span class="token punctuation">,</span><span class="token number">0x6a5f3535</span><span class="token punctuation">,</span><span class="token number">0xaef95757</span><span class="token punctuation">,</span><span class="token number">0x69d0b9b9</span><span class="token punctuation">,</span><span class="token number">0x17918686</span><span class="token punctuation">,</span><span class="token number">0x9958c1c1</span><span class="token punctuation">,</span>
<span class="token number">0x3a271d1d</span><span class="token punctuation">,</span><span class="token number">0x27b99e9e</span><span class="token punctuation">,</span><span class="token number">0xd938e1e1</span><span class="token punctuation">,</span><span class="token number">0xeb13f8f8</span><span class="token punctuation">,</span><span class="token number">0x2bb39898</span><span class="token punctuation">,</span><span class="token number">0x22331111</span><span class="token punctuation">,</span>
<span class="token number">0xd2bb6969</span><span class="token punctuation">,</span><span class="token number">0xa970d9d9</span><span class="token punctuation">,</span><span class="token number">0x7898e8e</span><span class="token punctuation">,</span><span class="token number">0x33a79494</span><span class="token punctuation">,</span><span class="token number">0x2db69b9b</span><span class="token punctuation">,</span><span class="token number">0x3c221e1e</span><span class="token punctuation">,</span>
<span class="token number">0x15928787</span><span class="token punctuation">,</span><span class="token number">0xc920e9e9</span><span class="token punctuation">,</span><span class="token number">0x8749cece</span><span class="token punctuation">,</span><span class="token number">0xaaff5555</span><span class="token punctuation">,</span><span class="token number">0x50782828</span><span class="token punctuation">,</span><span class="token number">0xa57adfdf</span><span class="token punctuation">,</span>
<span class="token number">0x38f8c8c</span><span class="token punctuation">,</span><span class="token number">0x59f8a1a1</span><span class="token punctuation">,</span><span class="token number">0x9808989</span><span class="token punctuation">,</span><span class="token number">0x1a170d0d</span><span class="token punctuation">,</span><span class="token number">0x65dabfbf</span><span class="token punctuation">,</span><span class="token number">0xd731e6e6</span><span class="token punctuation">,</span>
<span class="token number">0x84c64242</span><span class="token punctuation">,</span><span class="token number">0xd0b86868</span><span class="token punctuation">,</span><span class="token number">0x82c34141</span><span class="token punctuation">,</span><span class="token number">0x29b09999</span><span class="token punctuation">,</span><span class="token number">0x5a772d2d</span><span class="token punctuation">,</span><span class="token number">0x1e110f0f</span><span class="token punctuation">,</span>
<span class="token number">0x7bcbb0b0</span><span class="token punctuation">,</span><span class="token number">0xa8fc5454</span><span class="token punctuation">,</span><span class="token number">0x6dd6bbbb</span><span class="token punctuation">,</span><span class="token number">0x2c3a1616</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">const</span> MR_WORD rtable3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token punctuation">{</span><span class="token number">0x5150a7f4</span><span class="token punctuation">,</span><span class="token number">0x7e536541</span><span class="token punctuation">,</span><span class="token number">0x1ac3a417</span><span class="token punctuation">,</span><span class="token number">0x3a965e27</span><span class="token punctuation">,</span><span class="token number">0x3bcb6bab</span><span class="token punctuation">,</span><span class="token number">0x1ff1459d</span><span class="token punctuation">,</span>
<span class="token number">0xacab58fa</span><span class="token punctuation">,</span><span class="token number">0x4b9303e3</span><span class="token punctuation">,</span><span class="token number">0x2055fa30</span><span class="token punctuation">,</span><span class="token number">0xadf66d76</span><span class="token punctuation">,</span><span class="token number">0x889176cc</span><span class="token punctuation">,</span><span class="token number">0xf5254c02</span><span class="token punctuation">,</span>
<span class="token number">0x4ffcd7e5</span><span class="token punctuation">,</span><span class="token number">0xc5d7cb2a</span><span class="token punctuation">,</span><span class="token number">0x26804435</span><span class="token punctuation">,</span><span class="token number">0xb58fa362</span><span class="token punctuation">,</span><span class="token number">0xde495ab1</span><span class="token punctuation">,</span><span class="token number">0x25671bba</span><span class="token punctuation">,</span>
<span class="token number">0x45980eea</span><span class="token punctuation">,</span><span class="token number">0x5de1c0fe</span><span class="token punctuation">,</span><span class="token number">0xc302752f</span><span class="token punctuation">,</span><span class="token number">0x8112f04c</span><span class="token punctuation">,</span><span class="token number">0x8da39746</span><span class="token punctuation">,</span><span class="token number">0x6bc6f9d3</span><span class="token punctuation">,</span>
<span class="token number">0x3e75f8f</span><span class="token punctuation">,</span><span class="token number">0x15959c92</span><span class="token punctuation">,</span><span class="token number">0xbfeb7a6d</span><span class="token punctuation">,</span><span class="token number">0x95da5952</span><span class="token punctuation">,</span><span class="token number">0xd42d83be</span><span class="token punctuation">,</span><span class="token number">0x58d32174</span><span class="token punctuation">,</span>
<span class="token number">0x492969e0</span><span class="token punctuation">,</span><span class="token number">0x8e44c8c9</span><span class="token punctuation">,</span><span class="token number">0x756a89c2</span><span class="token punctuation">,</span><span class="token number">0xf478798e</span><span class="token punctuation">,</span><span class="token number">0x996b3e58</span><span class="token punctuation">,</span><span class="token number">0x27dd71b9</span><span class="token punctuation">,</span>
<span class="token number">0xbeb64fe1</span><span class="token punctuation">,</span><span class="token number">0xf017ad88</span><span class="token punctuation">,</span><span class="token number">0xc966ac20</span><span class="token punctuation">,</span><span class="token number">0x7db43ace</span><span class="token punctuation">,</span><span class="token number">0x63184adf</span><span class="token punctuation">,</span><span class="token number">0xe582311a</span><span class="token punctuation">,</span>
<span class="token number">0x97603351</span><span class="token punctuation">,</span><span class="token number">0x62457f53</span><span class="token punctuation">,</span><span class="token number">0xb1e07764</span><span class="token punctuation">,</span><span class="token number">0xbb84ae6b</span><span class="token punctuation">,</span><span class="token number">0xfe1ca081</span><span class="token punctuation">,</span><span class="token number">0xf9942b08</span><span class="token punctuation">,</span>
<span class="token number">0x70586848</span><span class="token punctuation">,</span><span class="token number">0x8f19fd45</span><span class="token punctuation">,</span><span class="token number">0x94876cde</span><span class="token punctuation">,</span><span class="token number">0x52b7f87b</span><span class="token punctuation">,</span><span class="token number">0xab23d373</span><span class="token punctuation">,</span><span class="token number">0x72e2024b</span><span class="token punctuation">,</span>
<span class="token number">0xe3578f1f</span><span class="token punctuation">,</span><span class="token number">0x662aab55</span><span class="token punctuation">,</span><span class="token number">0xb20728eb</span><span class="token punctuation">,</span><span class="token number">0x2f03c2b5</span><span class="token punctuation">,</span><span class="token number">0x869a7bc5</span><span class="token punctuation">,</span><span class="token number">0xd3a50837</span><span class="token punctuation">,</span>
<span class="token number">0x30f28728</span><span class="token punctuation">,</span><span class="token number">0x23b2a5bf</span><span class="token punctuation">,</span><span class="token number">0x2ba6a03</span><span class="token punctuation">,</span><span class="token number">0xed5c8216</span><span class="token punctuation">,</span><span class="token number">0x8a2b1ccf</span><span class="token punctuation">,</span><span class="token number">0xa792b479</span><span class="token punctuation">,</span>
<span class="token number">0xf3f0f207</span><span class="token punctuation">,</span><span class="token number">0x4ea1e269</span><span class="token punctuation">,</span><span class="token number">0x65cdf4da</span><span class="token punctuation">,</span><span class="token number">0x6d5be05</span><span class="token punctuation">,</span><span class="token number">0xd11f6234</span><span class="token punctuation">,</span><span class="token number">0xc48afea6</span><span class="token punctuation">,</span>
<span class="token number">0x349d532e</span><span class="token punctuation">,</span><span class="token number">0xa2a055f3</span><span class="token punctuation">,</span><span class="token number">0x532e18a</span><span class="token punctuation">,</span><span class="token number">0xa475ebf6</span><span class="token punctuation">,</span><span class="token number">0xb39ec83</span><span class="token punctuation">,</span><span class="token number">0x40aaef60</span><span class="token punctuation">,</span>
<span class="token number">0x5e069f71</span><span class="token punctuation">,</span><span class="token number">0xbd51106e</span><span class="token punctuation">,</span><span class="token number">0x3ef98a21</span><span class="token punctuation">,</span><span class="token number">0x963d06dd</span><span class="token punctuation">,</span><span class="token number">0xddae053e</span><span class="token punctuation">,</span><span class="token number">0x4d46bde6</span><span class="token punctuation">,</span>
<span class="token number">0x91b58d54</span><span class="token punctuation">,</span><span class="token number">0x71055dc4</span><span class="token punctuation">,</span><span class="token number">0x46fd406</span><span class="token punctuation">,</span><span class="token number">0x60ff1550</span><span class="token punctuation">,</span><span class="token number">0x1924fb98</span><span class="token punctuation">,</span><span class="token number">0xd697e9bd</span><span class="token punctuation">,</span>
<span class="token number">0x89cc4340</span><span class="token punctuation">,</span><span class="token number">0x67779ed9</span><span class="token punctuation">,</span><span class="token number">0xb0bd42e8</span><span class="token punctuation">,</span><span class="token number">0x7888b89</span><span class="token punctuation">,</span><span class="token number">0xe7385b19</span><span class="token punctuation">,</span><span class="token number">0x79dbeec8</span><span class="token punctuation">,</span>
<span class="token number">0xa1470a7c</span><span class="token punctuation">,</span><span class="token number">0x7ce90f42</span><span class="token punctuation">,</span><span class="token number">0xf8c91e84</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x9838680</span><span class="token punctuation">,</span><span class="token number">0x3248ed2b</span><span class="token punctuation">,</span>
<span class="token number">0x1eac7011</span><span class="token punctuation">,</span><span class="token number">0x6c4e725a</span><span class="token punctuation">,</span><span class="token number">0xfdfbff0e</span><span class="token punctuation">,</span><span class="token number">0xf563885</span><span class="token punctuation">,</span><span class="token number">0x3d1ed5ae</span><span class="token punctuation">,</span><span class="token number">0x3627392d</span><span class="token punctuation">,</span>
<span class="token number">0xa64d90f</span><span class="token punctuation">,</span><span class="token number">0x6821a65c</span><span class="token punctuation">,</span><span class="token number">0x9bd1545b</span><span class="token punctuation">,</span><span class="token number">0x243a2e36</span><span class="token punctuation">,</span><span class="token number">0xcb1670a</span><span class="token punctuation">,</span><span class="token number">0x930fe757</span><span class="token punctuation">,</span>
<span class="token number">0xb4d296ee</span><span class="token punctuation">,</span><span class="token number">0x1b9e919b</span><span class="token punctuation">,</span><span class="token number">0x804fc5c0</span><span class="token punctuation">,</span><span class="token number">0x61a220dc</span><span class="token punctuation">,</span><span class="token number">0x5a694b77</span><span class="token punctuation">,</span><span class="token number">0x1c161a12</span><span class="token punctuation">,</span>
<span class="token number">0xe20aba93</span><span class="token punctuation">,</span><span class="token number">0xc0e52aa0</span><span class="token punctuation">,</span><span class="token number">0x3c43e022</span><span class="token punctuation">,</span><span class="token number">0x121d171b</span><span class="token punctuation">,</span><span class="token number">0xe0b0d09</span><span class="token punctuation">,</span><span class="token number">0xf2adc78b</span><span class="token punctuation">,</span>
<span class="token number">0x2db9a8b6</span><span class="token punctuation">,</span><span class="token number">0x14c8a91e</span><span class="token punctuation">,</span><span class="token number">0x578519f1</span><span class="token punctuation">,</span><span class="token number">0xaf4c0775</span><span class="token punctuation">,</span><span class="token number">0xeebbdd99</span><span class="token punctuation">,</span><span class="token number">0xa3fd607f</span><span class="token punctuation">,</span>
<span class="token number">0xf79f2601</span><span class="token punctuation">,</span><span class="token number">0x5cbcf572</span><span class="token punctuation">,</span><span class="token number">0x44c53b66</span><span class="token punctuation">,</span><span class="token number">0x5b347efb</span><span class="token punctuation">,</span><span class="token number">0x8b762943</span><span class="token punctuation">,</span><span class="token number">0xcbdcc623</span><span class="token punctuation">,</span>
<span class="token number">0xb668fced</span><span class="token punctuation">,</span><span class="token number">0xb863f1e4</span><span class="token punctuation">,</span><span class="token number">0xd7cadc31</span><span class="token punctuation">,</span><span class="token number">0x42108563</span><span class="token punctuation">,</span><span class="token number">0x13402297</span><span class="token punctuation">,</span><span class="token number">0x842011c6</span><span class="token punctuation">,</span>
<span class="token number">0x857d244a</span><span class="token punctuation">,</span><span class="token number">0xd2f83dbb</span><span class="token punctuation">,</span><span class="token number">0xae1132f9</span><span class="token punctuation">,</span><span class="token number">0xc76da129</span><span class="token punctuation">,</span><span class="token number">0x1d4b2f9e</span><span class="token punctuation">,</span><span class="token number">0xdcf330b2</span><span class="token punctuation">,</span>
<span class="token number">0xdec5286</span><span class="token punctuation">,</span><span class="token number">0x77d0e3c1</span><span class="token punctuation">,</span><span class="token number">0x2b6c16b3</span><span class="token punctuation">,</span><span class="token number">0xa999b970</span><span class="token punctuation">,</span><span class="token number">0x11fa4894</span><span class="token punctuation">,</span><span class="token number">0x472264e9</span><span class="token punctuation">,</span>
<span class="token number">0xa8c48cfc</span><span class="token punctuation">,</span><span class="token number">0xa01a3ff0</span><span class="token punctuation">,</span><span class="token number">0x56d82c7d</span><span class="token punctuation">,</span><span class="token number">0x22ef9033</span><span class="token punctuation">,</span><span class="token number">0x87c74e49</span><span class="token punctuation">,</span><span class="token number">0xd9c1d138</span><span class="token punctuation">,</span>
<span class="token number">0x8cfea2ca</span><span class="token punctuation">,</span><span class="token number">0x98360bd4</span><span class="token punctuation">,</span><span class="token number">0xa6cf81f5</span><span class="token punctuation">,</span><span class="token number">0xa528de7a</span><span class="token punctuation">,</span><span class="token number">0xda268eb7</span><span class="token punctuation">,</span><span class="token number">0x3fa4bfad</span><span class="token punctuation">,</span>
<span class="token number">0x2ce49d3a</span><span class="token punctuation">,</span><span class="token number">0x500d9278</span><span class="token punctuation">,</span><span class="token number">0x6a9bcc5f</span><span class="token punctuation">,</span><span class="token number">0x5462467e</span><span class="token punctuation">,</span><span class="token number">0xf6c2138d</span><span class="token punctuation">,</span><span class="token number">0x90e8b8d8</span><span class="token punctuation">,</span>
<span class="token number">0x2e5ef739</span><span class="token punctuation">,</span><span class="token number">0x82f5afc3</span><span class="token punctuation">,</span><span class="token number">0x9fbe805d</span><span class="token punctuation">,</span><span class="token number">0x697c93d0</span><span class="token punctuation">,</span><span class="token number">0x6fa92dd5</span><span class="token punctuation">,</span><span class="token number">0xcfb31225</span><span class="token punctuation">,</span>
<span class="token number">0xc83b99ac</span><span class="token punctuation">,</span><span class="token number">0x10a77d18</span><span class="token punctuation">,</span><span class="token number">0xe86e639c</span><span class="token punctuation">,</span><span class="token number">0xdb7bbb3b</span><span class="token punctuation">,</span><span class="token number">0xcd097826</span><span class="token punctuation">,</span><span class="token number">0x6ef41859</span><span class="token punctuation">,</span>
<span class="token number">0xec01b79a</span><span class="token punctuation">,</span><span class="token number">0x83a89a4f</span><span class="token punctuation">,</span><span class="token number">0xe6656e95</span><span class="token punctuation">,</span><span class="token number">0xaa7ee6ff</span><span class="token punctuation">,</span><span class="token number">0x2108cfbc</span><span class="token punctuation">,</span><span class="token number">0xefe6e815</span><span class="token punctuation">,</span>
<span class="token number">0xbad99be7</span><span class="token punctuation">,</span><span class="token number">0x4ace366f</span><span class="token punctuation">,</span><span class="token number">0xead4099f</span><span class="token punctuation">,</span><span class="token number">0x29d67cb0</span><span class="token punctuation">,</span><span class="token number">0x31afb2a4</span><span class="token punctuation">,</span><span class="token number">0x2a31233f</span><span class="token punctuation">,</span>
<span class="token number">0xc63094a5</span><span class="token punctuation">,</span><span class="token number">0x35c066a2</span><span class="token punctuation">,</span><span class="token number">0x7437bc4e</span><span class="token punctuation">,</span><span class="token number">0xfca6ca82</span><span class="token punctuation">,</span><span class="token number">0xe0b0d090</span><span class="token punctuation">,</span><span class="token number">0x3315d8a7</span><span class="token punctuation">,</span>
<span class="token number">0xf14a9804</span><span class="token punctuation">,</span><span class="token number">0x41f7daec</span><span class="token punctuation">,</span><span class="token number">0x7f0e50cd</span><span class="token punctuation">,</span><span class="token number">0x172ff691</span><span class="token punctuation">,</span><span class="token number">0x768dd64d</span><span class="token punctuation">,</span><span class="token number">0x434db0ef</span><span class="token punctuation">,</span>
<span class="token number">0xcc544daa</span><span class="token punctuation">,</span><span class="token number">0xe4df0496</span><span class="token punctuation">,</span><span class="token number">0x9ee3b5d1</span><span class="token punctuation">,</span><span class="token number">0x4c1b886a</span><span class="token punctuation">,</span><span class="token number">0xc1b81f2c</span><span class="token punctuation">,</span><span class="token number">0x467f5165</span><span class="token punctuation">,</span>
<span class="token number">0x9d04ea5e</span><span class="token punctuation">,</span><span class="token number">0x15d358c</span><span class="token punctuation">,</span><span class="token number">0xfa737487</span><span class="token punctuation">,</span><span class="token number">0xfb2e410b</span><span class="token punctuation">,</span><span class="token number">0xb35a1d67</span><span class="token punctuation">,</span><span class="token number">0x9252d2db</span><span class="token punctuation">,</span>
<span class="token number">0xe9335610</span><span class="token punctuation">,</span><span class="token number">0x6d1347d6</span><span class="token punctuation">,</span><span class="token number">0x9a8c61d7</span><span class="token punctuation">,</span><span class="token number">0x377a0ca1</span><span class="token punctuation">,</span><span class="token number">0x598e14f8</span><span class="token punctuation">,</span><span class="token number">0xeb893c13</span><span class="token punctuation">,</span>
<span class="token number">0xceee27a9</span><span class="token punctuation">,</span><span class="token number">0xb735c961</span><span class="token punctuation">,</span><span class="token number">0xe1ede51c</span><span class="token punctuation">,</span><span class="token number">0x7a3cb147</span><span class="token punctuation">,</span><span class="token number">0x9c59dfd2</span><span class="token punctuation">,</span><span class="token number">0x553f73f2</span><span class="token punctuation">,</span>
<span class="token number">0x1879ce14</span><span class="token punctuation">,</span><span class="token number">0x73bf37c7</span><span class="token punctuation">,</span><span class="token number">0x53eacdf7</span><span class="token punctuation">,</span><span class="token number">0x5f5baafd</span><span class="token punctuation">,</span><span class="token number">0xdf146f3d</span><span class="token punctuation">,</span><span class="token number">0x7886db44</span><span class="token punctuation">,</span>
<span class="token number">0xca81f3af</span><span class="token punctuation">,</span><span class="token number">0xb93ec468</span><span class="token punctuation">,</span><span class="token number">0x382c3424</span><span class="token punctuation">,</span><span class="token number">0xc25f40a3</span><span class="token punctuation">,</span><span class="token number">0x1672c31d</span><span class="token punctuation">,</span><span class="token number">0xbc0c25e2</span><span class="token punctuation">,</span>
<span class="token number">0x288b493c</span><span class="token punctuation">,</span><span class="token number">0xff41950d</span><span class="token punctuation">,</span><span class="token number">0x397101a8</span><span class="token punctuation">,</span><span class="token number">0x8deb30c</span><span class="token punctuation">,</span><span class="token number">0xd89ce4b4</span><span class="token punctuation">,</span><span class="token number">0x6490c156</span><span class="token punctuation">,</span>
<span class="token number">0x7b6184cb</span><span class="token punctuation">,</span><span class="token number">0xd570b632</span><span class="token punctuation">,</span><span class="token number">0x48745c6c</span><span class="token punctuation">,</span><span class="token number">0xd04257b8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">// unsigned 4 chars to unsigned int is 4 bytes to 32-bit</span>
<span class="token comment">// MR_WORD&#xFF1A;unsigned int</span>
<span class="token comment">// MR_BYTE&#xFF1A;unsigned char</span>
<span class="token keyword">static</span> MR_WORD <span class="token function">pack</span><span class="token punctuation">(</span><span class="token keyword">const</span> MR_BYTE <span class="token operator">*</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* pack bytes into a 32-bit Word */</span>
  <span class="token comment">// 4&#x4E2A;&#x5B57;&#x8282;&#x5168;&#x90E8;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x4E3A; MR_WORD &#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x5206;&#x522B;&#x5DE6;&#x79FB;3&#x3001;2&#x3001;1&#x3001;0&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4F7F;&#x5F97; 4*byte = int</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x5C06; int &#x7C7B;&#x578B;&#x6570;&#x636E;&#x62C6;&#x5206;&#x4E3A;4&#x4E2A; char &#x7C7B;&#x578B;&#x6570;&#x636E;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">unpack</span><span class="token punctuation">(</span>MR_WORD a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* unpack bytes from a word */</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>a<span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*

static MR_BYTE xtime(MR_BYTE a)
{
    MR_BYTE b;
    if (a&amp;0x80) b=0x1B;
    else        b=0;
    a&lt;&lt;=1;
    a^=b;
    return a;
}

*/</span>

<span class="token comment">// &#x8BA1;&#x7B97; Log(x) + Log(y) &#x7684;&#x53CD;&#x5BF9;&#x6570;&#xFF0C;&#x5373; x.y= AntiLog(Log(x) + Log(y))</span>
<span class="token comment">// &#x5982;&#x679C; x &amp;&amp; y != 0&#xFF0C;&#x5373;x&#x548C;y&#x90FD;&#x4E0D;&#x4E3A;0&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x53CD;&#x5BF9;&#x6570;</span>
<span class="token comment">// bmul() &#x5E76;&#x6CA1;&#x6709;&#x7ED9;&#x51FA;&#x53CD;&#x5BF9;&#x6570;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x53EA;&#x662F;&#x7528;&#x6570;&#x7EC4;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x6848;&#x4F8B;</span>
<span class="token keyword">static</span> MR_BYTE <span class="token function">bmul</span><span class="token punctuation">(</span>MR_BYTE x<span class="token punctuation">,</span>MR_BYTE y<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* x.y= AntiLog(Log(x) + Log(y)) */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> ptab<span class="token punctuation">[</span><span class="token punctuation">(</span>ltab<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">+</span>ltab<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x5B8C;&#x6210;1&#x4E2A;Word&#xFF08;4&#x4E2A;Byte&#xFF09;&#x7684;&#x7F6E;&#x6362;</span>
<span class="token keyword">static</span> MR_WORD <span class="token function">SubByte</span><span class="token punctuation">(</span>MR_WORD a<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MR_BYTE b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte</span>
    <span class="token comment">// &#x67E5;&#x8868;&#x5B8C;&#x6210;&#x7F6E;&#x6362;</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>fbsub<span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">pack</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &#x5C06;4&#x4E2A;Byte&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;Word</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x70B9;&#x4E58;</span>
<span class="token keyword">static</span> MR_BYTE <span class="token function">product</span><span class="token punctuation">(</span>MR_WORD x<span class="token punctuation">,</span>MR_WORD y<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* dot product of two 4-byte arrays */</span>
    MR_BYTE xb<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>xb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;1&#x4E2A;Word&#x8F6C;&#x6362;&#x4E3A;4&#x4E2A;Byte</span>
    <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>yb<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// &#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x4E24;&#x4E24;&#x76F8;&#x4E58;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x70B9;&#x4E58;&#x7684;&#x7ED3;&#x679C;&#x505A;&#x5F02;&#x6216;&#x8FD0;&#x7B97;</span>
    <span class="token keyword">return</span> <span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">bmul</span><span class="token punctuation">(</span>xb<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>yb<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x5B9E;&#x73B0;&#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x77E9;&#x9635;&#x4E58;&#x6CD5;&#x8FD0;&#x7B97;</span>
<span class="token keyword">static</span> MR_WORD <span class="token function">InvMixCol</span><span class="token punctuation">(</span>MR_WORD x<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* matrix Multiplication */</span>
    MR_WORD y<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    MR_BYTE b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    m<span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span>InCo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5C06;4&#x4E2A;Byte&#x8F6C;&#x6362;&#x4E3A;1&#x4E2A;Word</span>
    b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x4E24;&#x4E2A;4&#x5B57;&#x8282;&#x77E9;&#x9635;&#x70B9;&#x4E58;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5DE6;&#x79FB;3&#x4E2A;&#x5B57;&#x8282;</span>
    b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">product</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
&#x91CD;&#x7F6E;AES&#xFF0C;&#x5C06;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x5168;&#x90E8;&#x521D;&#x59CB;&#x5316;
aes&#x7C7B;&#x578B;&#x53D8;&#x91CF;&#xFF0C;&#x786E;&#x5B9A;AES&#x76F8;&#x5173;&#x7684;&#x53C2;&#x6570;
&#x53C2;&#x6570;mode&#xFF1A;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#xFF0C;AES&#x4E3A;CBC&#x6A21;&#x5F0F;
&#x53C2;&#x6570;iv&#xFF1A;&#x521D;&#x59CB;&#x5411;&#x91CF;
*/</span>
<span class="token keyword">void</span> <span class="token function">aes_reset</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* reset mode, or reset iv */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    a<span class="token operator">-&gt;</span>mode<span class="token operator">=</span>mode<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode<span class="token operator">!=</span>MR_ECB <span class="token operator">&amp;&amp;</span> iv<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x83B7;&#x53D6;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x7684;&#x5168;&#x90E8;&#x5143;&#x7D20;</span>
<span class="token keyword">void</span> <span class="token function">aes_getreg</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>ir<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> ir<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;
a&#xFF1A;&#x83B7;&#x53D6;AES&#x7684;&#x76F8;&#x5173;&#x53C2;&#x6570;
mode&#xFF1A;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;
nk&#xFF1A;&#x5BC6;&#x94A5;&#x5B57;&#x957F;&#x5EA6;
key&#xFF1A;&#x5BC6;&#x94A5;&#x77E9;&#x9635;
iv&#xFF1A;&#x521D;&#x59CB;&#x5411;&#x91CF;
*/</span>
BOOL <span class="token function">aes_init</span><span class="token punctuation">(</span>aes<span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token keyword">int</span> nk<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>iv<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* Key=nk bytes */</span>
  <span class="token comment">/* currently NB.nk = 16, 24 or 32          */</span>
  <span class="token comment">/* Key Scheduler. Create expanded encryption key */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">,</span>N<span class="token punctuation">,</span>nr<span class="token punctuation">;</span>
    MR_WORD CipherKey<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x6700;&#x591A;&#x6709;8&#x4E2A;&#x5B57;&#x957F;&#x7684;&#x5BC6;&#x94A5;</span>

    nk<span class="token operator">/=</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// &#x5BC6;&#x94A5;&#x957F;&#x5EA6;&#x9664;&#x4EE5;4&#xFF0C;&#x53D8;&#x6210;&#x5B57;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5217;&#x6570;</span>

    <span class="token comment">// &#x5982;&#x679C;&#x5217;&#x6570;&#x4E0D;&#x662F;4&#x3001;6&#x3001;8&#xFF0C;&#x5373;&#x4E0D;&#x662F;AES-128&#x3001;AES-192&#x3001;AES-256</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nk<span class="token operator">!=</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> nk<span class="token operator">!=</span><span class="token number">6</span> <span class="token operator">&amp;&amp;</span> nk<span class="token operator">!=</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

    <span class="token comment">// &#x5982;&#x679C;&#x662F;AES-128&#x3001;AES-192&#x3001;AES-256&#xFF0C;nk=4&#x3001;6&#x3001;8</span>
  <span class="token comment">/* nr is number of rounds */</span>
    nr<span class="token operator">=</span><span class="token number">6</span><span class="token operator">+</span>nk<span class="token punctuation">;</span> <span class="token comment">// AES-128&#x3001;AES-192&#x3001;AES-256&#x8FED;&#x4EE3;&#x7684;&#x8F6E;&#x6570; nr=10&#x3001;12&#x3001;14</span>

    a<span class="token operator">-&gt;</span>Nk<span class="token operator">=</span>nk<span class="token punctuation">;</span> a<span class="token operator">-&gt;</span>Nr<span class="token operator">=</span>nr<span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x5217;&#x6570;&#x548C;&#x8F6E;&#x6570;</span>

    <span class="token function">aes_reset</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>mode<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;AES&#x7684;16&#x5B57;&#x8282;&#x6570;&#x7EC4; f &#x548C;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;</span>

    N<span class="token operator">=</span>NB<span class="token operator">*</span><span class="token punctuation">(</span>nr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5171;&#x9700;&#x8981;&#x7684;&#x5217;&#x6570;</span>

    <span class="token comment">// &#x5C06;&#x521D;&#x59CB;&#x5BC6;&#x94A5;16/24/32&#x5B57;&#x8282;&#x8F6C;&#x6362;&#x4E3A;4/6/8&#x5BC6;&#x94A5;&#x5B57;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        CipherKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>key<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// &#x5C06;&#x5BC6;&#x94A5;&#x5B57;&#x5B58;&#x50A8;&#x5230;AES&#x7ED3;&#x6784;&#x4E2D;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>CipherKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x5BC6;&#x94A5;&#x6269;&#x5145;</span>
    <span class="token comment">// &#x5217;&#x6570;j&#x4ECE;nk&#x5F00;&#x59CB;&#xFF0C;&#x8F6E;&#x6570;k&#x4ECE;0&#x5F00;&#x59CB;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>nk<span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>N<span class="token punctuation">;</span>j<span class="token operator">+=</span>nk<span class="token punctuation">,</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// &#x7B2C;j-nk&#x5217;&#x4E0E;S&#x76D2;&#x53D8;&#x6362;&#x540E;&#x7684;&#x7B2C;j-1&#x5217;&#x5F02;&#x6216;&#xFF0C;&#x7136;&#x540E;&#x4E0E;&#x8F6E;&#x5E38;&#x91CF;&#x5F02;&#x6216;</span>
        a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span><span class="token function">SubByte</span><span class="token punctuation">(</span><span class="token function">ROTL24</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span>rco<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nk<span class="token operator">&lt;=</span><span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span> <span class="token comment">// if(nk&gt;6)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">4</span><span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span><span class="token function">SubByte</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nk <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">&lt;</span>N<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
                a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span>nk<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

 <span class="token comment">/* now for the expanded decrypt key in reverse order */</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>j<span class="token operator">+</span>N<span class="token operator">-</span>NB<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>NB<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>N<span class="token operator">-</span>NB<span class="token punctuation">;</span>i<span class="token operator">+=</span>NB<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        k<span class="token operator">=</span>N<span class="token operator">-</span>NB<span class="token operator">-</span>i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">InvMixCol</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>N<span class="token operator">-</span>NB<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>N<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>j<span class="token operator">-</span>N<span class="token operator">+</span>NB<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
_mm_loadu_si128 : __m128i _mm_loadu_si128 (__m128i const* mem_addr);
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x52A0;&#x8F7D;128&#x4F4D;&#x7684;&#x6574;&#x6570; mem_addr

_mm_xor_si128 &#xFF1A; __m128i _mm_xor_si128 (__m128i a, __m128i b);
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;128&#x4F4D;&#x6574;&#x578B;&#x6570;&#x636E;a&#x548C;b&#x5F02;&#x6216;

_mm_aesenc_si128 &#xFF1A; __m128i _mm_aesenc_si128 (__m128i a, __m128i RoundKey);
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x7528; RoundKey &#x4E2D;&#x7684;&#x8F6E;&#x5BC6;&#x94A5;&#xFF0C;&#x5BF9; a &#x505A;&#x4E00;&#x6B21; AES &#x52A0;&#x5BC6;

_mm_aesenclast_si128 &#xFF1A; __m128i _mm_aesenclast_si128 (__m128i a, __m128i RoundKey)&#xFF1B;
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x7528; RoundKey &#x4E2D;&#x7684;&#x8F6E;&#x5BC6;&#x94A5;&#xFF0C;&#x5BF9; a &#x505A;&#x6700;&#x540E;&#x4E00;&#x8F6E; AES &#x52A0;&#x5BC6;

_mm_storeu_si128 &#xFF1A; void _mm_storeu_si128 (__m128i* mem_addr, __m128i a)&#xFF1B;
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x5C06;128&#x4F4D;&#x6570;&#x636E;a&#x5B58;&#x50A8;&#x5230;&#x5185;&#x5B58;
*/</span>

<span class="token keyword">void</span> <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
    MR_WORD p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>x<span class="token punctuation">,</span><span class="token operator">*</span>y<span class="token punctuation">,</span><span class="token operator">*</span>t<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AES_NI_SUPPORT</span></span>
    __m128i ky<span class="token punctuation">,</span>m <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ky <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token function">_mm_xor_si128</span>       <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m <span class="token operator">=</span><span class="token function">_mm_aesenc_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">_mm_aesenclast_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_mm_storeu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    x<span class="token operator">=</span>p<span class="token punctuation">;</span> y<span class="token operator">=</span>q<span class="token punctuation">;</span>

<span class="token comment">/* State alternates between x and y */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span> <span class="token comment">/* Nr is number of rounds. May be odd. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MR_SMALL_AES</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             ftable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>ftable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>x<span class="token punctuation">;</span> x<span class="token operator">=</span>y<span class="token punctuation">;</span> y<span class="token operator">=</span>t<span class="token punctuation">;</span>      <span class="token comment">/* swap pointers */</span>
    <span class="token punctuation">}</span>

<span class="token comment">/* Last Round */</span> 

    y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>fbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">/* clean up stack */</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span>MR_BYTE <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>k<span class="token punctuation">;</span>
    MR_WORD p<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>x<span class="token punctuation">,</span><span class="token operator">*</span>y<span class="token punctuation">,</span><span class="token operator">*</span>t<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AES_NI_SUPPORT</span></span>
    __m128i ky<span class="token punctuation">,</span>m <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ky <span class="token operator">=</span> <span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token function">_mm_xor_si128</span>       <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m <span class="token operator">=</span><span class="token function">_mm_aesdec_si128</span>    <span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ky<span class="token operator">=</span><span class="token function">_mm_loadu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">=</span><span class="token function">_mm_aesdeclast_si128</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> ky<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_mm_storeu_si128</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    k<span class="token operator">=</span>NB<span class="token punctuation">;</span>
    x<span class="token operator">=</span>p<span class="token punctuation">;</span> y<span class="token operator">=</span>q<span class="token punctuation">;</span>

<span class="token comment">/* State alternates between x and y */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token operator">-&gt;</span>Nr<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span> <span class="token comment">/* Nr is number of rounds. May be odd. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MR_SMALL_AES</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable1<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable2<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             rtable3<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
             <span class="token function">ROTL8</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL16</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
             <span class="token function">ROTL24</span><span class="token punctuation">(</span>rtable<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        k<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">;</span>
        t<span class="token operator">=</span>x<span class="token punctuation">;</span> x<span class="token operator">=</span>y<span class="token punctuation">;</span> y<span class="token operator">=</span>t<span class="token punctuation">;</span>      <span class="token comment">/* swap pointers */</span>
    <span class="token punctuation">}</span>

<span class="token comment">/* Last Round */</span> 
    y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    y<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">^</span>
         <span class="token function">ROTL8</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL16</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span><span class="token function">MR_TOBYTE</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>
         <span class="token function">ROTL24</span><span class="token punctuation">(</span><span class="token punctuation">(</span>MR_WORD<span class="token punctuation">)</span>rbsub<span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">unpack</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">/* clean up stack */</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

mr_unsign32 <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>aes<span class="token operator">*</span> a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span>bytes<span class="token punctuation">;</span>
    <span class="token keyword">char</span> st<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mr_unsign32 fell_off<span class="token punctuation">;</span>

<span class="token comment">/* Supported Modes of Operation */</span>

    fell_off<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>mode<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> MR_ECB<span class="token operator">:</span> 
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CBC<span class="token operator">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_CFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB4<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_CFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_OFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB4<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB8<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB16<span class="token operator">:</span>

        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_OFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_PCFB1<span class="token operator">:</span>   <span class="token comment">/* error propagating CFB */</span>
    <span class="token keyword">case</span> MR_PCFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_PCFB4<span class="token operator">:</span>   
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_PCFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^</span>st<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>

    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

mr_unsign32 <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buff<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span>bytes<span class="token punctuation">;</span>
    <span class="token keyword">char</span> st<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    mr_unsign32 fell_off<span class="token punctuation">;</span>

   <span class="token comment">/* Supported modes of operation */</span>
    fell_off<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>mode<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> MR_ECB<span class="token operator">:</span>
        <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CBC<span class="token operator">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">aes_ecb_decrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span> 
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_CFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_CFB4<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_CFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>
    <span class="token keyword">case</span> MR_OFB1<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB4<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB8<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_OFB16<span class="token operator">:</span>
        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_OFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">case</span> MR_PCFB1<span class="token operator">:</span>   <span class="token comment">/* error propagating CFB */</span>
    <span class="token keyword">case</span> MR_PCFB2<span class="token operator">:</span>
    <span class="token keyword">case</span> MR_PCFB4<span class="token operator">:</span>

        bytes<span class="token operator">=</span>a<span class="token operator">-&gt;</span>mode<span class="token operator">-</span>MR_PCFB1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> fell_off<span class="token operator">=</span><span class="token punctuation">(</span>fell_off<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">|</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>bytes<span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token operator">-</span>bytes<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">aes_ecb_encrypt</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token punctuation">(</span>MR_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>bytes<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">=</span>buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^</span>st<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">-</span>bytes<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            buff<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>st<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fell_off<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
&#x51FD;&#x6570;&#x529F;&#x80FD;&#xFF1A;&#x91CD;&#x7F6E; aes &#x53D8;&#x91CF;

NB : 4
Nr : 10 12 14
*/</span>
<span class="token keyword">void</span> <span class="token function">aes_end</span><span class="token punctuation">(</span>aes <span class="token operator">*</span>a<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">/* clean up */</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token comment">// &#x5C06; aes &#x4E2D;&#x7684;&#x5BC6;&#x94A5;&#x6570;&#x7EC4;&#x6E05;&#x7A7A;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NB<span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">-&gt;</span>Nr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>fkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>a<span class="token operator">-&gt;</span>rkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x6E05;&#x7A7A;16&#x5B57;&#x8282;&#x7684;&#x6570;&#x7EC4; f</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        a<span class="token operator">-&gt;</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>  <span class="token comment">// &#x4E0B;&#x6807;&#x53C2;&#x6570;</span>
    <span class="token keyword">int</span> nk<span class="token punctuation">;</span> <span class="token comment">// &#x63A7;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x5B57;&#x8282;&#x6570;</span>
    aes a<span class="token punctuation">;</span>  <span class="token comment">// AES &#x7C7B;&#x578B;&#x53D8;&#x91CF;</span>
    MR_BYTE y<span class="token punctuation">,</span>x<span class="token punctuation">,</span>m<span class="token punctuation">;</span>  <span class="token comment">// #define MR_BYTE unsigned char</span>
    <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> block<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> iv<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x5BC6;&#x94A5;&#x6570;&#x7EC4;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">32</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> iv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x521D;&#x59CB;&#x5411;&#x91CF;&#xFF0C;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5BC6;&#x94A5;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span> <span class="token comment">// &#x521D;&#x59CB;&#x5316;&#x660E;&#x6587;&#x5206;&#x7EC4;</span>

    <span class="token comment">// nk &#x63A7;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x589E;&#x91CF;&#x4E3A;8&#xFF0C;&#x5B8C;&#x6210;AES-128&#x3001;AES-192&#x3001;AES-256&#x7684;&#x52A0;&#x89E3;&#x5BC6;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>nk<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">;</span>nk<span class="token operator">&lt;=</span><span class="token number">32</span><span class="token punctuation">;</span>nk<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>  
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\nKey Size= %d bits\n&quot;</span><span class="token punctuation">,</span>nk<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">aes_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>MR_CBC<span class="token punctuation">,</span>nk<span class="token punctuation">,</span>key<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to Initialize\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Plain=   &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_encrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypt= &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_reset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>MR_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">aes_decrypt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Decrypt= &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token operator">*</span>NB<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%02x&quot;</span><span class="token punctuation">,</span>block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">aes_end</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<footer class="page-footer"><span class="copyright">&#xA9; <a href="https://github.com/phdlisl/phdlisl.github.io" target="_blank">phdlisl</a> all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">Update in 
2025-10-11
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ecsgen.html" class="navigation navigation-prev " aria-label="Previous page: ecsgen.cpp">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="blmq.html" class="navigation navigation-next " aria-label="Next page: blmq.cpp">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"mraes.c","level":"9.1.3.2","depth":3,"next":{"title":"blmq.cpp","level":"9.1.3.3","depth":3,"path":"miracldoc/demo/blmq.md","ref":"miracldoc/demo/blmq.md","articles":[{"title":"bn_pair.cpp","level":"9.1.3.3.1","depth":4,"path":"miracldoc/packgDemo/bn_pair.md","ref":"miracldoc/packgDemo/bn_pair.md","articles":[]}]},"previous":{"title":"ecsgen.cpp","level":"9.1.3.1","depth":3,"path":"miracldoc/demo/ecsgen.md","ref":"miracldoc/demo/ecsgen.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","search-pro","katex","code","hide-element","flexible-alerts","prism","-highlight","expandable-chapters","back-to-top-button","tbfed-pagefooter","anchor-navigation-ex","livereload"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy <a href='https://github.com/phdlisl/phdlisl.github.io'>phdlisl</a>","modify_label":"Update in ","modify_format":"YYYY-MM-DD"},"prism":{"css":["prismjs/themes/prism-solarizedlight.css"],"lang":{"flow":"typescript"},"ignore":["mermaid","eval-js"]},"livereload":{},"search-pro":{},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"showLevel":true,"associatedWithSummary":true,"mode":"float","showGoTop":false,"printLog":false,"multipleH1":false,"float":{"floatIcon":"fa fa-navicon","showLevelIcon":false,"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right"},"pageTop":{"showLevelIcon":false,"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right"}},"back-to-top-button":{},"flexible-alerts":{"style":"callout","note":{"label":"注意","icon":"fa fa-info-circle","className":"info"},"tip":{"label":"提示","icon":"fa fa-lightbulb-o","className":"tip"},"warning":{"label":"warning","icon":"fa fa-exclamation-triangle","className":"warning"},"danger":{"label":"危险","icon":"fa fa-ban","className":"danger"}},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","author":"phdlisl","lang":"zh-cn","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"档案馆","links":{"gitbook":false,"sharing":{"google":false,"facebook":false,"twitter":false,"all":false}},"gitbook":"*","description":"技术博客指南，教学视频，教学笔记"},"file":{"path":"miracldoc/demo/mraes.md","mtime":"2025-10-11T08:45:44.632Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-10-21T15:54:16.172Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

